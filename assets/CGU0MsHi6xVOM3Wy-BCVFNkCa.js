import{j as r}from"./index-J-Hv9Xln.js";import{r as s}from"./iframe-CBk8unIv.js";import{a as m}from"./index-DvhsF04y.js";import{S as I}from"./index-NVek8bTy.js";import{B as S,F as E,T as M,b as h,g as C}from"./TextField-DhMfhqoy.js";import"./index-CMiH3ff9.js";import"./preload-helper-D9Z9MdNV.js";import"./client-vjV3QKWK.js";import"./index-ZiyYtj3X.js";import"./index--CXhSu_I.js";import"./Tooltip-BpPbRQQ7.js";/**
 * @license @sheetxl/studio-mui - Studio - Spreadsheet UI built with SheetXL SDK using React & MUI. - v0.6.6
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const $=["Ok","Cancel"],J=s.memo(O=>{const{initialComments:T=null,onUpdateComments:u,context:F,onOption:d,onValidateOption:p,onDone:l,options:g=$,defaultOption:c=g?.[0],cancelOption:i="Cancel",sx:y,...b}=O,f=s.useMemo(()=>{const t=T??F?.()?.getComments();let o="";if(t&&t.content&&t.content.runs){const a=t.content.runs;for(let n=0;n<a.length;n++){const D=a[n];o+=D?.text}}return o},[]),[e,j]=s.useState(f),[k,v]=s.useState(!1),x=s.useCallback(async(t,o)=>null,[]),w=m(async t=>{const o=e===""?[]:e.split(`
`);if(t!==i){const a=[];for(let n=0;n<o.length;n++)a.push({text:o[n]});u?.({content:{runs:a}})}d?.(t,t===i,t===c),l?.()},[e,u,l,d,c,i]),P=m(t=>{j(t.target.value),x(t.target.value,null)},[p]),B=m(async t=>{let o=await Promise.resolve(p?.(t));try{o!==!1&&(o=await x(e,t))}catch{}return o??!0},[p,e]);return r.jsx(I,{title:(f?"Edit":"Insert")+" Comments",options:g,onDone:l,onOption:t=>w(t),onValidateOption:B,defaultOption:c,cancelOption:i,autoFocusSel:".autoFocus",sx:{width:"480px",...y},...b,children:r.jsx(S,{sx:{paddingTop:t=>t.spacing(1),paddingBottom:t=>t.spacing(0),rowGap:t=>t.spacing(1),display:"flex",flexDirection:"column"},children:r.jsx(E,{sx:{paddingTop:t=>t.spacing(1.5),minWidth:135,width:"100%"},size:"small",children:r.jsx(M,{label:"Comments",placeholder:"Enter a comment.",onFocus:t=>{k||t.target?.select(),v(!0)},sx:{"& .MuiFormHelperText-root":{marginTop:t=>t.spacing(.5)}},InputLabelProps:{shrink:!0},InputProps:{inputProps:{className:"autoFocus",spellCheck:!1,autoComplete:"off",sx:{paddingTop:t=>t.spacing(1.25),paddingBottom:t=>t.spacing(.75),backgroundImage:`linear-gradient(${h("#fff",C(5))}, ${h("#fff",C(5))})`}}},value:e,onChange:P,onContextMenu:t=>{t.stopPropagation()}})})})})});export{J as CommentsDialog,J as default};
