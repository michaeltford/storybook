import{j as n}from"./index-J-Hv9Xln.js";import{r as i}from"./iframe-CBk8unIv.js";import{x as p,w as v}from"./index-ZiyYtj3X.js";import{a as M,e as le,d as j}from"./index-DvhsF04y.js";import{f as ae,z as re,D as ce,n as m,p as g,V as pe,j as ue,k as fe,H as de,x as xe,o as me,q as Q,r as ge,t as he,v as Oe,e as je}from"./index-NVek8bTy.js";import{e as E,B as O,T as Y,b,g as T,F as Ce,a as ye,S as ve}from"./TextField-DhMfhqoy.js";import"./index-CMiH3ff9.js";import"./preload-helper-D9Z9MdNV.js";import"./index--CXhSu_I.js";import"./client-vjV3QKWK.js";import"./Tooltip-BpPbRQQ7.js";const be=E(n.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack"),Te=E(n.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"}),"ArrowDownward"),Re=E(n.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),Se=E(n.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"}),"ArrowUpward");/**
 * @license @sheetxl/studio-mui - Studio - Spreadsheet UI built with SheetXL SDK using React & MUI. - v0.6.6
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const K=i.memo(R=>{const{label:h,value:c,options:l,onSelect:u,tabIndex:C=0,...F}=R,[I,y]=i.useState(()=>ee(c,l));i.useEffect(()=>{y(ee(c,l))},[c,l]);const L=M(f=>{y(f.target.value),u?.(l[f.target.value])},[u,l]),a=i.useMemo(()=>Object.keys(l).map(f=>n.jsx(je,{value:f,children:f},f)),[l]);return n.jsxs(Ce,{sx:{minWidth:135},size:"small",children:[n.jsx(ye,{children:h}),n.jsx(ve,{inputProps:{tabIndex:C},value:I,label:h,onChange:L,sx:{backgroundImage:`linear-gradient(${b("#fff",T(5))}, ${b("#fff",T(5))})`},...F,children:a})]})}),Z={Workbook:"workbook",Sheet:"sheet"},_={enter:140,exit:140},te={Formulas:p.Content.Formulas,Values:p.Content.Values,Notes:p.Content.Notes,Comments:p.Content.Comments},ne={...te};delete ne.Values;const ke={"By Rows":!0,"By Columns":!1},ee=(R,h)=>{const c=Object.keys(h);for(let l=0;l<c.length;l++){const u=c[l];if(h[u]===R)return u}},ze=i.memo(R=>{const{replace:h=!1,findText:c,replaceText:l,findOptions:u,replaceOptions:C,title:F,onHide:I,onFindOrReplace:y,...L}=R,a=i.useRef(null),f=i.useRef(null),V=i.useRef(null),z=i.useRef(null),$=i.useRef(null),B=i.useRef(null),H=(e,t)=>{t&&(t.start(e,{center:!1}),setTimeout(()=>t.stop(e),180))},[N,w]=i.useState(!1),[A,se]=i.useState(!1),[d,D]=i.useState(h),[W,P]=i.useState(!1),[U,q]=i.useState(!1),[o,r]=i.useState({findText:null,replaceText:null,replace:h,replaceOptions:{},findOptions:{matchCase:!1,matchEntireCell:!1,useRegex:!1,orientation:v.Orientation.Row,fields:[p.Content.Formulas]},scope:Z.Sheet}),S=M(async(e,t,s,k)=>{if(!y)return;const x={...o};x.replaceOptions={...x.replaceOptions},x.findOptions={...x.findOptions},x.replaceOptions.maxCount=s?void 0:1,x.replace=t,t&&o.findOptions.fields?.[0]===p.Content.Values&&(x.findOptions.fields=[p.Content.Formulas]),x.findOptions.reverse=!e;const ie=await y({autoFocus:k,...x});P(ie===0)},[o,y]);i.useEffect(()=>{P(!1)},[o,A,d]);const G=M((e,t)=>{if(e.keyCode===le.Enter){if(!o.findText)return;let s=!0,k=!1;e.shiftKey&&(s=!1),t?(e.ctrlKey&&e.altKey&&(k=!0),H(e,k?B.current:$.current)):H(e,s?z.current:V.current),S(s,t,k,!1)}},[o]),X=i.useRef(null);i.useLayoutEffect(()=>{r(e=>{const t={...e};t.findText=c&&c.length>0?c:e.findText??"",w(!0),l!==void 0&&(t.replaceText=l),u&&(t.findOptions={...t.findOptions,...u}),t.replaceText||(t.replaceText=""),t.replaceOptions&&(t.replaceOptions={...t.replaceOptions}),C&&(t.replaceOptions={...t.replaceOptions,...C}),o.findOptions.fields?.[0]||(o.findOptions.fields=[p.Content.Formulas]);const s=!(!C&&l===void 0);return s&&D(s),t}),U||X.current?.focus()},[c,l,u,C]),i.useEffect(()=>{d?(o.findOptions.fields[0],p.Content.Values):w(!0)},[d]),i.useEffect(()=>{if(N&&a.current&&o.findText===a.current.value)return a.current===document.activeElement||a.current.contains(document.activeElement)?(a.current?.select(),void w(!1)):void a.current.addEventListener("focus",()=>{a.current?.select(),w(!1)},{once:!0})},[N,o]);const[oe,{width:J}]=ae();return n.jsx(re,{ref:X,title:F??(d?"Find & Replace":"Find"),initialPosition:{y:"35"},autoFocusSel:".input",onHide:I,onFocus:()=>q(!0),onBlur:()=>{q(!1),P(!1)},PaperProps:{elevation:U?3:1},...L,children:n.jsxs(ce,{dividers:!0,ref:oe,sx:{display:"flex",flexDirection:"column",paddingLeft:e=>e.spacing(1.5),paddingRight:e=>e.spacing(1.5)},onKeyDown:e=>{if(e.key==="h"&&e.ctrlKey)D(!0),a.current?.contains(document.activeElement)&&f.current?.focus();else if(e.key==="f"&&e.ctrlKey)a.current?.focus();else if(e.key==="c"&&e.altKey)r(t=>{const s={...t};return s.findOptions.matchCase=!t.findOptions.matchCase,s});else if(e.key==="e"&&e.altKey)r(t=>{const s={...t};return s.findOptions.matchEntireCell=!t.findOptions.matchEntireCell,s});else{if(e.key!=="r"||!e.altKey)return;r(t=>{const s={...t};return s.findOptions.useRegex=!t.findOptions.useRegex,s})}e.preventDefault()},children:[n.jsxs(O,{sx:{display:"flex",flexDirection:"row",gap:e=>e.spacing(1)},children:[n.jsxs(O,{sx:{display:"flex",flexDirection:"row",alignItems:"start",gap:e=>e.spacing(.25),paddingTop:"3px"},children:[n.jsx(m,{selected:A,onSelectToggle:e=>{se(e)},preventFocus:!0,label:"Toggle Additional Options",icon:g(n.jsx(pe,{}))}),n.jsx(m,{selected:d,onSelectToggle:e=>{D(e)},preventFocus:!0,label:"Toggle Replace",icon:g(n.jsx(ue,{})),shortcut:{key:d?"F":"H",modifiers:[j.Ctrl]}})]}),n.jsxs(O,{sx:{display:"flex",flexDirection:"column",maxWidth:"100%",boxSizing:"border-box"},children:[n.jsxs(O,{sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:[n.jsx(Y,{label:"Find",InputLabelProps:{shrink:!0},InputProps:{sx:{paddingRight:e=>e.spacing(1),minWidth:J>460?"20em":void 0,backgroundImage:`linear-gradient(${b("#fff",T(5))}, ${b("#fff",T(5))})`},inputProps:{draggable:!1,ref:a,className:"input",autoFocus:!0,spellCheck:!1,autoComplete:"off",sx:{paddingTop:e=>e.spacing(1.25),paddingBottom:e=>e.spacing(.75)}},endAdornment:n.jsx(fe,{sx:{transform:"scale(0.75) translateX(16px)"},position:"end",children:n.jsxs(O,{sx:{display:"flex",alignItems:"center",flexDirection:"row",gap:"1px"},children:[n.jsx(m,{selected:o.findOptions.matchCase,onSelectToggle:e=>{r(t=>{const s={...t};return s.findOptions.matchCase=e,s})},label:"Match Case",shortcut:{key:"C",modifiers:[j.Alt]},icon:g(n.jsx(de,{}))}),n.jsx(m,{selected:o.findOptions.matchEntireCell,onSelectToggle:e=>{r(t=>{const s={...t};return s.findOptions.matchEntireCell=e,s})},label:"Match Entire Cell",shortcut:{key:"E",modifiers:[j.Alt]},icon:g(n.jsx(xe,{}))}),n.jsx(m,{selected:o.findOptions.useRegex,onSelectToggle:e=>{r(t=>{const s={...t};return s.findOptions.useRegex=e,s})},label:"Use Regular Expression",shortcut:{key:"R",modifiers:[j.Alt]},icon:g(n.jsx(me,{}))})]})})},sx:{flex:"1 1 100%",marginRight:e=>e.spacing(1),"& .MuiOutlinedInput-notchedOutline":{borderColor:e=>W?`${e.palette.error.main} !important`:void 0},"& .MuiInputLabel-outlined":{color:e=>W?`${e.palette.error.main} !important`:void 0}},value:o.findText??"",onChange:e=>{r(t=>{const s={...t};return s.findText=e.target.value,s})},onKeyDown:e=>G(e,!1),onContextMenu:e=>{e.stopPropagation()}}),n.jsx(m,{selected:o.findOptions.reverse,onSelectToggle:e=>{S(!1,!1)},touchRippleRef:V,label:"",shortcut:{key:"Enter",modifiers:[j.Shift]},icon:g(o.findOptions.orientation!==v.Orientation.Column?n.jsx(be,{}):n.jsx(Se,{})),disabled:!o.findText}),n.jsx(m,{selected:!o.findOptions.reverse,onSelectToggle:e=>{S(!0,!1)},touchRippleRef:z,label:"Next Match",shortcut:{key:"Enter"},icon:g(o.findOptions.orientation!==v.Orientation.Column?n.jsx(Re,{}):n.jsx(Te,{})),disabled:!o.findText})]}),n.jsx(Q,{in:d,timeout:_,onExit:()=>{a.current?.focus()},children:n.jsxs(O,{sx:{display:"flex",flexDirection:"row",alignItems:"center",marginTop:e=>e.spacing(2)},children:[n.jsx(Y,{label:"Replace",InputLabelProps:{shrink:!0},InputProps:{sx:{paddingRight:e=>e.spacing(1),backgroundImage:`linear-gradient(${b("#fff",T(5))}, ${b("#fff",T(5))})`},inputProps:{ref:f,className:"input",spellCheck:!1,autoComplete:"off",sx:{paddingTop:e=>e.spacing(1.25),paddingBottom:e=>e.spacing(.75)}}},sx:{flex:"1 1 100%",marginRight:e=>e.spacing(1)},value:o.replaceText??"",onChange:e=>{r(t=>{const s={...t};return s.replaceText=e.target.value,s})},onKeyDown:e=>G(e,!0),onContextMenu:e=>{e.stopPropagation()}}),n.jsx(m,{onSelectToggle:e=>{S(!0,!0)},touchRippleRef:$,label:"Replace",shortcut:{key:"Enter"},icon:g(n.jsx(ge,{})),disabled:!o.findText}),n.jsx(m,{onSelectToggle:e=>{S(!0,!0,!0)},touchRippleRef:B,label:"Replace All",shortcut:{key:"Enter",modifiers:[j.Ctrl,j.Alt]},icon:g(n.jsx(he,{})),disabled:!o.findText})]})})]})]}),n.jsx(Q,{in:A,timeout:_,onExit:()=>{a.current?.focus()},children:n.jsxs(O,{sx:{minHeight:"10px",flex:"1 1 100%",display:"flex",flexDirection:"column",gap:e=>e.spacing(.5),marginTop:e=>e.spacing(1)},children:[n.jsx(Oe,{orientation:"horizontal",sx:{marginBottom:e=>e.spacing(1.5)}}),n.jsxs(O,{sx:{display:"flex",flexDirection:J>=413?"row":"column",justifyContent:"space-evenly",alignItems:"center",rowGap:e=>e.spacing(2)},tabIndex:-1,children:[n.jsx(K,{label:"Within",value:o.scope,options:Z,onSelect:e=>{r(t=>{const s={...t};return s.scope=e,s})}}),n.jsx(K,{label:"Search",value:o.findOptions.orientation!==v.Orientation.Column,options:ke,onSelect:e=>{r(t=>{const s={...t};return s.findOptions.orientation=e?v.Orientation.Row:v.Orientation.Column,s})}}),n.jsx(K,{label:"Look in",value:d&&o.findOptions.fields?.[0]===p.Content.Values?p.Content.Formulas:o.findOptions.fields?.[0],options:d?ne:te,onSelect:e=>{r(t=>{const s={...t};return s.findOptions.fields=[e],s})}})]})]})})]})})});export{ze as FindReplaceWindow,Z as ScopeOptions,ze as default};
