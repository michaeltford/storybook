import{j as l}from"./index-J-Hv9Xln.js";import{r as c}from"./iframe-CBk8unIv.js";import{y as B}from"./index-ZiyYtj3X.js";import{f as F,h as M,p as y,b as h,i as A,u as T,s as V,j as R,k as D,l as E,d as I,m as z,q as H,r as k,e as P,F as U,B as W,I as O,t as K,T as N}from"./TextField-DhMfhqoy.js";import{e as q}from"./index-DvhsF04y.js";function G(e){return M("MuiLink",e)}const _=F("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),J=({theme:e,ownerState:n})=>{const t=n.color,s=y(e,`palette.${t}.main`,!1)||y(e,`palette.${t}`,!1)||n.color,a=y(e,`palette.${t}.mainChannel`)||y(e,`palette.${t}Channel`);return"vars"in e&&a?`rgba(${a} / 0.4)`:h(s,.4)},w={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},Q=e=>{const{classes:n,component:t,focusVisible:s,underline:a}=e,d={root:["root",`underline${D(a)}`,t==="button"&&"button",s&&"focusVisible"]};return E(d,G,n)},X=V(I,{name:"MuiLink",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:t}=e;return[n.root,n[`underline${D(t.underline)}`],t.component==="button"&&n.button]}})(z(({theme:e})=>({variants:[{props:{underline:"none"},style:{textDecoration:"none"}},{props:{underline:"hover"},style:{textDecoration:"none","&:hover":{textDecoration:"underline"}}},{props:{underline:"always"},style:{textDecoration:"underline","&:hover":{textDecorationColor:"inherit"}}},{props:({underline:n,ownerState:t})=>n==="always"&&t.color!=="inherit",style:{textDecorationColor:"var(--Link-underlineColor)"}},...Object.entries(e.palette).filter(H()).map(([n])=>({props:{underline:"always",color:n},style:{"--Link-underlineColor":e.vars?`rgba(${e.vars.palette[n].mainChannel} / 0.4)`:h(e.palette[n].main,.4)}})),{props:{underline:"always",color:"textPrimary"},style:{"--Link-underlineColor":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.4)`:h(e.palette.text.primary,.4)}},{props:{underline:"always",color:"textSecondary"},style:{"--Link-underlineColor":e.vars?`rgba(${e.vars.palette.text.secondaryChannel} / 0.4)`:h(e.palette.text.secondary,.4)}},{props:{underline:"always",color:"textDisabled"},style:{"--Link-underlineColor":(e.vars||e).palette.text.disabled}},{props:{component:"button"},style:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${_.focusVisible}`]:{outline:"auto"}}}]}))),Y=c.forwardRef(function(n,t){const s=A({props:n,name:"MuiLink"}),a=T(),{className:d,color:r="primary",component:i="a",onBlur:o,onFocus:x,TypographyClasses:g,underline:u="always",variant:b="inherit",sx:m,...f}=s,[L,C]=c.useState(!1),j=p=>{k(p.target)||C(!1),o&&o(p)},S=p=>{k(p.target)&&C(!0),x&&x(p)},v={...s,color:r,component:i,focusVisible:L,underline:u,variant:b},$=Q(v);return l.jsx(X,{color:r,className:R($.root,d),classes:g,component:i,onBlur:j,onFocus:S,ref:t,ownerState:v,variant:b,...f,sx:[...w[r]===void 0?[{color:r}]:[],...Array.isArray(m)?m:[m]],style:{...f.style,...u==="always"&&r!=="inherit"&&!w[r]&&{"--Link-underlineColor":J({theme:a,ownerState:v})}}})}),Z=P([l.jsx("path",{d:"M8.09 17H7v-4h3.69c.95-.63 2.09-1 3.31-1h6c.34 0 .67.04 1 .09V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h3.81C8.3 20.12 8 19.09 8 18c0-.34.04-.67.09-1M13 7h4v4h-4zM7 7h4v4H7z"},"0"),l.jsx("path",{d:"M12 18c0-1.1.9-2 2-2h2v-2h-2c-2.21 0-4 1.79-4 4s1.79 4 4 4h2v-2h-2c-1.1 0-2-.9-2-2m8-4h-2v2h2c1.1 0 2 .9 2 2s-.9 2-2 2h-2v2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4"},"1"),l.jsx("path",{d:"M14 17h6v2h-6z"},"2")],"DatasetLinked"),se=c.memo(e=>{const{initialAddress:n,createWidget:t,workbook:s,refIWorkbookElement:a,...d}=e,[r,i]=c.useState(null),[o,x]=c.useState(null);B(s,r,u=>{x(u.getSource())});const g=c.useMemo(()=>t({range:o,refIWorkbookElement:a}),[o,t,a]);return l.jsxs(U,{...d,children:[l.jsxs(W,{sx:{display:"flex",flexDirection:"row",alignItems:"center",rowGap:u=>u.spacing(.25)},children:[g,l.jsx(O,{sx:{my:-2},disabled:!s,onClick:()=>{i(r===null?s.getSelectedCell().getA1():null)},children:l.jsx(Z,{})})]}),l.jsx(K,{children:l.jsx(Y,{component:"button",underline:"hover",variant:"body2",disabled:o?.isInvalid(),sx:{"&:not(:hover)":{color:"inherit"},"&[disabled]":{color:u=>u.palette.text.disabled,cursor:"default","&:hover":{textDecoration:"none"}}},onClick:()=>{o.select()},children:o?`${o.toString()}`:"Unlinked"})})]})}),ae=c.memo(e=>{const{value:n,onChange:t,onKeyDown:s,onBlur:a,...d}=e,[r,i]=c.useState(null);return c.useEffect(()=>{i(null)},[n]),l.jsx(N,{...d,value:r?.target.value??n??"",onKeyDown:o=>{o.which===q.Enter&&r&&(i(null),t?.(r),s?.(o))},onBlur:o=>{i(null),t?.(o),a?.(o)},onChange:o=>{i(o)}})});export{se as B,ae as R};
