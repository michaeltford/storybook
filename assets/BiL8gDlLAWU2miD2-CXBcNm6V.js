const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BTJ47c2yYMrLhclR-DHYJS658.js","./index-DvhsF04y.js","./index-J-Hv9Xln.js","./iframe-CBk8unIv.js","./preload-helper-D9Z9MdNV.js","./index-CMiH3ff9.js","./client-vjV3QKWK.js","./index-ZiyYtj3X.js","./index--CXhSu_I.js"])))=>i.map(i=>d[i]);
import{_ as Ut}from"./preload-helper-D9Z9MdNV.js";import{N as xe,k as It,M as Vt,o as we,p as ve,q as Lt,t as yt,d as Se,b as Ce,w as ke,n as Ae}from"./index-ZiyYtj3X.js";import{X as ee,j as Ee,Z as oe,o as De}from"./index-DvhsF04y.js";import"./index-J-Hv9Xln.js";import"./iframe-CBk8unIv.js";import"./index-CMiH3ff9.js";import"./index--CXhSu_I.js";import"./client-vjV3QKWK.js";/**
 * @license @sheetxl/io - IO - Import/Export Libraries for SheetXL. - v0.6.6
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const le=":A-Z_a-zÃ€-Ã–Ã˜-Ã¶Ã¸-Ë¿Í°-Í½Í¿-á¿¿â€Œâ€â°-â†â°€-â¿¯ã€-íŸ¿ï¤€-ï·ï·°-ï¿½ð€€-ó¯¿¿",Oe=new RegExp(`^[${le}][${`-${le}.0-9Â·Ì€-Í¯â€¿-â€`}]*$`,"u"),Ie=[32,10,13,9];function fe(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}const ce="A-Z_a-zÃ€-Ã–Ã˜-Ã¶Ã¸-Ë¿Í°-Í½Í¿-á¿¿â€Œ-â€â°-â†â°€-â¿¯ã€-íŸ¿ï¤€-ï·ï·°-ï¿½ð€€-ó¯¿¿",Pe=new RegExp(`^[${ce}][${`-${ce}.0-9Â·Ì€-Í¯â€¿-â€`}]*$`,"u");function me(o){return o>=65&&o<=90||o===95||o>=97&&o<=122||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8204&&o<=8205||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}const it=function(o){return o===32||o===10||o===13||o===9},Ve=function(o){return o>=32&&o<=55295||o===10||o===13||o===9||o>=57344&&o<=65533||o>=65536&&o<=1114111},zt=fe,he=function(o){return fe(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256},Te=Ie,Re=Oe,Ne=function(o){return o>=1&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},Le=me,$e=function(o){return me(o)||o===45||o===46||o>=48&&o<=57||o===183||o>=768&&o<=879||o>=8255&&o<=8256},je=Pe,te="http://www.w3.org/XML/1998/namespace",Xt="http://www.w3.org/2000/xmlns/",Me={__proto__:null,xml:te,xmlns:Xt},Xe={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},N=-1,Tt=-2,tt=13,Pt=33,ut=10,Et=60,jt=61,F=62,q=63,Mt=93,Yt=o=>o===34||o===39,be=[34,39],He=[...be,91,F],Fe=[...be,Et,Mt],_e=[jt,q,...Te],Be=[...Te,F,38,Et];function ie(o,t,s){switch(t){case"xml":s!==te&&o.fail(`xml prefix must be bound to ${te}.`);break;case"xmlns":s!==Xt&&o.fail(`xmlns prefix must be bound to ${Xt}.`)}switch(s){case Xt:o.fail(t===""?`the default namespace may not be set to ${s}.`:`may not assign a prefix (even "xmlns") to the URI ${Xt}.`);break;case te:switch(t){case"xml":break;case"":o.fail(`the default namespace may not be set to ${s}.`);break;default:o.fail("may not assign the xml namespace to another prefix.")}}}const We=o=>je.test(o),qe=o=>Re.test(o),ue={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};class ze{constructor(t){this.i=0,this.prevI=0,this.opt=t??{},this.fragmentOpt=!!this.opt.fragment;const s=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,s){this.nameStartCheck=Le,this.nameCheck=$e,this.isName=We,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns={__proto__:null,...Me};const i=this.opt.additionalNamespaces;i!=null&&(function(n,a){for(const l of Object.keys(a))ie(n,l,a[l])}(this,i),Object.assign(this.ns,i))}else this.nameStartCheck=zt,this.nameCheck=he,this.isName=qe,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:t}=this;this.state=t?tt:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=t,this.xmlDeclPossible=!t,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:s}=this.opt;if(s===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");s="1.0"}this.setXMLVersion(s),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(Xe),this.readyHandler?.()}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(t,s){this[ue[t]]=s}off(t){this[ue[t]]=void 0}makeError(t){let s=this.fileName??"";return this.trackPosition&&(s.length>0&&(s+=":"),s+=`${this.line}:${this.column}`),s.length>0&&(s+=": "),new Error(s+t)}fail(t){const s=this.makeError(t),i=this.errorHandler;if(i===void 0)throw s;return i(s),this}write(t){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let s=!1;t===null?(s=!0,t=""):typeof t=="object"&&(t=t.toString()),this.carriedFromPrevious!==void 0&&(t=`${this.carriedFromPrevious}${t}`,this.carriedFromPrevious=void 0);let i=t.length;const n=t.charCodeAt(i-1);!s&&(n===13||n>=55296&&n<=56319)&&(this.carriedFromPrevious=t[i-1],i--,t=t.slice(0,i));const{stateTable:a}=this;for(this.chunk=t,this.i=0;this.i<i;)a[this.state].call(this);return this.chunkPosition+=i,s?this.end():this}close(){return this.write(null)}getCode10(){const t=this.chunk,s=this.i;if(this.prevI=s,this.i++,s>=t.length)return N;const i=t.charCodeAt(s);if(this.column++,i<55296){if(i>=32||i===9)return i;switch(i){case ut:return this.line++,this.column=0,this.positionAtNewLine=this.position,ut;case 13:return t.charCodeAt(s+1)===ut&&(this.i=s+2),this.line++,this.column=0,this.positionAtNewLine=this.position,Tt;default:return this.fail("disallowed character."),i}}if(i>56319)return i>=57344&&i<=65533||this.fail("disallowed character."),i;const n=65536+1024*(i-55296)+(t.charCodeAt(s+1)-56320);return this.i=s+2,n>1114111&&this.fail("disallowed character."),n}getCode11(){const{chunk:t,i:s}=this;if(this.prevI=s,this.i=s+1,s>=t.length)return N;const i=t.charCodeAt(s);if(this.column++,i<55296){if(i>31&&i<127||i>159&&i!==8232||i===9)return i;switch(i){case ut:return this.line++,this.column=0,this.positionAtNewLine=this.position,ut;case 13:{const a=t.charCodeAt(s+1);a!==ut&&a!==133||(this.i=s+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,Tt;default:return this.fail("disallowed character."),i}}if(i>56319)return i>=57344&&i<=65533||this.fail("disallowed character."),i;const n=65536+1024*(i-55296)+(t.charCodeAt(s+1)-56320);return this.i=s+2,n>1114111&&this.fail("disallowed character."),n}getCodeNorm(){const t=this.getCode();return t===Tt?ut:t}unget(){this.i=this.prevI,this.column--}captureTo(t){let{i:s}=this;const{chunk:i}=this;for(;;){const n=this.getCode(),a=n===Tt,l=a?ut:n;if(l===N||t.includes(l))return this.text+=i.slice(s,this.prevI),l;a&&(this.text+=`${i.slice(s,this.prevI)}
`,s=this.i)}}captureToChar(t){let{i:s}=this;const{chunk:i}=this;for(;;){let n=this.getCode();switch(n){case Tt:this.text+=`${i.slice(s,this.prevI)}
`,s=this.i,n=ut;break;case N:return this.text+=i.slice(s),!1}if(n===t)return this.text+=i.slice(s,this.prevI),!0}}captureNameChars(){const{chunk:t,i:s}=this;for(;;){const i=this.getCode();if(i===N)return this.name+=t.slice(s),N;if(!he(i))return this.name+=t.slice(s,this.prevI),i===Tt?ut:i}}skipSpaces(){for(;;){const t=this.getCodeNorm();if(t===N||!it(t))return t}}setXMLVersion(t){this.currentXMLVersion=t,t==="1.0"?(this.isChar=Ve,this.getCode=this.getCode10):(this.isChar=Ne,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const t=this.i,s=this.skipSpaces();switch(this.prevI!==t&&(this.xmlDeclPossible=!1),s){case Et:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case N:break;default:this.unget(),this.state=tt,this.xmlDeclPossible=!1}}sDoctype(){const t=this.captureTo(He);switch(t){case F:this.doctypeHandler?.(this.text),this.text="",this.state=tt,this.doctype=!0;break;case N:break;default:this.text+=String.fromCodePoint(t),t===91?this.state=4:Yt(t)&&(this.state=3,this.q=t)}}sDoctypeQuote(){const t=this.q;this.captureToChar(t)&&(this.text+=String.fromCodePoint(t),this.q=null,this.state=2)}sDTD(){const t=this.captureTo(Fe);t!==N&&(this.text+=String.fromCodePoint(t),t===Mt?this.state=2:t===Et?this.state=6:Yt(t)&&(this.state=5,this.q=t))}sDTDQuoted(){const t=this.q;this.captureToChar(t)&&(this.text+=String.fromCodePoint(t),this.state=4,this.q=null)}sDTDOpenWaka(){const t=this.getCodeNorm();switch(this.text+=String.fromCodePoint(t),t){case 33:this.state=7,this.openWakaBang="";break;case q:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const t=String.fromCodePoint(this.getCodeNorm()),s=this.openWakaBang+=t;this.text+=t,s!=="-"&&(this.state=s==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const t=this.getCodeNorm();this.text+=String.fromCodePoint(t),this.state=t===45?10:8}sDTDCommentEnded(){const t=this.getCodeNorm();this.text+=String.fromCodePoint(t),t===F?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(q)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const t=this.getCodeNorm();this.text+=String.fromCodePoint(t),t===F&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:t}=this;const{chunk:s}=this;t:for(;;)switch(this.getCode()){case Tt:this.entity+=`${s.slice(t,this.prevI)}
`,t=this.i;break;case 59:{const{entityReturnState:i}=this,n=this.entity+s.slice(t,this.prevI);let a;this.state=i,n===""?(this.fail("empty entity name."),a="&;"):(a=this.parseEntity(n),this.entity=""),i===tt&&this.textHandler===void 0||(this.text+=a);break t}case N:this.entity+=s.slice(t);break t}}sOpenWaka(){const t=this.getCode();if(zt(t))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(t){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case q:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=tt,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){const t=this.getCodeNorm();t===45?(this.state=19,this.commentHandler?.(this.text),this.text=""):(this.text+=`-${String.fromCodePoint(t)}`,this.state=17)}sCommentEnded(){const t=this.getCodeNorm();t!==F?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(t)}`,this.state=17):this.state=tt}sCData(){this.captureToChar(Mt)&&(this.state=21)}sCDataEnding(){const t=this.getCodeNorm();t===Mt?this.state=22:(this.text+=`]${String.fromCodePoint(t)}`,this.state=20)}sCDataEnding2(){const t=this.getCodeNorm();switch(t){case F:this.cdataHandler?.(this.text),this.text="",this.state=tt;break;case Mt:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(t)}`,this.state=20}}sPIFirstChar(){const t=this.getCodeNorm();this.nameStartCheck(t)?(this.piTarget+=String.fromCodePoint(t),this.state=24):t===q||it(t)?(this.fail("processing instruction without a target."),this.state=t===q?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(t),this.state=24)}sPIRest(){const{chunk:t,i:s}=this;for(;;){const i=this.getCodeNorm();if(i===N)return void(this.piTarget+=t.slice(s));if(!this.nameCheck(i)){this.piTarget+=t.slice(s,this.prevI);const n=i===q;n||it(i)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=n?Pt:27):this.state=n?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(i));break}}}sPIBody(){if(this.text.length===0){const t=this.getCodeNorm();t===q?this.state=26:it(t)||(this.text=String.fromCodePoint(t))}else this.captureToChar(q)&&(this.state=26)}sPIEnding(){const t=this.getCodeNorm();if(t===F){const{piTarget:s}=this;s.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),this.piHandler?.({target:s,body:this.text}),this.piTarget=this.text="",this.state=tt}else t===q?this.text+="?":(this.text+=`?${String.fromCodePoint(t)}`,this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const t=this.skipSpaces();t!==q?t!==N&&(this.state=28,this.name=String.fromCodePoint(t)):this.state=Pt}sXMLDeclName(){const t=this.captureTo(_e);if(t===q)return this.state=Pt,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(it(t)||t===jt){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=t===jt?30:29}}sXMLDeclEq(){const t=this.getCodeNorm();if(t===q)return this.state=Pt,void this.fail("XML declaration is incomplete.");it(t)||(t!==jt&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const t=this.getCodeNorm();if(t===q)return this.state=Pt,void this.fail("XML declaration is incomplete.");it(t)||(Yt(t)?this.q=t:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const t=this.captureTo([this.q,q]);if(t===q)return this.state=Pt,this.text="",void this.fail("XML declaration is incomplete.");if(t===N)return;const s=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const i=s;this.xmlDecl.version=i,/^1\.[0-9]+$/.test(i)?this.opt.forceXMLVersion||this.setXMLVersion(i):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(s)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=s;break;case"standalone":s!=="yes"&&s!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=s}this.name="",this.state=32}sXMLDeclSeparator(){const t=this.getCodeNorm();t!==q?(it(t)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=Pt}sXMLDeclEnding(){this.getCodeNorm()===F?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),this.xmldeclHandler?.(this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=tt):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){const t=this.captureNameChars();if(t===N)return;const s=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=s.ns=Object.create(null)),this.openTagStartHandler?.(s),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),t){case F:this.openTag();break;case 47:this.state=35;break;default:it(t)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===F?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const t=this.skipSpaces();t!==N&&(zt(t)?(this.unget(),this.state=37):t===F?this.openTag():t===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const t=this.captureNameChars();t===jt?this.state=39:it(t)?this.state=38:t===F?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):t!==N&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const t=this.skipSpaces();switch(t){case N:return;case jt:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",t===F?this.openTag():zt(t)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const t=this.getCodeNorm();Yt(t)?(this.q=t,this.state=40):it(t)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:t,chunk:s}=this;let{i}=this;for(;;)switch(this.getCode()){case t:return this.pushAttrib(this.name,this.text+s.slice(i,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=s.slice(i,this.prevI),this.state=14,void(this.entityReturnState=40);case ut:case Tt:case 9:this.text+=`${s.slice(i,this.prevI)} `,i=this.i;break;case Et:return this.text+=s.slice(i,this.prevI),void this.fail("disallowed character.");case N:return void(this.text+=s.slice(i))}}sAttribValueClosed(){const t=this.getCodeNorm();it(t)?this.state=36:t===F?this.openTag():t===47?this.state=35:zt(t)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const t=this.captureTo(Be);switch(t){case 38:this.state=14,this.entityReturnState=42;break;case Et:this.fail("disallowed character.");break;case N:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",t===F?this.openTag():this.state=36}}sCloseTag(){const t=this.captureNameChars();t===F?this.closeTag():it(t)?this.state=44:t!==N&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case F:this.closeTag();break;case N:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:t,forbiddenState:s}=this;const{chunk:i,textHandler:n}=this;t:for(;;)switch(this.getCode()){case Et:if(this.state=15,n!==void 0){const{text:a}=this,l=i.slice(t,this.prevI);a.length!==0?(n(a+l),this.text=""):l.length!==0&&n(l)}s=0;break t;case 38:this.state=14,this.entityReturnState=tt,n!==void 0&&(this.text+=i.slice(t,this.prevI)),s=0;break t;case Mt:switch(s){case 0:s=1;break;case 1:s=2;break;case 2:break;default:throw new Error("impossible state")}break;case F:s===2&&this.fail('the string "]]>" is disallowed in char data.'),s=0;break;case Tt:n!==void 0&&(this.text+=`${i.slice(t,this.prevI)}
`),t=this.i,s=0;break;case N:n!==void 0&&(this.text+=i.slice(t));break t;default:s=0}this.forbiddenState=s}handleTextOutsideRoot(){let{i:t}=this;const{chunk:s,textHandler:i}=this;let n=!1;t:for(;;){const a=this.getCode();switch(a){case Et:if(this.state=15,i!==void 0){const{text:l}=this,g=s.slice(t,this.prevI);l.length!==0?(i(l+g),this.text=""):g.length!==0&&i(g)}break t;case 38:this.state=14,this.entityReturnState=tt,i!==void 0&&(this.text+=s.slice(t,this.prevI)),n=!0;break t;case Tt:i!==void 0&&(this.text+=`${s.slice(t,this.prevI)}
`),t=this.i;break;case N:i!==void 0&&(this.text+=s.slice(t));break t;default:it(a)||(n=!0)}}n&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(t,s){const{prefix:i,local:n}=this.qname(t),a={name:t,prefix:i,local:n,value:s};if(this.attribList.push(a),this.attributeHandler?.(a),i==="xmlns"){const l=s.trim();this.currentXMLVersion==="1.0"&&l===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[n]=l,ie(this,n,l)}else if(t==="xmlns"){const l=s.trim();this.topNS[""]=l,ie(this,"",l)}}pushAttribPlain(t,s){const i={name:t,value:s};this.attribList.push(i),this.attributeHandler?.(i)}end(){this.sawRoot||this.fail("document must contain a root element.");const{tags:t}=this;for(;t.length>0;){const i=t.pop();this.fail(`unclosed tag: ${i.name}`)}this.state!==0&&this.state!==tt&&this.fail("unexpected end.");const{text:s}=this;return s.length!==0&&(this.textHandler?.(s),this.text=""),this._closed=!0,this.endHandler?.(),this._init(),this}resolve(t){let s=this.topNS[t];if(s!==void 0)return s;const{tags:i}=this;for(let n=i.length-1;n>=0;n--)if(s=i[n].ns[t],s!==void 0)return s;return s=this.ns[t],s!==void 0?s:this.opt.resolvePrefix?.(t)}qname(t){const s=t.indexOf(":");if(s===-1)return{prefix:"",local:t};const i=t.slice(s+1),n=t.slice(0,s);return(n===""||i===""||i.includes(":"))&&this.fail(`malformed name: ${t}.`),{prefix:n,local:i}}processAttribsNS(){const{attribList:t}=this,s=this.tag;{const{prefix:a,local:l}=this.qname(s.name);s.prefix=a,s.local=l;const g=s.uri=this.resolve(a)??"";a!==""&&(a==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),g===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(a)}.`),s.uri=a))}if(t.length===0)return;const{attributes:i}=s,n=new Set;for(const a of t){const{name:l,prefix:g,local:S}=a;let y,x;g===""?(y=l==="xmlns"?Xt:"",x=l):(y=this.resolve(g),y===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(g)}.`),y=g),x=`{${y}}${S}`),n.has(x)&&this.fail(`duplicate attribute: ${x}.`),n.add(x),a.uri=y,i[l]=a}this.attribList=[]}processAttribsPlain(){const{attribList:t}=this,s=this.tag.attributes;for(const{name:i,value:n}of t)s[i]!==void 0&&this.fail(`duplicate attribute: ${i}.`),s[i]=n;this.attribList=[]}openTag(){this.processAttribs();const{tags:t}=this,s=this.tag;s.isSelfClosing=!1,this.openTagHandler?.(s),t.push(s),this.state=tt,this.name=""}openSelfClosingTag(){this.processAttribs();const{tags:t}=this,s=this.tag;s.isSelfClosing=!0,this.openTagHandler?.(s),this.closeTagHandler?.(s),(this.tag=t[t.length-1]??null)===null&&(this.closedRoot=!0),this.state=tt,this.name=""}closeTag(){const{tags:t,name:s}=this;if(this.state=tt,this.name="",s==="")return this.fail("weird empty close tag."),void(this.text+="</>");const i=this.closeTagHandler;let n=t.length;for(;n-- >0;){const a=this.tag=t.pop();if(this.topNS=a.ns,i?.(a),a.name===s)break;this.fail("unexpected close tag.")}n===0?this.closedRoot=!0:n<0&&(this.fail(`unmatched closing tag: ${s}.`),this.text+=`</${s}>`)}parseEntity(t){if(t[0]!=="#"){const i=this.ENTITIES[t];return i!==void 0?i:(this.fail(this.isName(t)?"undefined entity.":"disallowed character in entity name."),`&${t};`)}let s=NaN;return t[1]==="x"&&/^#x[0-9a-f]+$/i.test(t)?s=parseInt(t.slice(2),16):/^#[0-9]+$/.test(t)&&(s=parseInt(t.slice(1),10)),this.isChar(s)?String.fromCodePoint(s):(this.fail("malformed character entity."),`&${t};`)}}var re,St;(St=re||(re={})).Events={XmlDecl:"xmldecl",Text:"text",ProcessingInstruction:"processinginstruction",Doctype:"doctype",Comment:"comment",OpenTagStart:"opentagstart",Attribute:"attribute",OpenTag:"opentag",CloseTag:"closetag",CDdata:"cdata",Error:"error",End:"end",Ready:"ready"},St.parseStream=async(o,t,s)=>{const i=new ze({position:!1,...s});let n;if(t.onOpenTagStart&&i.on(St.Events.OpenTagStart,t.onOpenTagStart),t.onOpenTag&&i.on(St.Events.OpenTag,t.onOpenTag),t.onCloseTag&&i.on(St.Events.CloseTag,t.onCloseTag),t.onAttribute&&i.on(St.Events.Attribute,t.onAttribute),t.onText&&i.on(St.Events.Text,t.onText),t.onError&&i.on(St.Events.Error,t.onError),t.onEnd){t.onEnd;const a=()=>{n=t.onEnd()};i.on(St.Events.End,a)}for(;;){const{value:a,done:l}=await o.read();if(l)break;i.write(a)}return i.close(),n};const D=o=>o===!0||o==="1"||o==="on"||o==="true"||o!==!1&&o!=="0"&&o!=="off"&&o!=="false"&&null,R=o=>{const t=parseInt(o);return isNaN(t)?null:t},bt=o=>{const t=parseFloat(o);return isNaN(t)?null:t},I=null;class Ue{constructor(){this._registeredVisitors=new Map}registerVisitor(t){this._registeredVisitors.set(t.from,t)}createEventHandler(t,s,i){const n=this._registeredVisitors,a=[];let l=null,g=null,S=null,y=null;const x=[],C={key:null,source:t};let w=null,h=!1;const k=(T,m)=>{let P=S.attributes[T];if(m){if(Array.isArray(m)){for(let X=0;X<m.length;X++)if(P==null||(P=m[X](P),P==null))return}else if(P==null||(P=m(P),P==null))return}return P},f={getSource:()=>w.source,setSource:T=>{w.source=T},setKey:T=>{w.key=T},getFrom:()=>S,getAttribute:(T,m)=>k(T,m)??null,hasAttribute:T=>f.getAttribute(T)!==null,getParent:()=>x[x.length-2].source,getPath:()=>{const T=[];for(let m=0;m<a.length;m++)T.push(a[m].local);return T.join("\\")},parseAttribute:k,copyToObject:(T,m,P,X)=>{const _=k(X??m,P);_!==void 0&&(T[m]=_)},copyTo:(T,m,P)=>{const X=k(P??T,m);X!==void 0&&(w.source[T]=X)},warn:T=>{i?i?.(T):console.warn(T)}};return{onOpenTag:T=>{let m=T.name;const P=m.indexOf(":");P!==-1&&(m=m.slice(P+1));const X=n.get(m);if(l={local:m,visitor:X,tag:T,destination:null},h)return a.push(l),g=m,void(S=T);y=l?.visitor??null,X&&(w=a.length===0?C:y?.to!==null?{key:null,source:{}}:null,l.destination=w,w&&x.push(w)),a.push(l),g=m,S=T,h=y?.to===null,y?.openTag?.(f)},onCloseTag:T=>{let m=T.name;const P=m.indexOf(":");if(P!==-1&&(m=m.slice(P+1)),m!==g)throw new Error(`mismatch open/close tag: '${m}'/'${g}'`);h||y?.closeTag?.(f);const X=a.pop()??null;l=a[a.length-1]??null;const _=X?.destination;if(_){x.pop(),w=x[x.length-1]??C;const Z=X.visitor;Z&&Z.to&&_.source!==void 0&&(Array.isArray(Z.to)?w.source.push?w.source.push(_.source):i?.(`Unable to parse array for ${Z.from} at ${f.getPath()}`):_.key?w.source[_.key]=_.source:typeof Z.to=="string"&&(w.source[Z.to]=_.source))}g=l?.local??null,S=l?.tag??null,y=l?.visitor??null,h=!l?.destination},onText:T=>{y?.text?.(T,f)},onEnd:s}}}const pe=(o,t,s,i=null)=>{if(!o)return null;let n=o;n.startsWith("/")&&(n=n.substring(1));let a=i?.parsedRefs?.get(o);if(a!==void 0)return a;const l=t(n);if(!l)return null;let g=l.content;try{s&&(g=s(g))}catch(S){console.warn(S)}return i?.parsedRefs?.set(o,g),g},ne=(o,t,s,i,n=null)=>{if(!o)return null;let a=o;a.startsWith("/")&&(a=a.substring(1));let l=n?.parsedRefs?.get(o);if(l!==void 0)return l;const g=t(a);if(!g)return null;const S=g.content;try{const y=new TextDecoder().decode(S),x=s.parseFromString(y,"text/xml"),C=i.convert(x,o,n);return n?.parsedRefs?.set(o,C),C}catch(y){console.warn(y)}return null},$t=(o,t,s,i,n=null)=>{const a=new Map;let l=t.Directory[o];const g=l?l.length:0;for(let S=0;S<g;S++){const y=l[S];if(!y)continue;let x=y;x.startsWith("/")&&(x=x.substring(1));const C=ne(x,w=>t.files[w],s,i,n);a.set(x,C)}return a},Ge=async(o,t=8388608)=>{await(async()=>{if(typeof ReadableStream>"u")if(typeof window>"u"){const{ReadableStream:a}=await Ut(async()=>{const{ReadableStream:l}=await import("./CQh3UYWyoyeNy_iI-CSP5HZSd.js");return{ReadableStream:l}},[],import.meta.url);globalThis.ReadableStream=a}else console.warn("Browser does not support ReadableStream; consider loading a polyfill.")})();const s=new TextDecoder("utf-8");let i=0;const n=o instanceof Uint8Array?o:new Uint8Array(o);return new ReadableStream({pull(a){if(i>=n.byteLength)return void a.close();const l=n.subarray(i,Math.min(i+t,n.byteLength)),g=s.decode(l,{stream:i+t<n.byteLength});a.enqueue(g),i+=l.length}}).getReader()},Ze=["lt1","dk1","lt2","dk2","accent1","accent2","accent3","accent4","accent5","accent6","hlink","folHlink"],de=(o,t="dk1")=>{let s;const i=o("auto");i===void 0||i!=="1"&&i!=="true"||(s=t);const n=o("indexed");n&&(s=`index${n}`);const a=o("rgb");a&&(s=a.toLowerCase(),a.length!==8||a.startsWith("FF")||(s="FF"+a.substring(2,a.length)));const l=o("theme");l&&(s=Ze[l]);let g=o("tint");if(g&&(s+=` ${xe.AdjustmentType.ETint} ${parseFloat(g)}`),s)return s},Je=o=>o&&o.replace(/^\{([\s\S]+)\}$/,"$1"),ls=o=>o?ee.roundAccurately(parseFloat(o)/12700,4):null,cs=o=>o?ee.roundAccurately(parseFloat(o)/9525,1):null,hs=o=>parseFloat(o)/1e3,us=o=>parseFloat(o)/6e4,Qe=o=>o==="true"||o==="1",rt=class rt{};rt.Collapsed=1,rt.CustomFormat=2,rt.CustomHeight=4,rt.Hidden=8,rt.Ht=16,rt.OutlineLevel=32,rt.Ph=64,rt.R=128,rt.S=256,rt.Spans=512,rt.ThickBot=1024,rt.ThickTop=2048;let Ct=rt;const Ke=(o,t,s)=>{if(o[0].value[0]===o[1].value[0])return t},ge={colStart:0,colEnd:0,rowStart:0,rowEnd:0},Ye=(o,t,s,i,n,a)=>{let l=!1,g=!1,S=[],y=!1,x=null,C=null,w=null,h=null,k=null,f=null;const T=a?.get("richData")??[],m=yt.normalizeA1ToR1C1,P=oe.createConflatingRanges(),X=new Map,_=[];let Z=null;const Ht=oe.createConflatingRanges();let pt,at=!1,H=-1,$=-1,et=null,xt=null;const Ft=[];let Rt=null,_t=-2,lt=0,ct="",dt="",gt="",J="",ht="",ft="",wt="",Dt="",Gt="",Nt="",Zt="",Jt="",A="",z="",j=!0,W=null;return{...s,onEnd:()=>{Ft.length>0&&(t.rows=Ft);let p=P.done(Ke);const d=p.length;if(d>0){const E=new Array(d);for(let v=0;v<d;v++){const L=p[v],U=yt.rangeToString(L),st=L.value[1],ot=yt.resolveRelativeToA1(st,L.rowStart,L.colStart);E[v]=[U,ot]}t.formulas=E}const Q=Ht.done(!0),V=Q.length;if(V>0){const E=new Array(V);for(let v=0;v<V;v++){const L=Q[v],U=yt.rangeToString(L);E[v]=U}t.volatile=E}if(_.length>0&&(t.dynamicArray=[..._]),S.length>0){S.sort(oe.createRangeComparator(ke.Orientation.Column));const E=[];let v=null,L=-1,U=-1,st=-1,ot=-1,Y=null;const mt=S.length;mt>0&&(v=S[0],L=v.colStart,U=v.colEnd,st=v.rowEnd,ot=v.value,E.push(v));for(let O=1;O<mt;O++)Y=S[O],ot!==Y.value||L!==Y.colStart||U!==Y.colEnd||st+1!==Y.rowEnd?(E.push(Y),v=Y,L=v.colStart,U=v.colEnd,st=v.rowEnd,ot=v.value):(st=Y.rowEnd,v.rowEnd=st);let Bt=[];for(let O=0;O<E.length;O++){const G=E[O];Bt.push({r:{colStart:G.colStart,colEnd:G.colEnd,rowStart:G.rowStart,rowEnd:G.rowEnd},v:G.value})}t.directStyles=Bt}const K=o.build();if(K){const E=K.tuples;t.data=E}s?.onEnd?.()},onOpenTag:p=>{let d=p.name;const Q=d.indexOf(":");if(Q!==-1&&(d=d.slice(Q+1)),pt){const V=p.attributes;switch(d){case"v":g=!0;break;case"f":switch(V.t??null){case null:case"normal":y=!0;break;case"shared":const K=V.si;C=V.ref,x=K;break;case"array":y=!0,C=V.ref,Z=[C,!1];break;case"datatable":y=!0,C=V.ref,y=!0}V.ca!==void 0&&Ht.append(H,$);break;case"is":return void(at=!0)}return void(at&&n?.onOpenTag(p))}if(l){if(d==="c"){pt=p;const V=p.attributes.r;$=yt.fastStringToCol(V);const K=p.attributes.t;K===void 0?xt=null:(xt=K,xt==="str"&&(at=!0));let E=p.attributes.s;E!==void 0&&(E=parseInt(E),W&&W.value===E&&W.colEnd+1===$?W.colEnd=$:(W={colStart:$,rowStart:H,colEnd:$,rowEnd:H,value:E},S.push(W)))}}else{if(d==="row"){l=!0;const V=p.attributes.r;if(H=parseInt(V)-1,lt=0,dt=p.attributes.customHeight,dt!==void 0&&(lt|=Ct.CustomHeight),dt!==Gt&&(j=!0,Gt=dt),ct=p.attributes.ht,ct!==void 0&&(lt|=Ct.Ht),ct!==Dt&&(j=!0,Dt=ct),gt=p.attributes.hidden,gt!==void 0&&(lt|=Ct.Hidden),gt!==Nt&&(j=!0,Nt=gt),ht=p.attributes.s,ht!==void 0&&(lt|=Ct.S),ht!==Jt&&(j=!0,Jt=ht),J=p.attributes.customFormat,J!==void 0&&(lt|=Ct.CustomFormat),J!==Zt&&(j=!0,Zt=J),ft=p.attributes.outlineLevel,ft!==void 0&&(lt|=Ct.OutlineLevel),ft!==A&&(j=!0,A=ft),wt=p.attributes.collapsed,wt!==void 0&&(lt|=Ct.Collapsed),wt!==z&&(j=!0,z=wt),lt!==0)if(_t+1!==H||j){const K=dt!==void 0&&(dt==="1"||dt==="true"),E=J!==void 0&&(J==="1"||J==="true");Rt={min:H,max:H,sz:K&&ct!==void 0?parseFloat(ct):-1,csz:K,h:gt!==void 0&&(gt==="1"||gt==="true"),s:K&&ht!==void 0&&ht!=="0"?parseInt(ht):0,cs:E,l:ft===void 0||ft==="0"?0:parseInt(ft),cl:wt!==void 0&&(wt==="1"||wt==="true")},Ft.push(Rt)}else Rt.max=H;return _t=H,void(j=!1)}s?.onOpenTag(p)}},onCloseTag:p=>{if(pt){let d=p.name;const Q=d.indexOf(":");if(Q!==-1&&(d=d.slice(Q+1)),at)if(d==="is"||d==="v"){const V=n?.onEnd();V!==null&&o.addValue(H,$,""+V)}else n?.onCloseTag?.(p);return g&&(g=!1),void(d==="c"&&(pt=null,at=!1))}if(l)return l=!1,void(W=null);s?.onCloseTag(p)},onText:p=>{if(p=p.trim(),g){switch(et=null,xt){case null:case"n":et=parseFloat(p);break;case"b":et=p==="1"||p==="true";break;case"s":et=p;break;case"e":if(p==="#VALUE!"){const Q=pt.attributes.vm;if(Q!==void 0){const V=T[parseInt(Q)-1];if(V&&V.isFormulaError){et={t:Vt.Error,v:V.getCode()};break}}}const d=Ae.getBuiltInByLabel(p);d?et={t:Vt.Error,v:d.getCode()}:(et=p,i?.(`Unknown formula error '${p}' in cell ${yt.cellToString({colIndex:$,rowIndex:H})}`));break;case"str":case"inlineStr":at=!0}et!==null&&o.addValue(H,$,et)}if(Z&&(xt==="e"&&(Z[1]=!0),_.push(Z),Z=null),x)if(k===x)h=f;else{if(h=X.get(x),!h){const d=[];w=m(p,H,$,d),h=[w,d,p],X.set(x,h)}k=x,f=h}if(y){const d=[];w=m(p,H,$,d),h=[w,d,p]}if(h)return P.append(H,$,h),h=null,y=!1,x=null,void(C=null);at?n?.onText(p):l||s?.onText(p)}}},ps=Object.freeze(Object.defineProperty({__proto__:null,fromBufferXLSX:async(o,t)=>{const{password:s,onWarning:i,createWorkbookOptions:n={},...a}=t??{},l=Ut(()=>import("./C5fGGSFAeHnKNb5i-DEJB0qds.js"),[],import.meta.url),g=Ut(()=>import("./BTJ47c2yYMrLhclR-DHYJS658.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url);let S=null;try{S=new DOMParser}catch{}let y=null;S||(y=Ut(()=>import("./BewQgmfXrEMENNHa-rE7x3a6K.js"),[],import.meta.url).then(h=>h.i));let x=null,C=null,w=null;try{const h=await Promise.all([l,g,y]);x=h[0],C=h[1],w=h[2]}catch(h){throw new Error("Unable to load XLSX parser.",{cause:h})}try{const h=x.read(o,{type:"array",sheets:[],cellStyles:!1,bookFiles:!0});if(!h.Directory)throw new Error("Unable to parse as an Excel document. Try to save as '.xlsx' and try again.");h.Directory.richstructure=["/xl/richData/rdrichvaluestructure.xml"],h.Directory.richdata=["/xl/richData/rdrichvalue.xml"];const k=new C.FromOOXMLConverter,f=S??new w.DOMParser,T=n?.resources??new we,m=T.beginPersist(),P={},X=new Set,_=new Map;_.set("richTypes",[]);const Z=new Map,Ht=[],pt=A=>h.files[A],at=(A,z)=>{const j=A.lastIndexOf("/"),W=A.substring(0,j+1)+"_rels/"+A.substring(j+1,A.length)+".rels";let p=z.get(W);return p||(p=((d,Q,V,K,E=null)=>{if(!d)return null;const v=ne(d,Q,V,K,E);if(!v)return null;const L=new Map,U=Object.keys(v),st=U.length;for(let ot=0;ot<st;ot++){const Y=U[ot],mt=v[Y];L.set(Y,mt)}return L})(W,pt,f,k,$),z.set(W,p)),p},H=(A,z,j,W=Z)=>{let p=at(z,W).get(A),d=p?.target;if(!d)return null;if(p.targetMode==="External")return p.target;const Q=z.lastIndexOf("/"),V=z.substring(0,Q+1);d.startsWith("/")||(d=V+d),d=(v=>{const L=v.split(/\/+/);return L.reduce((U,st,ot)=>(st==="."?U.splice(ot,1):st===".."&&U.splice(ot-1,2),U),L).join("/")})(d);const K=k?.getVisitorParamsState().get("dxfs");let E=W.get(d);if(!E)if(p.type==="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"){const v={};E=v;const L=async()=>{const U=((O,G,se,kt,vt,At,Wt)=>{const u=new Ue,nt=new ve.TransposedBuilder;let B=null;u.registerVisitor({from:"autoFilter",to:"filter",openTag:e=>{e.copyTo("ref",I)}}),u.registerVisitor({from:"conditionalFormatting",to:{},openTag:e=>{const r=e.getParent();r.conditionals||(r.conditionals=[]),r.conditionals.push(e.getSource());const c=e.getAttribute("sqref");c&&(e.getSource().ref=c.split(" ").join(",")),e.copyTo("pivot",D)},closeTag:e=>{const r=e.getSource();if(r.rule){const c=Object.keys(r.rule);for(let b=0;b<c.length;b++){const M=c[b];M!=="rule"&&(r[M]=r.rule[M])}}delete r.rule}}),u.registerVisitor({from:"cfRule",to:"rule",openTag:e=>{const r=e.getParent();e.copyToObject(r,"type",I),e.copyToObject(r,"priority",R),e.copyToObject(r,"stopIfTrue",D);const c=e.getAttribute("dxfId",R);if(c!==null){let b=kt?.get(c);b||(At?.(`Unable to load conditional color. Invalid dxfI: '${c}' at '${e.getPath()}'.`),b={}),r.style=b}e.copyToObject(r,"aboveAverage",D),e.copyToObject(r,"equalAverage",D),e.copyToObject(r,"stdDev",R),e.copyToObject(r,"bottom",D),e.copyToObject(r,"percent",D),e.copyToObject(r,"rank",R),e.copyToObject(r,"operator",I),e.copyToObject(r,"text",I),e.copyToObject(r,"timePeriod",I)}}),u.registerVisitor({from:"colorScale",to:"colorScale"}),u.registerVisitor({from:"dataBar",to:"dataBar",openTag:e=>{e.copyTo("maxLength",R),e.copyTo("minLength",R),e.copyTo("showValue",D)}}),u.registerVisitor({from:"iconSet",to:"iconSet",openTag:e=>{e.copyTo("iconSet",I),e.copyTo("reverse",D),e.copyTo("showValue",D)}}),u.registerVisitor({from:"formula",to:null,text:(e,r)=>{const c=r.getParent();let b=c.formulas;b||(b=[],c.formulas=b),b.push(e)}}),u.registerVisitor({from:"cfvo",to:{},openTag:e=>{const r=e.getParent();r.conditions||(r.conditions=[]),r.conditions.push(e.getSource()),e.copyTo("type",I),e.copyTo("value",bt,"val"),e.copyTo("gte",D)}}),u.registerVisitor({from:"color",to:{},openTag:e=>{const r=e.getParent();r.colors||(r.colors=[]);const c=de(b=>e.getAttribute(b));r.colors.push(c)}}),u.registerVisitor({from:"filterColumn",to:"filterColumn",openTag:e=>{const r=e.getParent();r.fields||(r.fields=[]),r.fields.push(e.getSource()),e.copyTo("offset",R,"colId"),e.copyTo("hiddenButton",D),e.copyTo("showButton",D)}}),u.registerVisitor({from:"colorFilter",to:"colorFilter",openTag:e=>{const r=e.getParent();r.criteria||(r.criteria=[]),r.criteria.push(e.getSource()),e.getSource().type=Lt.Type.Color,e.copyTo("cellColor",D),e.copyTo("styleId",R,"dxfId")}}),u.registerVisitor({from:"dynamicFilter",to:"dynamicFilter",openTag:e=>{const r=e.getParent();r.criteria||(r.criteria=[]),r.criteria.push(e.getSource()),e.getSource().type=Lt.Type.Dynamic,e.copyTo("dynamicType",I,"type"),e.copyTo("val",bt),e.copyTo("maxVal",bt,"maxVal")}}),u.registerVisitor({from:"iconFilter",to:"iconFilter",openTag:e=>{const r=e.getParent();r.criteria||(r.criteria=[]),r.criteria.push(e.getSource()),e.getSource().type=Lt.Type.Icon,e.copyTo("iconId",R),e.copyTo("iconSet",I)}}),u.registerVisitor({from:"top10",to:"top10",openTag:e=>{const r=e.getParent();r.criteria||(r.criteria=[]),r.criteria.push(e.getSource()),e.getSource().type=Lt.Type.Top10,e.copyTo("filterVal",bt),e.copyTo("percent",D),e.copyTo("top",D),e.copyTo("val",bt)}}),u.registerVisitor({from:"filters",to:"filters",openTag:e=>{const r=e.getParent();r.criteria||(r.criteria=[]),r.criteria.push(e.getSource()),e.getSource().type=Lt.Type.Items,e.copyTo("blank",D),e.copyTo("calendarType",I)}}),u.registerVisitor({from:"dateGroupItem",to:"dateGroupItem",openTag:e=>{const r=e.getParent();r.dateGroups||(r.dateGroups=[]),r.dateGroups.push(e.getSource()),e.copyTo("group",I,"dateTimeGrouping"),e.copyTo("day",R),e.copyTo("hour",R),e.copyTo("minute",R),e.copyTo("month",R),e.copyTo("second",R),e.copyTo("year",R)}}),u.registerVisitor({from:"filter",to:"filter",openTag:e=>{const r=e.getParent();r.items||(r.items=[]),r.items.push(e.getAttribute("val",bt))}}),u.registerVisitor({from:"customFilters",to:"customFilters",openTag:e=>{const r=e.getParent();r.criteria||(r.criteria=[]),r.criteria.push(e.getSource()),e.getSource().type=Lt.Type.Custom,e.copyTo("and",D)}}),u.registerVisitor({from:"customFilter",to:"customFilter",openTag:e=>{const r=e.getParent();r.filters||(r.filters=[]),r.filters.push(e.getSource()),e.copyTo("operator",I),e.copyTo("value",bt,"val")}}),u.registerVisitor({from:"sortState",to:"sort",openTag:e=>{e.copyTo("ref",I)}}),u.registerVisitor({from:"sortCondition",to:"sortCondition",openTag:e=>{const r=e.getParent();r.fields||(r.fields=[]);const c=e.getSource();r.fields.push(c),e.copyTo("sortOn",I,"sortBy"),e.copyTo("dxfId",I,"sortBy"),e.copyTo("iconSet",I),e.copyTo("customList",I);const b=e.getAttribute("ref");if(b){const M=yt.fastStringToRange(b,ge).colStart,Ot=yt.fastStringToRange(r.ref,ge),Kt=Ot.colStart;c.offset=Ot?M-Kt:M}c.reverse=e.getAttribute("descending",D)??!1}}),u.registerVisitor({from:"AlternateContent",to:null});const Qt=e=>{B=e.getSource(),e.copyTo("topLeft",I,"topLeftCell");const r=Qe(e.getAttribute("defaultGridColor")),c=e.getAttribute("colorId");c===null||r||(e.getSource().gridLineColor="index"+parseFloat(c)),e.copyTo("showZeros",D),e.copyTo("showFormulas",D),e.copyTo("zoomScale",R),e.copyTo("showRowHeaders",D,"showRowColHeaders"),e.copyTo("showColumnHeaders",D,"showRowColHeaders"),e.copyTo("showRowGridlines",D,"showGridLines"),e.copyTo("showColumnGridlines",D,"showGridLines")};u.registerVisitor({from:"sheetView",to:"view",openTag:e=>{Qt(e)},closeTag:()=>{B=null}}),u.registerVisitor({from:"customSheetViews",to:"customSheetViews",openTag:e=>{e.setSource([])}}),u.registerVisitor({from:"customSheetView",to:[],openTag:e=>{Qt(e)},closeTag:()=>{B=null}}),u.registerVisitor({from:"selection",to:"selection",openTag:e=>{if(!B)return;e.copyTo("cell",I,"activeCell"),e.copyTo("rangeIndex",R,"activeCellId");const r=e.getAttribute("activeCell"),c=e.getAttribute("sqref");c&&c!==r&&(e.getSource().ranges=c.split(" "))}}),u.registerVisitor({from:"pane",to:"pane",openTag:e=>{if(B&&e.getAttribute("state")==="frozen"){const r={};B.freezePanes=r,e.copyToObject(r,"topLeft",I,"topLeftCell");const c=B.topLeft?yt.fastStringToCell(B.topLeft):{colIndex:0,rowIndex:0},b={colIndex:0,rowIndex:0};e.copyToObject(b,"colIndex",R,"xSplit"),e.copyToObject(b,"rowIndex",R,"ySplit");const M={colIndex:c.colIndex+b.colIndex,rowIndex:c.rowIndex+b.rowIndex};r.coords=yt.cellToString(M)}}}),u.registerVisitor({from:"tabColor",to:null,openTag:e=>{const r=de(c=>e.getAttribute(c));r&&(O.tabColor=r)}}),u.registerVisitor({from:"pageSetUpPr",to:"pageSetUpPr",openTag:e=>{}}),u.registerVisitor({from:"outlinePr",to:"outlinePr",openTag:e=>{}}),u.registerVisitor({from:"pageMargins",to:"pageMargins",openTag:e=>{}}),u.registerVisitor({from:"pageSetup",to:"pageSetup",openTag:e=>{}}),u.registerVisitor({from:"printOptions",to:"printOptions",openTag:e=>{}}),u.registerVisitor({from:"mergeCells",to:"merges",openTag:e=>{e.setSource([])}}),u.registerVisitor({from:"mergeCell",to:[],openTag:e=>{const r=e.getAttribute("ref");e.setSource(r)}}),u.registerVisitor({from:"hyperlinks",to:"hyperlinks",openTag:e=>{e.setSource([])}}),u.registerVisitor({from:"hyperlink",to:[],openTag:e=>{const r=e.getAttribute("r:id"),c=e.getAttribute("ref");if(!c)return void console.warn("No ref found for hyperlink");e.setKey(c);let b=r?G(r):"";if(typeof b!="string")return void console.warn("Invalid address ",b);const M=e.getAttribute("location");b.endsWith("\\")&&(b=b.substring(0,b.length-1));const Ot=e.getAttribute("location");if(Ot&&(M&&M!==Ot&&console.warn("display and location are different",M,Ot),b+="#"+Ot),!b)return void console.warn("No address found for hyperlink. r:id",r);let Kt;const ae=e.getAttribute("tooltip");Kt=ae?{address:b,tooltip:ae}:b,e.setSource({r:c,v:Kt})}}),u.registerVisitor({from:"drawing",to:"movables",openTag:e=>{const r=e.getAttribute("r:id");if(!r)return;const c=G(r);c?e.setSource(c.movables):console.warn("no drawing found for rId",r)}}),u.registerVisitor({from:"tableParts",to:"tables",openTag:e=>{e.setSource([])}}),u.registerVisitor({from:"tablePart",to:[],openTag:e=>{const r=e.getAttribute("r:id");if(!r)return;const c=G(r);c?e.setSource(c):console.warn("no table found for rId",r)}}),u.registerVisitor({from:"worksheet",to:"worksheet",openTag:e=>{}}),u.registerVisitor({from:"sheetProtection",to:"protection",openTag:e=>{let r=!1;if(e.hasAttribute("sheet")&&D(e.getAttribute("sheet"))&&(r=!0),!r)return void e.setSource(void 0);const c=M=>M===!0||M==="1"||M==="on"||M==="true"||M===!1||M==="0"||M==="off"||M==="false"||null;e.copyTo("autoFilter",c),e.copyTo("deleteColumns",c),e.copyTo("formatCells",c),e.copyTo("formatColumns",c),e.copyTo("formatRows",c),e.copyTo("insertColumns",c),e.copyTo("insertHyperlinks",c),e.copyTo("insertRows",c),e.copyTo("objects",c),e.copyTo("pivotTables",c),e.copyTo("scenarios",c),e.copyTo("selectUnlockedCells",c),e.copyTo("selectUnlockedCells",c),e.copyTo("sort",c);const b={};e.copyToObject(b,"hash",I,"hashValue"),e.copyToObject(b,"algorithm",I,"algorithmName"),e.copyToObject(b,"salt",I,"saltValue"),e.copyToObject(b,"spinCount",R),Object.keys(b).length>0&&(e.getSource().password=b)}}),u.registerVisitor({from:"protectedRanges",to:"protectedRanges",openTag:e=>{e.setSource({})}}),u.registerVisitor({from:"protectedRange",to:{},openTag:e=>{const r=e.getAttribute("sqref");e.setKey(r),e.copyTo("name"),e.copyTo("securityDescriptor");const c={};e.copyToObject(c,"hash",I,"hashValue"),e.copyToObject(c,"algorithm",I,"algorithmName"),e.copyToObject(c,"salt",I,"saltValue"),e.copyToObject(c,"spinCount",R),Object.keys(c).length>0&&(e.getSource().password=c)}}),u.registerVisitor({from:"sheetFormatPr",to:"sheetFormatPr",openTag:e=>{e.copyToObject(O,"defaultColSize",bt,"defaultColWidth"),e.copyToObject(O,"outlineLevelCol",R,"outlineLevelCol");const r=e.getAttribute("customHeight");r!=="1"&&r!=="true"||e.copyToObject(O,"defaultRowSize",bt,"defaultRowHeight"),e.copyToObject(O,"outlineLevelRow",R,"outlineLevelRow")}}),u.registerVisitor({from:"cols",to:"cols",openTag:e=>{e.setSource([])}}),u.registerVisitor({from:"col",to:[],openTag:e=>{e.copyTo("min",r=>parseInt(r)-1),e.copyTo("max",r=>parseInt(r)-1),e.copyTo("sz",bt,"width"),e.copyTo("cs",D,"customWidth"),e.copyTo("h",D,"hidden"),e.copyTo("l",R,"outlineLevel"),e.copyTo("s",R,"style")}}),u.registerVisitor({from:"oleObjects",to:null,openTag:e=>{e.warn("'OLE Objects' are not supported.")}});let qt=null;const ye={onOpenTag:e=>{qt===null&&(qt="")},onText:e=>{qt+=e},onEnd:()=>{const e=se(qt);return qt=null,e},onError:e=>{}};return Ye(nt,O,u.createEventHandler(O,vt,At),At,ye,Wt)})(v,(O,G=!1)=>H(O,d,G)??null,lt,K,()=>{},O=>{i&&(O=d+": "+O,i?.(O))},_),st=pe(d,pt),ot=await Ge(st);try{await re.parseStream(ot,U,{xmlns:!1})}catch(O){throw console.warn(`Error parsing sheet: '${d}'`,O),new Error(`Error parsing sheet: '${d}'`,{cause:O})}const Y=at(d,W);let mt,Bt=new Map;if(Y){const O="http://schemas.microsoft.com/office/2017/10/relationships/threadedComment";let G;Y.forEach((kt,vt)=>{kt.type===O&&(mt=H(vt,d,!1,W)?.comments,mt&&mt.forEach(At=>{Bt.set(At.id,At)}))});const se="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments";if(Y.forEach((kt,vt)=>{kt.type===se&&(G=H(vt,d,!1,W))}),G||mt){const kt=mt??[],vt=G?.comments;if(vt){const At=G?.authors;for(let Wt=0;Wt<vt.length;Wt++){const u=vt[Wt];let nt=u.authorId!==void 0?At[u.authorId]:void 0;if((!nt||nt.startsWith("tc="))&&(nt=Je(nt.substring(3)),Bt.has(nt)))continue;let B=ct.get(nt);B||(B=dt.get(nt)),B||(B={id:ee.uuidV4(),displayName:nt},dt.set(B.displayName,B),ct.set(B.id,B)),nt=B?.id??null;const Qt={id:ee.uuidV4(),personId:nt,ref:u.ref,done:!1,asNote:!0,content:u.content};kt.push(Qt)}}v.comments=kt}}};Ht.push(L())}else E=j?pe(d,pt,v=>{const L=T.add({buffer:v});return L.addReference(P),X.add(L),m.toResourceId(L)},$):ne(d,pt,f,k,$);return E},$={paramMap:_,getRefs:at,getRef:H,parsedRefs:Z,onWarning:i,addPerson:A=>null},et=[];let xt=0;h.Strings&&(xt=parseInt(h.Strings.Unique??h.Strings.length??0));const Ft=h.Strings??[];for(let A=0;A<xt;A++)et.push(Ft[A]?.t??"");const Rt=new Map;let _t=xt;const lt=A=>{const z=Rt.get(A);if(z!==void 0)return z;const j=_t;return Rt.set(A,_t++),et.push(A),j},ct=($t("richstructure",h,f,k,$),$t("richdata",h,f,k,$),new Map),dt=new Map,gt=$t("people",h,f,k);let J=null;if(gt.size>0&&(J=gt.entries().next()?.value?.[1]?.persons,J)){const A=J.length;for(let z=0;z<A;z++){const j=J[z];ct.set(j.id,j),ct.set(j.displayName,j)}}const ht=$t("themes",h,f,k,$);let ft=null;if(ht&&ht.entries){let A=ht.entries().next();A?.value?.[1]&&(ft=A.value[1])}const wt=new Se(ft);let Dt=$t("styles",h,f,k,$).entries().next()?.value[1];Dt&&(Dt=JSON.parse(Ee(Dt)));const Gt=$t("workbooks",h,f,k,$);await Promise.all(Ht);const Nt={...Gt.entries().next().value[1],styles:Dt,theme:wt.toJSON()};et.length>0&&(Nt.strings=et),J&&J.length>0&&(Nt.people=J);const Zt={...n,resources:T,json:Nt},Jt=new Ce(Zt);return X.forEach(A=>{A.deleteReference(P)}),m.endPersist(),Jt}catch(h){let k="Unable to parse XLSX.";throw h instanceof De&&(k="Unable to open XLSX. There are too many rows or columns."),new Error(k,{cause:h})}},toBufferXLSX:async(o,t)=>{const s=await Ut(()=>import("./C5fGGSFAeHnKNb5i-DEJB0qds.js"),[],import.meta.url),i=await o.toJSON(!0),n=s.utils.book_new();for(let a=0;a<i.sheets.length;a++){const l=i.sheets[a],g=s.utils.json_to_sheet([{}]);s.utils.book_append_sheet(n,g,l.name);const S=l.sheet,y=o.getSheetAt(a),x=y.getUsedRange();if(x?(g["!ref"]=x.getA1(),x.forEach((C,w)=>{const h={t:"z"},k=w.getCell().getStyle();if(!k.isNormal()){let f=k.getNumberFormat();f!==It.Type.General&&(f===It.Type.ShortDate?f="m/d/yyyy":f===It.Type.MediumDate?f="d-mmm-yy":f===It.Type.LongDate?f="[$-x-sysdate]dddd, mmmm dd, yyyy":f===It.Type.ShortTime?f="h:mm":f===It.Type.MediumTime?f="h:mm AM/PM":f===It.Type.LongTime&&(f="h:mm:ss AM/PM"),h.z=f)}if(C!==null)switch(w.getType()){case Vt.Number:h.t="n",h.v=C;break;case Vt.String:h.t="s",h.v=C;break;case Vt.Boolean:h.t="b",h.v=C;break;case Vt.Error:h.t="e",h.v=C.toString();case Vt.RichData:}g[w.getA1()]=h})):g["!ref"]="A1:A1",S.merges?.length>0){const C=[];g["!merges"]=C;for(let w=0;w<S.merges.length;w++)C.push(s.utils.decode_range(S.merges[w]))}if(S.cols?.length>0){const C=[];g["!cols"]=C;const w=S.cols,h={width:S.defaultColSize??y.getColumnWidthAsFontUnit(y.getColumnHeaders().getDefaultSize())};for(let k=0;k<w.length;k++){const f=w[k];for(let m=C.length;m<=f.min-1;m++)C.push(h);const T={};f.sz!==void 0&&(T.width=f.sz),f.h!==void 0&&(T.hidden=f.h),f.l!==void 0&&(T.level=f.l);for(let m=f.min;m<=f.max;m++)C.push(T)}}}return s.write(n,{type:"array",bookType:"xlsx"}),s.write(n,{type:"array",bookType:"xlsx"})}},Symbol.toStringTag,{value:"Module"}));export{hs as a,Qe as b,cs as c,de as d,ps as i,us as p,Je as r,ls as t};
