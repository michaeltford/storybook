import{j as E,r as Xn}from"./index-J-Hv9Xln.js";import{r as h,m as pt}from"./iframe-CBk8unIv.js";import{c as Gn}from"./client-vjV3QKWK.js";/**
 * @license @sheetxl/utils - Utils - Utilities used by most SheetXL components. - v0.6.6
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const ar={Up:"up",Down:"down",Left:"left",Right:"right"},cr={TopLeft:"tl",Top:"t",TopRight:"tr",Left:"l",Center:"c",Right:"r",BottomLeft:"bl",Bottom:"b",BottomRight:"br"},P={html:"text/html",plain:"text/plain",png:"image/png"},Zn=Object.freeze({left:0,top:0}),Jn=Object.freeze({left:0,top:0,bottom:0,right:0}),Qn=Object.freeze({x:0,y:0,width:0,height:0}),ur=Object.freeze(Object.defineProperty({__proto__:null,EmptyBounds:Qn,EmptyRect:Jn,EmptyTopLeft:Zn},Symbol.toStringTag,{value:"Module"})),Z={Column:"column",Row:"row"},hr={...Z,Both:"both"},to=Object.freeze({colIndex:0,rowIndex:0}),eo=Object.freeze({colStart:0,rowStart:0,colEnd:0,rowEnd:0}),rn=(e,t)=>e.colStart===t.colStart?e.rowStart-t.rowStart:e.colStart-t.colStart,sn=(e,t)=>e.rowStart===t.rowStart?e.colStart-t.colStart:e.rowStart-t.rowStart,no=(e,t)=>e.rowEnd===t.rowEnd?t.colEnd-e.colEnd:t.rowEnd-e.rowEnd,oo=(e,t)=>e.colEnd===t.colEnd?t.rowEnd-e.rowEnd:t.colEnd-e.colEnd,Ee=(e,t)=>e.colIndex===t.colIndex?e.rowIndex-t.rowIndex:e.colIndex-t.colIndex,Ce=(e,t)=>e.rowIndex===t.rowIndex?e.colIndex-t.colIndex:e.rowIndex-t.rowIndex,Te=(e,t)=>e.rowIndex===t.rowIndex?t.colIndex-e.colIndex:t.rowIndex-e.rowIndex,Le=(e,t)=>e.colIndex===t.colIndex?t.rowIndex-e.rowIndex:t.colIndex-e.colIndex,ln=(e=Z.Row,t=!1)=>t?e!==Z.Column?no:oo:e!==Z.Column?sn:rn,Me=(e,t)=>e===t||!(!e||!t)&&e.rowIndex===t.rowIndex&&e.colIndex===t.colIndex,ne=(e,t)=>e===t||!(!e||!t)&&e.rowStart===t.rowStart&&e.rowEnd===t.rowEnd&&e.colStart===t.colStart&&e.colEnd===t.colEnd,oe=(e,t)=>!(!e||!t)&&!(e.colStart>t.colEnd||t.colStart>e.colEnd)&&!(e.rowStart>t.rowEnd||t.rowStart>e.rowEnd),ke=(e,t)=>{if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!ne(e[n],t[n]))return!1;return!0},Ht=(e,t,n)=>{if(!e&&!t)return null;if(!e)return n?t:{...t};if(!t)return n?e:{...e};const o=Math.min(e.colStart,t.colStart),r=Math.min(e.rowStart,t.rowStart),i=Math.max(e.colEnd,t.colEnd),s=Math.max(e.rowEnd,t.rowEnd);let l=n;return l?(l.colStart=o,l.rowStart=r,l.colEnd=i,l.rowEnd=s):l={colStart:o,rowStart:r,colEnd:i,rowEnd:s},l},Oe=(e,t)=>{if(!t||t.length===0)return e;const n={...e};for(let o=0;o<t.length;o++){const r=t[o];oe(n,r)&&(n.rowStart=Math.min(n.rowStart,r.rowStart),n.colStart=Math.min(n.colStart,r.colStart),n.rowEnd=Math.max(n.rowEnd,r.rowEnd),n.colEnd=Math.max(n.colEnd,r.colEnd))}return n},ro=[null,null],io=(e,t,n)=>{if(e[0].value===e[1].value)return t};function je(e,t=2,n,o=Z.Row,r){let i=[...e];if(t<=0||e.length<=1)return i;let s=o===Z.Column,l=0,a=!1;do{const c=i.sort(ln(s?Z.Row:Z.Column));i=[],i.push(c[0]);const u=c.length;let f=0,d=c[0],p=d.colStart,_=d.rowStart,b=d.colEnd,x=d.rowEnd;for(let M=1;M<u;M++){const m=c[M];let v=!1;if(v=s?d&&_===m.rowStart&&x===m.rowEnd&&b+1===m.colStart:d&&p===m.colStart&&b===m.colEnd&&x+1===m.rowStart,v){let g={colStart:p,rowStart:_,colEnd:s?m.colEnd:b,rowEnd:s?x:m.rowEnd};if(d.value!==void 0&&(g.value=d.value),n){const j=r??[null,null];j[0]=d,j[1]=m,g=n(j,g,o)}if(g){i[f]=g,a=!0,d=g,p=d.colStart,_=d.rowStart,b=d.colEnd,x=d.rowEnd;continue}}i[++f]=m,d=m,p=d.colStart,_=d.rowStart,b=d.colEnd,x=d.rowEnd}l++,s=!s,l===1&&(a=!0)}while(l<t&&a&&i.length>1);return i}const dr=Object.freeze(Object.defineProperty({__proto__:null,EmptyCell:to,EmptyRange:eo,cellToRange:(e,t)=>{if(!e)return null;let n=t;return n||(n={...e},delete n.colIndex,delete n.rowIndex),n.colStart=e.colIndex??0,n.rowStart=e.rowIndex??0,n.colEnd=e.colIndex??0,n.rowEnd=e.rowIndex??0,n},columnFirstCellComparator:Ee,columnFirstRangeComparator:rn,createCellComparator:(e=Z.Row,t=!1)=>t?e!==Z.Column?Te:Le:e!==Z.Column?Ce:Ee,createConflatingRanges:(e,t=!1)=>{const n=[];let o,r,i=Number.MIN_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;return{append:(l,a,c)=>{let u=!0;const f=c!==void 0;if(f){const _=e?e(r,c,t):r===c?c:void 0;_===void 0?u=!1:c=_}if(u&&a===s+1&&l===i)return t?o.rowEnd=a:o.colEnd=a,s=a,void(r=c);o&&n.push(o);const d=t?l:a,p=t?a:l;o={colStart:d,rowStart:p,colEnd:d,rowEnd:p},f&&(o.value=c),i=l,s=a,r=c},done:l=>(o&&(n.push(o),o=null),l?je(n,3,l===!0?io:l,t?Z.Column:Z.Row,ro):n)}},createRangeComparator:ln,defaultRange:(e,t,n)=>e?n?(n.colStart=e.colStart??t.colStart,n.rowStart=e.rowStart??t.rowStart,n.colEnd=e.colEnd??t.colEnd,n.rowEnd=e.rowEnd??t.rowEnd,n):{colStart:e.colStart??t.colStart,rowStart:e.rowStart??t.rowStart,colEnd:e.colEnd??t.colEnd,rowEnd:e.rowEnd??t.rowEnd}:t,extendRangeToIntersectingRanges:Oe,extendRangeToUnionRanges:(e,t)=>{if(!t||t.length===0)return e;let n=e,o=null;for(;!ne(n,o);)o=n,n=Oe(o,t);return n},indexOfCoords:(e,t)=>{const n={colStart:e.colIndex,rowStart:e.rowIndex,colEnd:e.colIndex,rowEnd:e.rowIndex};for(let o=t.length-1;o>=0;o--)if(oe(n,t[o]))return o;return-1},intersectRanges:(e,t,n)=>{if(!e)return n?t:{...t};if(!t)return n?e:{...e};if(!e&&!t||e.rowStart>t.rowEnd||e.rowEnd<t.rowStart||e.colStart>t.colEnd||e.colEnd<t.colStart)return null;const o=Math.max(e.colStart,t.colStart),r=Math.max(e.rowStart,t.rowStart),i=Math.min(e.colEnd,t.colEnd),s=Math.min(e.rowEnd,t.rowEnd);let l=n;return l?(l.colStart=o,l.rowStart=r,l.colEnd=i,l.rowEnd=s):l={colStart:o,rowStart:r,colEnd:i,rowEnd:s},l},isCellWithinRange:(e,t)=>{if(!e||!t)return!1;const n=e.rowIndex;if(n<t.rowStart||n>t.rowEnd)return!1;const o=e.colIndex;return!(o<t.colStart||o>t.colEnd)},isEqualCells:Me,isEqualRanges:ne,isEqualRangesArrays:ke,isEqualSelectionCoords:(e,t)=>e===t||!(!e||!t)&&e.rangeIndex===t.rangeIndex&&!!Me(e.cell,t.cell)&&ke(e.ranges,t.ranges),isRangeWithinRange:(e,t)=>!(e.rowStart<t.rowStart||e.rowEnd>t.rowEnd)&&!(e.colStart<t.colStart||e.colEnd>t.colEnd),isRangesIntersect:oe,isSingleCell:e=>!!e&&e.rowEnd===e.rowStart&&e.colStart===e.colEnd,isValidRange:e=>!!e&&!(typeof e.colStart!="number"||e.colStart<0)&&!(typeof e.colEnd!="number"||e.colEnd<e.colStart)&&!(typeof e.rowStart!="number"||e.rowStart<0)&&!(typeof e.rowEnd!="number"||e.rowEnd<e.rowStart),mergeRangedValues:je,reverseColumnFirstCellComparator:Le,reverseRowFirstCellComparator:Te,rowFirstCellComparator:Ce,rowFirstRangeComparator:sn,sanitizeRange:e=>e?{colStart:e.colIndex??e.colStart??0,rowStart:e.rowIndex??e.rowStart??0,colEnd:e.colIndex??e.colEnd??0,rowEnd:e.rowIndex??e.rowEnd??0}:null,translateRange:(e,t=-e.rowStart,n=-e.colStart,o)=>o?(o.colStart=e.colStart+n,o.rowStart=e.rowStart+t,o.colEnd=e.colEnd+n,o.rowEnd=e.rowEnd+t,o):{colStart:e.colStart+n,rowStart:e.rowStart+t,colEnd:e.colEnd+n,rowEnd:e.rowEnd+t},unionRanges:Ht,unionRangesArrays:(e,t,n)=>{if(!e||e.length===0)return null;if(e.length===1&&!t)return e[0];let o=e[0];for(let r=1;r<e.length;r++)o=Ht(o,e[r],n);return t&&(o=Ht(o,t,n)),o}},Symbol.toStringTag,{value:"Module"}));function so(e){const t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||function(n){return n.$$typeof===lo}(e)}const lo=typeof Symbol=="function"&&Symbol.for?Symbol.for("react.element"):60103;function ao(e){return function(t){return!!t&&typeof t=="object"}(e)&&!so(e)}function Mt(e,t){return t.clone!==!1&&t.isMergeableObject(e)?mt((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function co(e,t,n){return e.concat(t).map(function(o){return Mt(o,n)})}function De(e){return Object.keys(e).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(n){return Object.propertyIsEnumerable.call(t,n)}):[]}(e))}function Pe(e,t){try{return t in e}catch{return!1}}function uo(e,t,n){const o={};return n.isMergeableObject(e)&&De(e).forEach(function(r){o[r]=Mt(e[r],n)}),De(t).forEach(function(r){(function(i,s){return Pe(i,s)&&!(Object.hasOwnProperty.call(i,s)&&Object.propertyIsEnumerable.call(i,s))})(e,r)||(Pe(e,r)&&n.isMergeableObject(t[r])?o[r]=function(i,s){if(!s.customMerge)return mt;const l=s.customMerge(i);return typeof l=="function"?l:mt}(r,n)(e[r],t[r],n):o[r]=Mt(t[r],n))}),o}function mt(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||co,n.isMergeableObject=n.isMergeableObject||ao,n.cloneUnlessOtherwiseSpecified=Mt;const o=Array.isArray(t);return o===Array.isArray(e)?o?n.arrayMerge(e,t,n):uo(e,t,n):Mt(t,n)}mt.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(n,o){return mt(n,o,t)},{})};const ho=Object.freeze([]),fo=Object.freeze({}),Re=e=>e,$t=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return(e==="x"?t:3&t|8).toString(16)}),po=e=>1*e,an=(e,t)=>e===t||!(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)&&e.every((n,o)=>n===t[o]),Ct=e=>typeof e=="object"&&!Array.isArray(e)&&e!==null,cn=e=>typeof e!="object"||Array.isArray(e)||e===null?e:(Object.keys(e).forEach(function(t){e[t]&&typeof e[t]=="object"?cn(e[t]):e[t]!==null&&e[t]!==void 0||delete e[t],typeof e[t]=="object"&&Object.keys(e[t]).length===0&&delete e[t]}),Object.keys(e).length===0?null:e),mo=(e,t)=>!(e!==t&&!an(e,t))||!!e.isEqual?.(t),un=(e,t,n=mo)=>{if(e==null||e===t)return null;if(!e||typeof e!="object"||Array.isArray(e)||e.isImmutable?.())return n(e,t)?null:e;const o=Object.keys(e);if(o.length===0)return null;let r=!1;for(let i=0;i<o.length;i++){const s=o[i];un(e[s],t?.[s],n)===null&&(r=!0,delete e[s])}return r&&Object.keys(e).length===0?null:void 0},Ae=typeof performance=="object"&&typeof performance.now=="function"?()=>performance.now():()=>Date.now(),Ie=e=>e==null,ze=(e,t)=>!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top),$e=!(typeof window>"u"||!window.document||!window.document.createElement),q={Windows:"windows",MacOS:"macos",IOS:"ios",Linux:"linux",Android:"android",Safari:"safari",Firefox:"firefox",Node:"node",Unknown:"unknown"},kt=()=>{if(hn())return q.Node;const e=globalThis.navigator!==void 0&&globalThis.navigator.userAgent?globalThis.navigator.userAgent.toLowerCase():"";return e?/(win32|win64|windows|wince)/i.test(e)?q.Windows:/(macintosh|macintel|macppc|mac68k|macos)/i.test(e)?q.MacOS:/(iphone|ipad|ipod)/i.test(e)?q.IOS:/android/.test(e)?q.Android:/linux/.test(e)?q.Linux:/^((?!chrome|android|).)*safari/i.test(e)?q.Safari:/^((?!chrome|android|Seamonkey).)*firefox/i.test(e)?q.Firefox:q.Unknown:q.Unknown};function hn(){return typeof process<"u"&&process.release?.name==="node"||(typeof process<"u"&&process.browser,!1)}const Be=(e,t=!1)=>(document.hasFocus()||t)&&(e===document.activeElement||e?.contains(document.activeElement)),tt=Object.freeze(Object.defineProperty({__proto__:null,EmptyArray:ho,EmptyObject:fo,OSType:q,arrayMove:function(e,t,n){const o=e.slice();return o.splice(n<0?o.length+n:n,0,o.splice(t,1)[0]),o},asNumber:e=>{const t=po(e);return Number.isFinite(t)?t:0},camelToPrettyCase:e=>e.length===1?e.toUpperCase():e.replace(/([A-Z])/g," $1").replace(/^./,function(t){return t.toUpperCase()}).trim(),canUseDOM:$e,cancelTimeout:e=>{cancelAnimationFrame(e.id)},castToString:e=>e==null||e===void 0?"":typeof e!="string"?""+e:e,cloneObject:e=>Ie(e)?e:JSON.parse(JSON.stringify(e)),consoleWithNoSource:(...e)=>new Promise(t=>{setTimeout(()=>{Function("console.log.apply(console, arguments)").apply(null,e),t()})}),debounce:function(e,t=300,n=!1){let o,r,i,s,l=0;function a(){let u=Date.now()-l;u<t&&u>=0?o=setTimeout(a,t-u):(o=null,n||(s=e.apply(i,r),i=r=null))}t==null&&(t=100);const c=function(){i=globalThis,r=arguments,l=Date.now();var u=n&&!o;return o||(o=setTimeout(a,t)),u&&(s=e.apply(i,r),i=r=null),s};return c.clear=function(){o&&(clearTimeout(o),o=null)},c.flush=function(){o&&(s=e.apply(i,r),i=r=null,clearTimeout(o),o=null)},c},deepEqual:function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;let o,r,i;if(Array.isArray(t)){if(o=t.length,o!=n.length)return!1;for(r=o;r--!==0;)if(!e(t[r],n[r]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(r of t.entries())if(!n.has(r[0]))return!1;for(r of t.entries())if(!e(r[1],n.get(r[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(r of t.entries())if(!n.has(r[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if(o=t.length,o!=n.length)return!1;for(r=o;r--!==0;)if(t[r]!==n[r])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(i=Object.keys(t),o=i.length,o!==Object.keys(n).length)return!1;for(r=o;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[r]))return!1;for(r=o;r--!==0;){let s=i[r];if((s!=="_owner"||!t.$$typeof)&&!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n},deepFreeze:function e(t){return Object.freeze(t),Object.keys(t).forEach(n=>{typeof t[n]!="object"||t[n]===null||Object.isFrozen(t[n])||e(t[n])}),t},deepMerge:mt,diffValues:(e,t)=>{const n={},o=Object.keys(t),r=o.length;for(let i=0;i<r;i++){const s=o[i];e[s]!==t[s]&&(e[s]===void 0?n[s]=t[s]:n[s]=e[s])}return Object.keys(n).length===0?null:n},findEqualOrGreater:function(e,t,n=Re){let o=0,r=e.length-1;for(;o<=r;){let i=Math.floor((o+r)/2),s=n(e[i]);if(s===t)return i;s<t?o=i+1:r=i-1}return o},findEqualOrLesser:function(e,t,n=Re){let o=e.length-1,r=0;for(;o>=r;){let i=Math.floor((o+r)/2),s=n(e[i]);if(s===t)return i;s>t?o=i-1:r=i+1}return o},findNextStep:(e,t=!0,n=15,o=10,r=400)=>{const i=Math.max(e-o,0)+(t?1:-1);return Math.min(r,Math[t?"ceil":"floor"](i/n)*n+o)},getDPI:()=>{let e=1;return typeof window=="object"&&(e=window.devicePixelRatio||1),e},getFromPath:(e,t)=>{const n=t.split(".");let o=e;for(let r=0;r<n.length;r++){const i=n[r];if(!o)return null;let s=o[i];if(typeof s=="function"&&(s=s.bind(o)()),!s||!Ct(s))return s;o=s}return o??null},getOS:kt,hasFocus:Be,isDefined:e=>e!=null,isEmpty:e=>e==null||e==="",isEqualArrays:an,isEqualBounds:(e,t)=>e===t||!(e&&!t||t&&!e)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height,isEqualObjectKeys:(e,t)=>{if(e===t)return!0;if(e&&!t||t&&!e)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let o=0;o<n.length;o++)if(e[n[o]]!==t[n[o]])return!1;return!0},isNode:hn,isNullOrUndefined:Ie,isNumeric:e=>{const t=1*e;return Number.isFinite(t)&&typeof t=="number"},isObject:Ct,isPromiseLike:e=>!!e&&typeof e.then=="function",isRectInsideRect:(e,t)=>e.top>=t.top&&e.bottom<=t.bottom&&e.left>=t.left&&e.right<=t.right,isRectIntersect:ze,mergeContentful:(...e)=>{const t=e.length;if(t>0&&e[t-1]!==void 0&&!Ct(e[t-1]))return e[t-1];let n=e[0]||{};for(let o=1;o<t;o++)n=mt(n,e[o]||{},{arrayMerge:(r,i)=>[...i]});return n},nextTick:e=>{typeof window<"u"&&typeof window.requestAnimationFrame=="function"?window.requestAnimationFrame(()=>{e()}):(typeof setImmediate=="function"?setImmediate:setTimeout)(()=>{e()})},openFileDialog:(e="*.*")=>new Promise((t,n)=>{if(!$e)return void n("Unable to open dialog with no dom.");const o=document.createElement("input");o.type="file",o.accept=e;let r=null,i=!1;globalThis.addEventListener?.("focus",()=>{setTimeout(()=>{r||i||(i=!0,t(null))},1e3)},{once:!0,passive:!0}),o.onchange=()=>{if(r=o.files[0],r){if(i)return void console.warn("File open detected after faux cancel.",r);t(r)}},o.autofocus=!0,o.click()}),rafThrottle:e=>{let t,n=!1,o=function(){n=!1,e(t)};return function(r){t=r,t&&t.persist&&t.persist(),n||(n=!0,requestAnimationFrame(o))}},removeEmptyProperties:cn,removeEqualValues:un,removeListenerAll:e=>{if(!e)return[];for(let t=0;t<e.length;t++)e[t]&&e[t]();return[]},requestTimeout:(e,t)=>{const n=Ae(),o={id:requestAnimationFrame(function r(){Ae()-n>=t?e.call(null):o.id=requestAnimationFrame(r)})};return o},roundAccurately:(e,t=0)=>{if(e==null||!isFinite(e))return null;const n=10**t;return Number(Math.round(e*n)/n)},setToPath:(e,t,n)=>{const o=t.split(".");let r=e;if(!r)throw new Error("Can not set path to a null path.");for(let i=0;r&&i<o.length-1;i++){const s=o[i];let l=r[s];if(l==null&&(l={},r[s]=l),!Ct(l))throw new Error("Can not set path to a non object path.");r=l}if(typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"&&!Ct(n))throw new Error(`Can not set path to ${n} that is not a a supported primitive.`);return r[o[o.length-1]]=n,e},splitNumber:e=>{let t=Math.abs(e);if(isNaN(t)||!isFinite(e))return null;let n=0|t,o=t-n,r=0,i=0,s=1;if(o>5e-8)for(;i<8&&Math.abs(r/s-o)>5e-8;)i++,s*=10,r=Math.round(o*s);return{ip:Math.trunc(e),fp:r,ipLength:Math.ceil(Math.log10(n+1)),fpLength:i}},subtractRect:(e,t,n=!1)=>{if(!t)return[e];if(!ze(e,t))return[];const o=[];let r=e;const i=()=>{t.top>r.top&&t.top<r.bottom&&(o.push({...r,bottom:t.top}),r={...r,top:t.top})},s=()=>{t.bottom>r.top&&t.bottom<r.bottom&&(o.push({...r,top:t.bottom}),r={...r,bottom:t.bottom})},l=()=>{t.right>r.left&&t.right<r.right&&(o.push({...r,left:t.right}),r={...r,right:t.right})},a=()=>{t.left>r.left&&t.left<r.right&&(o.push({...r,right:t.left}),r={...r,left:t.left})};return n?(a(),l(),i(),s()):(i(),s(),l(),a()),o},textToKey:e=>e.replace(/[^a-zA-Z0-9]/g,"").toLowerCase(),throttle:function(e,t){let n=null;return(...o)=>{const r=Date.now();(!n||r-n>=t)&&(n=r,e(...o))}},toSafeJSON:function e(t){if(t===null||typeof t!="object")return t;if(typeof t.toJSON=="function")return t.toJSON();if(Array.isArray(t))return t.map(o=>e(o));if(typeof t.toString=="function"&&t.toString!==Object.prototype.toString)return t.toString();const n={};for(const o in t)t.hasOwnProperty(o)&&(n[o]=e(t[o]));return n},transpose:e=>{if(!e)return e;const t=e.length,n=e[0].length,o=[];for(let r=0;r<n;r++)o[r]=Array(t);for(let r=0;r<t;r++)for(let i=0;i<n;i++)o[i][r]=e[r][i];return o},uuidV4:$t,validEnumValue:(e,t)=>{if(!Object.values(e).includes(t))throw new Error(`Invalid type: ${t??"null"}. Must be one of: ${Object.values(t).join(", ")}.`)},whenFocus:async(e,t=!1)=>new Promise(n=>{Be(e,t)?n(!0):e.addEventListener("focusin",()=>{n(!0)},{once:!0}),e.focus()})},Symbol.toStringTag,{value:"Module"})),fr=Object.freeze(Object.defineProperty({__proto__:null,MESSAGE_ERROR_INVALID_ARG:e=>`Invalid argument: '${e}'.`},Symbol.toStringTag,{value:"Module"})),dn=e=>{const t=new Uint8Array(e),n=t.byteLength;let o="";for(let r=0;r<n;r++)o+=String.fromCharCode(t[r]);if(typeof window<"u"&&typeof globalThis.btoa=="function")return globalThis.btoa(o);if(typeof Buffer<"u")return Buffer.from(o,"binary").toString("base64");throw new Error("Unsupported environment")},re=e=>new Promise((t,n)=>{if(e)if(typeof FileReader<"u"){const o=new FileReader;o.onload=()=>{t(o.result)},o.onerror=()=>{n(o.error)},o.readAsText(e)}else if(typeof Buffer<"u"){const o=r=>Buffer.from(r).toString("utf-8");e.arrayBuffer().then(r=>{t(o(r))}).catch(r=>{n(r)})}else n(new Error("Unsupported environment"));else t("")}),pr=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_MIME_TYPE:"*/*",arrayBufferToBase64:dn,base64ToArrayBuffer:e=>{const t=typeof window<"u"&&typeof globalThis.atob=="function"?globalThis.atob(e):Buffer.from(e,"base64").toString("binary"),n=t.length,o=new Uint8Array(n);for(let r=0;r<n;r++)o[r]=t.charCodeAt(r);return o.buffer},blobToString:re},Symbol.toStringTag,{value:"Module"})),fn="data:image/png;base64,",pn="Unable to resolve image.",Fe=e=>new Promise(async(t,n)=>{let o=null;try{o=new Image,o.src=e,o.addEventListener("load",function(){t({width:o.naturalWidth,height:o.naturalHeight})},{once:!0}),o.addEventListener("error",function(){URL.revokeObjectURL(e),n("Invalid Image")},{once:!0}),await o.decode("sync")}catch{o?.src&&URL.revokeObjectURL(o.src)}o||n(pn)}),Ut="image/svg+xml",mr=Object.freeze(Object.defineProperty({__proto__:null,DATA_URL_PNG_PREFIX:fn,getImageDataUrl:(e,t=1)=>new Promise(async(n,o)=>{let r=null;try{r=new Image,r.src=e,r.addEventListener("load",function(){try{const i=document.createElement("canvas");i.width=r.naturalWidth,i.height=r.naturalHeight,i.getContext("2d").drawImage(r,0,0);const s=i.toDataURL("image/png",t);n({elemImg:r,dataUrl:s})}catch(i){URL.revokeObjectURL(e),o(i)}},{once:!0}),r.addEventListener("error",function(){URL.revokeObjectURL(e),o("Invalid Image")},{once:!0}),await r.decode("sync")}catch{r?.src&&URL.revokeObjectURL(r.src)}r||o(pn)}),loadImageDetails:async(e,t=null)=>{let n=null;const o=async()=>{try{const i=t??"image/*",s=URL.createObjectURL(new Blob([e],{type:i})),l=await Fe(s);n={mimeType:i,naturalDimensions:l,asUrl:s}}catch{}},r=async()=>{try{const i=new TextDecoder().decode(e),s=URL.createObjectURL(new Blob([i],{type:Ut})),l=await Fe(s);n={mimeType:t??Ut,naturalDimensions:l,asUrl:s,asSVGText:i}}catch{}};if(t===Ut?await r():t.startsWith("image/")?await o():(await o(),n||await r()),!n)throw new Error("Failed to load image");return n}},Symbol.toStringTag,{value:"Module"}));function _r(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});let n=typeof t.cycles=="boolean"&&t.cycles;const o=t.cmp&&function(i){return function(s){return function(l,a){const c={key:l,value:s[l]},u={key:a,value:s[a]};return i(c,u)}}}(t.cmp);let r=[];return function i(s){if(s&&s.toJSON&&typeof s.toJSON=="function"&&(s=s.toJSON()),s===void 0)return;if(typeof s=="number")return isFinite(s)?""+s:"null";if(typeof s!="object")return JSON.stringify(s);let l;if(Array.isArray(s)){l="[";for(let u=0;u<s.length;u++)u&&(l+=","),l+=i(s[u])||"null";return l+"]"}if(s===null)return"null";if(r.indexOf(s)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}const a=r.push(s)-1,c=Object.keys(s).sort(o&&o(s));l="";for(let u=0;u<c.length;u++){const f=c[u],d=i(s[f]);d&&(l&&(l+=","),l+=JSON.stringify(f)+":"+d)}return r.splice(a,1),"{"+l+"}"}(e)}var Ne,We;(We=Ne||(Ne={})).resolveTypedUpdates=(e,t,n,o)=>{if(e===null)return e;if(e===void 0)return o;let r=e;if(t?.shorthand){const a=t?.shorthand(e,n);a!==void 0&&(r=a)}if(r!==null&&t?.getSubType){const a=t.getSubType(r);a&&(t=a)}const i=t?.properties,s=t?.arrayType??!1;let l=r;if(t&&t.merge&&l&&o)l=t.merge(l,o,n);else if(!s&&i){const a=Object.keys({...r,...o});l=null;for(let c=0;c<a.length;c++){const u=a[c];let f,d=r[u];if(d!==void 0){const p=i[u];f=p?(0,We.resolveTypedUpdates)(d,p,n,o?.[u]):d}else f=o?.[u];f!=null&&(l=l??{},l[u]=f)}}return l};class Vt extends Error{constructor(t,n=null){super(t,n),this.name="ChainedError",this._cause=n}get cause(){return this._cause}}class _o extends Vt{constructor(t="Partial Error",n=null){super(t,n)}}class gr extends _o{constructor(t="Out of bounds",n=null){super(t,n),this.name="OutOfBoundsError"}}class yr extends Vt{constructor(t="Partial Error",n=null){super(t,n)}}class wr extends Vt{constructor(t="Null not supported",n=null){super(t,n)}}class br extends Error{constructor(t="Null not supported",n){super(t),this._type=n}get type(){return this._type}}class vr extends Vt{constructor(t="Not implemented",n=null){super(t,n)}}const Ve=`The Safari browser does not support advanced copy and paste.
Copy and paste will be limited to within the browser tab.

Please use Chrome or Edge if external copy and paste is required.`,qt=`You do not have permissions to access the clipboard.
All copy and paste operations will be limited to the browser tab.`,mn={Safari:`The Safari browser does not support advanced copy and paste.
Copy and paste will be limited to within the browser tab.

Please use Chrome or Edge if external copy and paste is required.`,Perms:qt,PermsWrite:kt()===q.Safari?Ve:qt,PermsRead:kt()===q.Safari?Ve:qt},Yt=async()=>new Promise(e=>{document.hasFocus()?e():globalThis.addEventListener?.("focus",()=>{e()},{once:!0}),document.activeElement.focus?.()}),Xt=async(e,t,n)=>{if(kt()===q.Safari)return await n(new Error(mn.Safari));try{const o=async s=>{try{return await s()}catch(l){if(l.message?.includes("Document is not focused"))return!1;throw l}},r=await globalThis?.navigator?.permissions?.query({name:e,allowWithoutGesture:!0,allowWithoutSanitization:!0});let i=!1;if(r.state==="prompt"&&(i=await o(t)),i||r.state!=="granted"||(i=await t()),!i)return await n(new Error(r.state))}catch(o){return o.message==="No valid data on clipboard"||o.name==="DataError"?void 0:await n(o)}},_n=async e=>{try{return await e.read({unsanitized:[P.html]})}catch{}return await e.read()},gn=async(e,t)=>{if(!e)return null;const n=await _n(e);let o=!1;for(let r=0;!o&&n&&r<n.length;r++)if(o=n[r].types.includes(t),o)return await n[r].getType(t);return o?void 0:null};if(!globalThis.ClipboardItem){const e=(n,o)=>new Blob([o],{type:n});class t{constructor(o,r){this._items={},this._types=Object.keys(o);const i={},s=Object.keys(o);for(let l=0;l<s.length;l++){const a=s[l];let c=o[a];i[a]=typeof c=="string"?e(a,c):c}this._items=i,this._presentationStyle=r?.presentationStyle??"unspecified"}get types(){return this._types}getType(o){return Promise.resolve(this._items[o])}supports(o){return!0}}globalThis.ClipboardItem=t}const Ft=async(e,t=P.html)=>new Promise(async(n,o)=>{try{const r=await gn(e,t);if(r){const i=new FileReader;i.onload=()=>{n(i.result)},i.onerror=()=>{n("")},i.readAsText(r)}else n("")}catch(r){o(r)}}),ie=async(e,t=P.html)=>{const n=await Ft(e,t);if(!n)return null;let o=null;try{o=new DOMParser().parseFromString(n,P.html)}catch{console.warn("Can't parse html from clipboard.")}return o},yn=async e=>{e&&await e.writeText("")},Gt={readBlobFromClipboard:gn,readStringFromClipboard:Ft,readHTMLFromClipboard:ie,clearClipboard:yn},Ot="clipboard-uuid",wt="web text/uuid",Ke=e=>`<div style="display:none" ${Ot}="${e}"/>`,go=(e,t)=>{let n=null;try{const o=new DOMParser().parseFromString(t,P.html);o.body.firstElementChild.setAttribute(Ot,e),n=o.getElementsByTagName("body")[0].innerHTML}catch(o){console.warn("Can't embed uuid.",o)}return n},He=(e,t)=>{if(!t||!e)return!1;try{const n=t.querySelectorAll(`[${Ot}="${e}"]`);if(n&&n.length===1)return!0;if(t.querySelector("parsererror"))throw new Error("We are unable to parse node");return!1}catch{return!1}};class xt{constructor(t){if(t?.nativeClipboard===void 0||t?.nativeClipboard===!0)try{this._nativeClipboard=globalThis?.navigator.clipboard}catch{t?.nativeClipboard===!0&&console.warn("NativeClipboard option set to true but no native clipboard available.")}else this._nativeClipboard=t?.nativeClipboard===!1?null:t?.nativeClipboard;this._disableCheckOnFocus=t?.disableCheckOnFocus??!1,this._init()}async _checkForChanges(){this._nativeClipboard&&this._state&&!this._disableCheckOnFocus&&await Xt("clipboard-read",async()=>{await Yt();const t=await Ft(this._nativeClipboard,wt);if(!this._state||t&&t===this._state.uuid)return!0;const n=await ie(this._nativeClipboard,P.html);return!this._state||(He(this._state.uuid,n)||this.clear(),!0)},async t=>{t?.message==="denied"||t.message?.includes("Document is not focused")||kt()===q.Safari||console.warn("Unable to detect clipboard changes: ",t)})}_init(){const t=this;this._listeners=new Map,this._listenersCapture=new Map,this._state=null,this._nativeClipboard&&(this._onFocus=()=>{t._checkForChanges()},this._onBlur=()=>{globalThis.addEventListener?.("focus",t._onFocus,{once:!0})},globalThis.addEventListener?.("blur",this._onBlur),this._nativeClipboard.addEventListener("clipboardchange",n=>{t._checkForChanges()}))}async read(){if(!this._nativeClipboard)return this._state?.items??null;const t=this;return await Xt("clipboard-read",async()=>{if(await Yt(),this._state?.uuid){const n=await Ft(this._nativeClipboard,wt);if(n&&n===t._state.uuid)return!0;const o=await ie(this._nativeClipboard,P.html);if(He(t._state?.uuid,o))return!0}return t._state={items:await _n(this._nativeClipboard),uuid:null,ref:null},this.dispatchEvent(new Event("clipboardread")),!0},async n=>{this.dispatchEvent(new Event("clipboarderrorread"))}),this._state?.items??[]}async write(t){return this._write({uuid:$t(),items:t,ref:null})}async _write(t){if(!this._nativeClipboard)return this._state=t,this.dispatchEvent(new Event("clipboardwrite")),this.dispatchEvent(new Event("clipboardchange")),null;const n=this,o=[],r=t.uuid;let i=t.items??[];const s=()=>{n._state={uuid:r,ref:t.ref,items:o},n.dispatchEvent(new Event("clipboardwrite")),n.dispatchEvent(new Event("clipboardchange"))};await Xt("clipboard-write",async()=>{await Yt(),r&&i.length===0&&(i.push(new ClipboardItem({[wt]:new Blob([r],{type:wt})})),i.push(new ClipboardItem({[P.html]:new Blob([Ke(r)],{type:P.html})})));for(let l=0;l<Math.min(1,i.length);l++){const a=i[l];let c=a.types.indexOf(P.html),u=null;if(c!==-1){const p=await a.getType(P.html);u=await re(p),u&&(u=go(r,u))}if(!u&&a.types.includes(P.plain)){const p=await a.getType(P.plain);if(p){let _=null;typeof p=="string"?(console.warn("text as string",p),_=p):_=await re(p),_&&(u=`<div ${Ot}="${r}">${_}</div>`)}}if(!u&&a.types.includes(P.png)){const p=await a.getType(P.png),_=dn(await p.arrayBuffer());u=`<div ${Ot}="${r}"><img src="${fn+_}"/></div>`}!u&&r&&(u=Ke(r));const f=new Blob([u??""],{type:P.html}),d={};for(let p=0;p<a.types.length;p++){const _=a.types[p];d[_]=p===c?f:a.getType(_)}u&&c===-1&&(d[P.html]=f),r&&(d[wt]=new Blob([r],{type:wt})),o.push(new ClipboardItem(d))}try{o&&o.length!==0?await this._nativeClipboard.write(o):await yn(this._nativeClipboard)}catch(l){l.message?.includes("Document is not focused")||console.warn("Unable to write to native clipboard: ",l)}return s(),!0},async l=>{this.dispatchEvent(new Event("clipboarderrorwrite")),s()})}async writeReference(t){if(!t)return void this.clear();let n=null;const o={};try{const i=await t.toText?.()??null;i&&(o[P.plain]=new Blob([i??""],{type:P.plain}))}catch(i){n=i}try{const i=await t.toHtml?.()??null;i&&(o[P.html]=new Blob([i],{type:P.html}))}catch(i){n=i,console.warn("export to html",i)}try{const i=await t.toImage?.()??null;i&&(o[P.png]=i)}catch(i){n=i,console.warn("export to png",i)}const r=this._write({uuid:$t(),ref:t,items:Object.keys(o).length>0?[new ClipboardItem(o)]:null});if(n)throw n;return r}clear(t=!1){this._state&&(this._state=null,t&&this._write({uuid:null,ref:null,items:null}),this.dispatchEvent(new Event("clipboardwrite")),this.dispatchEvent(new Event("clipboardchange")))}async readReference(){return await this.read(),this._state?.ref??null}readText(){return new Promise(async(t,n)=>{const o=await this.read();let r=null;for(let s=0;!r&&o&&s<o.length;s++)o[s].types.includes(P.plain)&&(r=await o[s].getType(P.plain));if(!r)return void t("");const i=new FileReader;i.onload=()=>{t(i.result)},i.readAsText(r),i.onerror=s=>{n(s)}})}async writeText(t){const n=[new ClipboardItem({[P.plain]:new Blob([t],{type:P.plain})})];return this._write({uuid:$t(),items:n,ref:null})}addEventListener(t,n,o={}){const r=o?.capture?this._listenersCapture:this._listeners;let i=r.get(t);i||(i=new Map,r.set(t,i)),i.set(n,typeof o=="boolean"?{}:o)}dispatchEvent(t){if(!t)return;const n=o=>{const r=o.get(t.type);r&&r.forEach((i,s)=>{try{typeof s=="function"?s(t):s.handleEvent&&s.handleEvent(t),i.once&&r.delete(s)}catch(l){console.warn(l)}})};return n(this._listenersCapture),n(this._listeners),!0}removeEventListener(t,n,o){const r=o?.capture?this._listenersCapture:this._listeners,i=r.get(t);i&&(i.delete(n),i.size===0&&r.delete(t))}close(){globalThis.removeEventListener?.("focus",this._onFocus),globalThis.removeEventListener?.("blur",this._onBlur)}}var Zt;(Zt=xt||(xt={})).ErrorMessages=mn,Zt.Global=new Zt;let xr=class{constructor(t=100){this._maxStack=t,this._undoStack=[],this._redoStack=[],this._repeatOperation=null,this._listeners=new Set}get maxStack(){return this._maxStack}undo(t=1){if(this._undoStack.length===0)return;let n=!1;try{for(let o=0;o<t&&this._undoStack.length>0;o++){const r=this._undoStack[this._undoStack.length-1];r.redo=r.undo(),this._undoStack.pop(),typeof r.redo=="function"?this._redoStack.push(r):this._redoStack=[],n=!0}}catch(o){throw o}finally{n&&this._notifyOnStackChange()}}redo(t=1){if(this._redoStack.length===0)return void(this._repeatOperation!==null&&this._repeatOperation.repeat());let n=!1;try{for(let o=0;o<t&&this._redoStack.length>0;o++){const r=this._redoStack[this._redoStack.length-1];r.redo(),this._redoStack.pop(),this._undoStack.push(r),n=!0}}catch(o){throw o}finally{n&&this._notifyOnStackChange()}}hasUndo(){return this._undoStack.length>0}getTopUndoDescription(){return this._undoStack.length===0?null:this._undoStack[this._undoStack.length-1].description}hasRedo(){return this._redoStack.length>0||this._repeatOperation!==null}getTopRedoDescription(){return this._repeatOperation!==null?this._repeatOperation.description:this._redoStack.length===0?null:this._redoStack[this._redoStack.length-1].description}getUndoDescriptions(){if(this._undoDescriptions)return this._undoDescriptions;const t=[];for(let n=this._undoStack.length-1;n>=0;n--)t.push(this._undoStack[n].description);return this._undoDescriptions=t,this._undoDescriptions}getRedoDescriptions(){if(this._redoDescriptions)return this._redoDescriptions;const t=[];for(let n=this._redoStack.length-1;n>=0;n--)t.push(this._redoStack[n].description);return t.length===0&&this._repeatOperation!==null&&t.push(this._repeatOperation.description),this._redoDescriptions=Object.freeze(t),this._redoDescriptions}addUndoOperation(t){const n={description:t.description,undo:t.undo,redo:null};this._undoStack.push(n),this._redoStack=[],this._undoStack.length>this._maxStack&&this._undoStack.shift(),this._notifyOnStackChange()}setRepeatableOperation(t){this._repeatOperation=t??null,this._redoStack=[],this._notifyOnStackChange()}clear(t=!0){this._undoStack=[],this._redoStack=[],this._repeatOperation=null,this._undoDescriptions=null,this._redoDescriptions=null,t&&this._notifyOnStackChange()}addListener(t){const n=this._listeners;return n.add(t),()=>{n.delete(t)}}_notifyOnStackChange(){this._undoDescriptions=null,this._redoDescriptions=null,this._listeners.forEach(t=>{t.onStackChange?.()})}};(function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode("._sheetxl-scrollbar_eblx4_6 ::-webkit-scrollbar-button{background:transparent}._fullscreen-portal-root_1mjsr_4{pointer-events:none;position:absolute;inset:0;width:100%;height:100%;z-index:1200}._fullscreen-portal-root_1mjsr_4>*{pointer-events:auto}")),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();/**
 * @license @sheetxl/utils-react - Utils React - Utilities for React capabilities needed for all SheetXL components. - v0.6.6
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const Er={Left:"left",Right:"right",Center:"center"},Y={Shift:"shift",Alt:"alt",Ctrl:"ctrl",Meta:"meta"},Cr={Tab:9,Enter:13,Escape:27,Space:32,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,F1:112,F2:113,F4:115},Tr={Right:3},rt={Horizontal:"horizontal",Vertical:"vertical"};function wn(e){var t,n,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=wn(e[t]))&&(o&&(o+=" "),o+=n)}else for(n in e)e[n]&&(o&&(o+=" "),o+=n);return o}function bt(){for(var e,t,n=0,o="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=wn(e))&&(o&&(o+=" "),o+=t);return o}var yo=function(){},bn=typeof window<"u",wo=bn?h.useLayoutEffect:h.useEffect,Ue={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};const _t=bn&&window.ResizeObserver!==void 0?function(){var e=h.useState(null),t=e[0],n=e[1],o=h.useState(Ue),r=o[0],i=o[1],s=h.useMemo(function(){return new window.ResizeObserver(function(l){if(l[0]){var a=l[0].contentRect,c=a.x,u=a.y,f=a.width,d=a.height,p=a.top,_=a.left,b=a.bottom,x=a.right;i({x:c,y:u,width:f,height:d,top:p,left:_,bottom:b,right:x})}})},[]);return wo(function(){if(t)return s.observe(t),function(){s.disconnect()}},[t]),[n,r]}:function(){return[yo,Ue]},k=(e,t)=>{const n=h.useCallback((...i)=>e?.(...i),t),o=h.useRef(null);o.current=n;const r=h.useCallback((...i)=>o.current?.(...i),[]);if(o.current)return r},bo=e=>{const{style:t,orientation:n=rt.Vertical,...o}=e,r=n===rt.Vertical;return E.jsx("div",{style:{paddingBottom:"0px",paddingRight:"0px",paddingLeft:r?"0px":"3px",paddingTop:r?"3px":"0px",display:"flex",alignItems:"center",justifyContent:"center",...t},...o,children:E.jsx("button",{style:{padding:"0",display:"flex",alignItems:"center",justifyContent:"center",border:"none"},className:`scrollbar-button ${r?"vertical":"horizontal"} single-button start`,children:E.jsx("svg",{width:"9",height:"9",viewBox:"0 0 6 6",style:{opacity:"inherit"},children:E.jsx("path",{d:r?"m 3.7274761,0.68060577 1.11969,1.93863003 1.12075,1.93912 c 0.0895,0.155 0.12152,0.33658 0.0904,0.51283 -0.0311,0.17625 -0.12336,0.33591 -0.26054,0.45091 -0.13715,0.11495 -0.31044,0.17793 -0.4894,0.17781 H 0.83095614 c -0.20186,0 -0.39542,-0.0802 -0.53814,-0.2229 -0.14272,-0.14272 -0.22291,-0.33629 -0.22291,-0.53814 -3e-4,-0.13308 0.0347,-0.26385 0.10147,-0.379 l 1.11872996,-1.94066 1.11921,-1.93864003 c 0.13594,-0.23541 0.38717,-0.38047 0.65905,-0.38047 0.27188,0 0.52311,0.14506 0.65905,0.38047 z":"m 0.75051,2.3424298 1.93863,-1.11969 1.93912,-1.12075 c 0.155,-0.0895 0.33658,-0.12152 0.51283,-0.0904 0.17625,0.0311 0.33591,0.12336 0.45091,0.26054 0.11495,0.13715 0.17793,0.31044 0.17781,0.4894 v 4.47742 c 0,0.20186 -0.0802,0.39542 -0.2229,0.53814 -0.14272,0.14272 -0.33629,0.22291 -0.53814,0.22291 -0.13308,3e-4 -0.26385,-0.0347 -0.379,-0.10147 L 2.68911,4.7797998 0.75047,3.6605898 C 0.51506,3.5246498 0.37,3.2734198 0.37,3.0015398 c 0,-0.27188 0.14506,-0.52311 0.38047,-0.65905 z"})})})})},vo=e=>{const{style:t,orientation:n=rt.Vertical,...o}=e,r=n===rt.Vertical;return E.jsx("div",{style:{paddingLeft:"0px",paddingTop:"0px",paddingRight:r?"0px":"3px",paddingBottom:r?"3px":"0px",display:"flex",alignItems:"center",justifyContent:"center",...t},...o,children:E.jsx("button",{style:{padding:"0",display:"flex",alignItems:"center",justifyContent:"center",border:"none"},className:`scrollbar-button ${r?"vertical":"horizontal"} single-button end`,children:E.jsx("svg",{width:"9",height:"9",viewBox:"0 0 6 6",style:{opacity:"inherit"},children:E.jsx("path",{d:r?"M 2.412334,5.319396 1.292644,3.3807659 0.17189405,1.4416459 c -0.0895,-0.155 -0.12152,-0.33658 -0.0904,-0.51282998 0.0311,-0.17625 0.12336,-0.33591 0.26054,-0.45091 0.13715,-0.11495 0.31044,-0.17793 0.4894,-0.17781 H 5.308854 c 0.20186,0 0.39542,0.0802 0.53814,0.2229 0.14272,0.14272 0.22291,0.33629 0.22291,0.53813998 3e-4,0.13308 -0.0347,0.26385 -0.10147,0.379 l -1.11873,1.94066 -1.11921,1.9386401 c -0.13594,0.23541 -0.38717,0.38047 -0.65905,0.38047 -0.27188,0 -0.52311,-0.14506 -0.65905,-0.38047 z":"m 5.3893002,3.6575719 -1.9386301,1.11969 -1.93912,1.12075 c -0.155,0.0895 -0.33658,0.12152 -0.51282997,0.0904 -0.17625,-0.0311 -0.33591,-0.12336 -0.45091,-0.26054 -0.11495,-0.13715 -0.17793,-0.31044 -0.17781,-0.4894 V 0.76105195 c 0,-0.20186 0.0802,-0.39542 0.2229,-0.53814 C 0.73562013,0.08019195 0.92919013,1.9467784e-6 1.1310401,1.9467784e-6 1.2641201,-2.9805322e-4 1.3948901,0.03470195 1.5100401,0.10147195 l 1.94066,1.11872995 1.9386401,1.11921 c 0.23541,0.13594 0.38047,0.38717 0.38047,0.65905 0,0.27188 -0.14506,0.52311 -0.38047,0.65905 z"})})})})},Lr=e=>{const{style:t,orientation:n=rt.Vertical,...o}=e,r=n===rt.Vertical;return E.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"end",transition:"fill-opacity 1s",zIndex:1,width:"24px",height:"24px",...t},className:`scrollbar-button ${r?"vertical":"horizontal"} edge`,...o,children:E.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",transform:r?"rotate(90) ":"",children:E.jsx("path",{style:{transition:"opacity 240ms ease 0s",opacity:e.disabled?0:1},d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"})})})},se=(e,t,n,o,r=0)=>{for(let i=0;i<n.length;i++){const s=n[i].getBoundingClientRect();let l=s.left-t,a=l+s.width;if(o){if(l<e&&a>=e)return l}else if(Math.ceil(a)>Math.ceil(e)+2)return a}return r},Mr=Object.freeze(Object.defineProperty({__proto__:null,getScrollTo:se},Symbol.toStringTag,{value:"Module"})),xo="_sheetxl-scrollbar_eblx4_6",fe=h.memo(h.forwardRef((e,t)=>{const{offset:n=0,totalSize:o=0,viewportSize:r=0,style:i,className:s,orientation:l=rt.Vertical,onScrollOffset:a,onScroll:c,showCustomScrollButtons:u=!1,scrollButtonIncrement:f=200,scrollButtonInitialRepeatDelay:d=260,scrollButtonAdditionalRepeatDelay:p=120,createScrollStartButton:_=bo,createScrollEndButton:b=vo,...x}=e,M=k(c,[c]),m=h.useRef(null),[v,{width:g,height:j}]=_t(),[R,{width:z,height:F}]=_t(),S=l===rt.Vertical,C=S?"top":"left",A=S?"scrollTop":"scrollLeft",y=S?j:g,T=S?F:z,[w,L]=h.useState(null);h.useEffect(()=>{w!==null&&m.current&&m.current.scrollTo({behavior:"smooth",[C]:w})},[w,S]);const D=h.useCallback(($,it=!1)=>{if(!m.current)return 0;const ot=m.current.querySelector(".scrollbar-viewport"),dt=ot.getBoundingClientRect(),st=ot.children,at=it?0:se($,dt[C],st,!0,Math.max(0,$-f));return L(at),Math.max(0,at)},[]),X=h.useCallback(($,it=!1)=>{if(!m.current)return 0;const ot=m.current.querySelector(".scrollbar-viewport"),dt=ot.getBoundingClientRect(),st=ot.children,at=Math.ceil(T-y),Et=it?at:se($,dt[C],st,!1,Math.max(0,$+f));return L(Et),Math.min(at,Et)},[T,y]),W=h.useRef(null),V=h.useCallback($=>{W.current=n;const it=$.target[A];a(it,r,o),M?.($)},[a,r,o,n]);h.useEffect(()=>{const $=W.current;W.current=null,n!==$&&(m.current[A]=n)},[n,A]);const K=h.useRef(null),I=h.useRef(null),N=h.useCallback(()=>{K.current&&(clearTimeout(K.current),K.current=null,I.current=null)},[]),H=h.useCallback(($,it,ot,dt=d)=>{I.current=$,K.current=setTimeout(()=>{const st=ot?D(I.current||$):X(I.current||$);st!==I.current?H(st,!1,ot,p):N()},it?0:dt)},[D,X,N]);h.useEffect(()=>()=>N(),[N]);const et=n,gt=h.useMemo(()=>{if(!u)return null;const $={orientation:l,disabled:Math.floor(et)<=0||Math.floor(T-y)===0,onMouseUp:N,onMouseLeave:N,onMouseDown:()=>H(et,!0,!0)};return _?.($)},[u,l,et,w,T,y]),yt=h.useMemo(()=>{if(!u)return null;const $={orientation:l,disabled:Math.floor(T-y)<=Math.ceil(et),onMouseUp:N,onMouseLeave:N,onMouseDown:()=>H(et,!0,!1)};return b?.($)},[u,l,et,w,T,y]);return E.jsxs("div",{ref:t,style:{display:"flex",flex:"1",flexDirection:S?"column":"row",padding:"0",...i},className:bt(xo,s),...x,children:[gt,E.jsx("div",{className:"pseudo-scrollbar",style:{flex:"1 1 100%",display:"flex",boxSizing:"content-box",flexDirection:S?"column":"row",justifyContent:"center",alignItems:"center"},ref:v,children:E.jsx("div",{tabIndex:-1,style:{flex:"1 1 100%",overflowY:S?"scroll":"hidden",overflowX:S?"hidden":"scroll",position:"relative",willChange:"transform"},onScroll:V,ref:m,children:E.jsx("div",{ref:R,style:{position:"absolute",height:S?o-r+(j??0):1,width:S?1:o-r+(g??0)},className:"scrollbar-viewport"})})}),yt]})}));fe.displayName="Scrollbar";let qe=Date.now,Ye=1e3,ht={},So=1;const Tt=e=>{let t=ht[e]!==null;return t&&(ht[e]=null),t},Xe=(e,t,n,o=0,r)=>{let i=qe(),s=i,l=0,a=0,c=0,u=So++;if(u%20==0){const d={};for(let p in ht)d[p]=!0;ht=d}const f=function(d){let p=d!==!0,_=qe(),b=!0;try{b=(!t||t(u))??!0}catch{b=!1}if(!ht[u]||!b)return ht[u]=null,void n?.(60-a/((_-i)/Ye),u,!1);if(p){c=Math.round((_-s)/16.666666666666668)-1;for(let m=0;m<Math.min(c,4);m++)f(!0),a++}o&&(l=(_-i)/o,l>1&&(l=1));let x=r?r(l):l,M=!1;try{M=e(x,_,p)}catch{M=!1}M!==!1&&l!==1||!p?p&&(s=_,requestAnimationFrame(f)):(ht[u]=null,n?.(60-a/((_-i)/Ye),u,l===1||o==null))};return ht[u]=!0,requestAnimationFrame(f),u},Eo=function(e){return Math.pow(e-1,3)+1},Co=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)};class To{constructor(t,n){this.__isSingleTouch=!1,this.__isTracking=!1,this.__didDecelerationComplete=!1,this.__isGesturing=!1,this.__isDragging=!1,this.__isDecelerating=0,this.__isAnimating=0,this.__interruptedAnimation=!1,this.__lastScale=1,this.__enableScrollX=!0,this.__enableScrollY=!0,this.__clientLeft=0,this.__clientTop=0,this.__clientWidth=0,this.__clientHeight=0,this.__contentWidth=0,this.__contentHeight=0,this.__snapWidth=100,this.__snapHeight=100,this.__zoomLevel=1,this.__scrollLeft=0,this.__scrollTop=0,this.__maxScrollLeft=0,this.__maxScrollTop=0,this.__scheduledLeft=0,this.__scheduledTop=0,this.__scheduledZoom=0,this.__lastTouchLeft=0,this.__lastTouchTop=0,this.__lastTouchMove=0,this.__positions=[],this.__initialTouchLeft=0,this.__initialTouchTop=0,this.__zoomLevelStart=1,this.__minDecelerationScrollLeft=null,this.__minDecelerationScrollTop=null,this.__maxDecelerationScrollLeft=null,this.__maxDecelerationScrollTop=null,this.__decelerationVelocityX=null,this.__decelerationVelocityY=0,this.__callback=t,this.options={scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3,speedMultiplier:1,scrollingComplete:void 0,penetrationDeceleration:.03,penetrationAcceleration:.08,...n}}setDimensions(t,n,o,r){t!==null&&(this.__clientWidth=t),n!==null&&(this.__clientHeight=n),o!==null&&(this.__contentWidth=o),r!==null&&(this.__contentHeight=r),this.__computeScrollMax(),this.scrollTo(this.__scrollLeft,this.__scrollTop,!0)}setPosition(t,n){this.__clientLeft=t||0,this.__clientTop=n||0}setSnapSize(t,n){this.__snapWidth=t,this.__snapHeight=n}getValues(){return{left:this.__scrollLeft,top:this.__scrollTop,right:this.__scrollLeft+this.__clientWidth/this.__zoomLevel,bottom:this.__scrollTop+this.__clientHeight/this.__zoomLevel,zoom:this.__zoomLevel}}getPoint(t,n){const o=this.getValues();return{left:t/o.zoom,top:n/o.zoom}}getScrollMax(){return{left:this.__maxScrollLeft,top:this.__maxScrollTop}}zoomTo(t,n=!1,o,r,i){if(!this.options.zooming)throw new Error("Zooming is not enabled!");i&&(this.__zoomComplete=i),this.__isDecelerating&&(Tt(this.__isDecelerating),this.__isDecelerating=0);const s=this.__zoomLevel;o===void 0&&(o=this.__clientWidth/2),r===void 0&&(r=this.__clientHeight/2),t=Math.max(Math.min(t,this.options.maxZoom),this.options.minZoom),this.__computeScrollMax(t);const l=t/s;let a=l*(this.__scrollLeft+o)-o,c=l*(this.__scrollTop+r)-r;a>this.__maxScrollLeft?a=this.__maxScrollLeft:a<0&&(a=0),c>this.__maxScrollTop?c=this.__maxScrollTop:c<0&&(c=0),this.__publish(a,c,t,n)}zoomBy(t,n=!1,o=0,r=0,i){this.zoomTo(this.__zoomLevel*t,n,o,r,i)}scrollTo(t,n,o=!1,r=1){if(this.__isDecelerating&&(Tt(this.__isDecelerating),this.__isDecelerating=0),r!==void 0&&r!==this.__zoomLevel){if(!this.options.zooming)throw new Error("Zooming is not enabled!");t*=r,n*=r,this.__computeScrollMax(r)}else r=this.__zoomLevel;this.options.scrollingX?this.options.paging?t=Math.round(t/this.__clientWidth)*this.__clientWidth:this.options.snapping&&(t=Math.round(t/this.__snapWidth)*this.__snapWidth):t=this.__scrollLeft,this.options.scrollingY?this.options.paging?n=Math.round(n/this.__clientHeight)*this.__clientHeight:this.options.snapping&&(n=Math.round(n/this.__snapHeight)*this.__snapHeight):n=this.__scrollTop,t=Math.max(Math.min(this.__maxScrollLeft,t),0),n=Math.max(Math.min(this.__maxScrollTop,n),0),t===this.__scrollLeft&&n===this.__scrollTop&&(o=!1),this.__publish(t,n,r,o)}scrollBy(t=0,n=0,o=!1){const r=this.__isAnimating?this.__scheduledLeft:this.__scrollLeft,i=this.__isAnimating?this.__scheduledTop:this.__scrollTop;this.scrollTo(r+(t||0),i+(n||0),o)}doMouseZoom(t,n,o,r){const i=t>0?.97:1.03;return this.zoomTo(this.__zoomLevel*i,!1,o-this.__clientLeft,r-this.__clientTop)}doTouchStart(t,n){if(t.length===void 0)throw new Error("Invalid touch list: "+t);if(n instanceof Date&&(n=n.valueOf()),typeof n!="number")throw new Error("Invalid timestamp value: "+n);let o,r;this.__interruptedAnimation=!0,this.__isDecelerating&&(Tt(this.__isDecelerating),this.__isDecelerating=0,this.__interruptedAnimation=!0),this.__isAnimating&&(Tt(this.__isAnimating),this.__isAnimating=0,this.__interruptedAnimation=!0);let i=t.length===1;i?(o=t[0].pageX,r=t[0].pageY):(o=Math.abs(t[0].pageX+t[1].pageX)/2,r=Math.abs(t[0].pageY+t[1].pageY)/2),this.__initialTouchLeft=o,this.__initialTouchTop=r,this.__zoomLevelStart=this.__zoomLevel,this.__lastTouchLeft=o,this.__lastTouchTop=r,this.__lastTouchMove=n,this.__lastScale=1,this.__enableScrollX=!i&&this.options.scrollingX,this.__enableScrollY=!i&&this.options.scrollingY,this.__isTracking=!0,this.__didDecelerationComplete=!1,this.__isDragging=!i,this.__isSingleTouch=i,this.__positions=[]}doTouchMove(t,n,o=1){if(t.length===void 0)throw new Error("Invalid touch list: "+t);if(n instanceof Date&&(n=n.valueOf()),typeof n!="number")throw new Error("Invalid timestamp value: "+n);if(!this.__isTracking)return;let r,i;t.length===2?(r=Math.abs(t[0].pageX+t[1].pageX)/2,i=Math.abs(t[0].pageY+t[1].pageY)/2):(r=t[0].pageX,i=t[0].pageY);let s=this.__positions;if(this.__isDragging){let l=r-this.__lastTouchLeft,a=i-this.__lastTouchTop,c=this.__scrollLeft,u=this.__scrollTop,f=this.__zoomLevel;if(o!==void 0&&this.options.zooming){let d=f;if(f=f/this.__lastScale*o,f=Math.max(Math.min(f,this.options.maxZoom),this.options.minZoom),d!==f){let p=r-this.__clientLeft,_=i-this.__clientTop;c=(p+c)*f/d-p,u=(_+u)*f/d-_,this.__computeScrollMax(f)}}if(this.__enableScrollX){c-=l*this.options.speedMultiplier;let d=this.__maxScrollLeft;(c>d||c<0)&&(this.options.bouncing?c+=l/2*this.options.speedMultiplier:c=c>d?d:0)}if(this.__enableScrollY){u-=a*this.options.speedMultiplier;const d=this.__maxScrollTop;(u>d||u<0)&&(this.options.bouncing?u+=a/2*this.options.speedMultiplier:u=u>d?d:0)}s.length>60&&s.splice(0,30),s.push(c,u,n),this.__publish(c,u,f)}else{let l=this.options.locking?3:0,a=5,c=Math.abs(r-this.__initialTouchLeft),u=Math.abs(i-this.__initialTouchTop);this.__enableScrollX=this.options.scrollingX&&c>=l,this.__enableScrollY=this.options.scrollingY&&u>=l,s.push(this.__scrollLeft,this.__scrollTop,n),this.__isDragging=(this.__enableScrollX||this.__enableScrollY)&&(c>=a||u>=a),this.__isDragging&&(this.__interruptedAnimation=!1)}this.__lastTouchLeft=r,this.__lastTouchTop=i,this.__lastTouchMove=n,this.__lastScale=o}doTouchEnd(t){if(t instanceof Date&&(t=t.valueOf()),typeof t!="number")throw new Error("Invalid timestamp value: "+t);if(this.__isTracking){if(this.__isTracking=!1,this.__isDragging)if(this.__isDragging=!1,this.__isSingleTouch&&this.options.animating&&t-this.__lastTouchMove<=100){let n=this.__positions,o=n.length-1,r=o;for(let i=o;i>0&&n[i]>this.__lastTouchMove-100;i-=3)r=i;if(r!==o){const i=n[o]-n[r],s=this.__scrollLeft-n[r-2],l=this.__scrollTop-n[r-1];this.__decelerationVelocityX=s/i*(1e3/60),this.__decelerationVelocityY=l/i*(1e3/60);const a=this.options.paging||this.options.snapping?4:1;(Math.abs(this.__decelerationVelocityX)>a||Math.abs(this.__decelerationVelocityY)>a)&&this.__startDeceleration(t)}else this.options.scrollingComplete?.()}else t-this.__lastTouchMove>100&&this.options.scrollingComplete?.();this.__isDecelerating||((this.__interruptedAnimation||this.__isDragging)&&this.options.scrollingComplete?.(),this.scrollTo(this.__scrollLeft,this.__scrollTop,!0,this.__zoomLevel)),this.__positions.length=0}}__publish(t,n,o,r=!1){const i=this.__isAnimating;if(i&&(Tt(i),this.__isAnimating=0),r&&this.options.animating){this.__scheduledLeft=t,this.__scheduledTop=n,this.__scheduledZoom=o;const s=this.__scrollLeft,l=this.__scrollTop,a=this.__zoomLevel,c=t-s,u=n-l,f=o-a,d=(function(b,x,M){M&&(this.__scrollLeft=s+c*b,this.__scrollTop=l+u*b,this.__zoomLevel=a+f*b,this.__callback&&this.__callback(this.__scrollLeft,this.__scrollTop,this.__zoomLevel))}).bind(this),p=(function(b){return this.__isAnimating===b}).bind(this),_=(function(b,x,M){x===this.__isAnimating&&(this.__isAnimating=!1),(this.__didDecelerationComplete||M)&&this.options.scrollingComplete?.(),this.options.zooming&&(this.__computeScrollMax(),this.__zoomComplete&&(this.__zoomComplete(),this.__zoomComplete=null))}).bind(this);this.__isAnimating=Xe(d,p,_,this.options.animationDuration,i?Eo:Co)}else this.__scheduledLeft=this.__scrollLeft=t,this.__scheduledTop=this.__scrollTop=n,this.__scheduledZoom=this.__zoomLevel=o,this.__callback&&this.__callback(t,n,o),this.options.zooming&&(this.__computeScrollMax(),this.__zoomComplete&&(this.__zoomComplete(),this.__zoomComplete=null))}__computeScrollMax(t=this.__zoomLevel){this.__maxScrollLeft=Math.max(this.__contentWidth*t-this.__clientWidth,0),this.__maxScrollTop=Math.max(this.__contentHeight*t-this.__clientHeight,0)}__startDeceleration(t){if(this.options.paging){const s=Math.max(Math.min(this.__scrollLeft,this.__maxScrollLeft),0),l=Math.max(Math.min(this.__scrollTop,this.__maxScrollTop),0),a=this.__clientWidth,c=this.__clientHeight;this.__minDecelerationScrollLeft=Math.floor(s/a)*a,this.__minDecelerationScrollTop=Math.floor(l/c)*c,this.__maxDecelerationScrollLeft=Math.ceil(s/a)*a,this.__maxDecelerationScrollTop=Math.ceil(l/c)*c}else this.__minDecelerationScrollLeft=0,this.__minDecelerationScrollTop=0,this.__maxDecelerationScrollLeft=this.__maxScrollLeft,this.__maxDecelerationScrollTop=this.__maxScrollTop;const n=(function(s,l,a){this.__stepThroughDeceleration(a)}).bind(this),o=this.options.snapping?4:.1,r=(function(){const s=Math.abs(this.__decelerationVelocityX)>=o||Math.abs(this.__decelerationVelocityY)>=o;return s||(this.__didDecelerationComplete=!0),s}).bind(this),i=(function(s,l,a){this.__isDecelerating=0,this.__didDecelerationComplete&&this.options.scrollingComplete?.(),this.scrollTo(this.__scrollLeft,this.__scrollTop,this.options.snapping)}).bind(this);this.__isDecelerating=Xe(n,r,i)}__stepThroughDeceleration(t){let n=this.__scrollLeft+this.__decelerationVelocityX,o=this.__scrollTop+this.__decelerationVelocityY;if(!this.options.bouncing){const r=Math.max(Math.min(this.__maxDecelerationScrollLeft,n),this.__minDecelerationScrollLeft);r!==n&&(n=r,this.__decelerationVelocityX=0);const i=Math.max(Math.min(this.__maxDecelerationScrollTop,o),this.__minDecelerationScrollTop);i!==o&&(o=i,this.__decelerationVelocityY=0)}if(t?this.__publish(n,o,this.__zoomLevel):(this.__scrollLeft=n,this.__scrollTop=o),!this.options.paging&&(this.__decelerationVelocityX*=.95,this.__decelerationVelocityY*=.95),this.options.bouncing){let r=0,i=0,s=this.options.penetrationDeceleration,l=this.options.penetrationAcceleration;n<this.__minDecelerationScrollLeft?r=this.__minDecelerationScrollLeft-n:n>this.__maxDecelerationScrollLeft&&(r=this.__maxDecelerationScrollLeft-n),o<this.__minDecelerationScrollTop?i=this.__minDecelerationScrollTop-o:o>this.__maxDecelerationScrollTop&&(i=this.__maxDecelerationScrollTop-o),r!==0&&(r*this.__decelerationVelocityX<=0?this.__decelerationVelocityX+=r*s:this.__decelerationVelocityX=r*l),i!==0&&(i*this.__decelerationVelocityY<=0?this.__decelerationVelocityY+=i*s:this.__decelerationVelocityY=i*l)}}}var J=typeof window<"u"?window:{screen:{},navigator:{}},St=(J.matchMedia||function(){return{matches:!1}}).bind(J),vn=!1,Lo={get passive(){return vn=!0}},Ge=function(){};J.addEventListener&&J.addEventListener("p",Ge,Lo),J.removeEventListener&&J.removeEventListener("p",Ge,!1);var Mo=vn,ko="PointerEvent"in J,pe="ontouchstart"in J,xn=pe||"TouchEvent"in J&&St("(any-pointer: coarse)").matches,Ze=(J.navigator.maxTouchPoints||0)>0||xn,Sn=J.navigator.userAgent||"",Oo=St("(pointer: coarse)").matches&&/iPad|Macintosh/.test(Sn)&&Math.min(J.screen.width||0,J.screen.height||0)>=768,En=(St("(pointer: coarse)").matches||!St("(pointer: fine)").matches&&pe)&&!/Windows.*Firefox/.test(Sn),jo=St("(any-pointer: fine)").matches||St("(any-hover: hover)").matches||Oo||!pe,le=!Ze||!jo&&En?Ze?"touchOnly":"mouseOnly":"hybrid",Do=le==="mouseOnly"?"mouse":le==="touchOnly"||En?"touch":"mouse";const Po=Object.freeze(Object.defineProperty({__proto__:null,deviceType:le,primaryInput:Do,supportsPassiveEvents:Mo,supportsPointerEvents:ko,supportsTouchEvents:xn},Symbol.toStringTag,{value:"Module"})),Ro=new Set(["INPUT","TEXTAREA","SELECT"]),Cn={};function ae(){return Po}const Tn=e=>e==="BracketLeft"?"[":e==="BracketRight"?"]":tt.camelToPrettyCase(e),kr=Object.freeze(Object.defineProperty({__proto__:null,EmptyCssProperties:Cn,boundPixel:function(e,t=!1,n=0){return e},createSyntheticEvent:e=>{let t=!1,n=!1;return{nativeEvent:e,currentTarget:e.currentTarget,target:e.target,bubbles:e.bubbles,cancelable:e.cancelable,defaultPrevented:e.defaultPrevented,eventPhase:e.eventPhase,isTrusted:e.isTrusted,preventDefault:()=>{t=!0,e.preventDefault()},isDefaultPrevented:()=>t,stopPropagation:()=>{n=!0,e.stopPropagation()},isPropagationStopped:()=>n,persist:()=>{},timeStamp:e.timeStamp,type:e.type}},detectIt:ae,focusableNodeNames:Ro,toPrettyKeyCode:Tn},Symbol.toStringTag,{value:"Module"})),Ao=[];function Ln(e,t,n=Ao){const o=h.useRef(null);return h.useImperativeHandle(e,()=>{if(!o.current)return;const r=o.current,i=t?.();if(!i||typeof i!="object")throw new Error("attributes must return a plain object of values");const s=Object.keys(i),l=s.length;for(let a=0;a<l;a++){const c=s[a],u=i[c];Object.defineProperty(r,c,{value:u,writable:!0,configurable:!0,enumerable:!0})}return r},n),o}const Je=e=>E.jsx(fe,{...e}),Io=({width:e,height:t})=>E.jsx("div",{className:"corner",style:{minWidth:`${e}px`,width:`${e}px`,minHeight:`${t}px`,height:`${t}px`}}),zo=h.memo(h.forwardRef((e,t)=>{const{children:n,viewport:o,onScrollViewport:r,showHorizontalScrollbar:i=!0,showVerticalScrollbar:s=!0,createScrollCorner:l=Io,createHorizontalScrollbar:a=Je,createVerticalScrollbar:c=Je,style:u,touchElement:f,disableTouch:d,...p}=e,_=k(r,[r]),b=Ln(t,()=>({isScrollPane:()=>!0}),[]),x=h.useRef(null);h.useEffect(()=>{x.current&&(x.current.__scrollTop===o?.top&&x.current.__scrollLeft===o?.left||x.current.__isDecelerating||x.current?.scrollTo(o?.left,o?.top,!1))},[o?.left,o?.top,f]);const M=h.useCallback((y,T)=>{_?.({left:y,top:T})},[]),m=h.useCallback(y=>{x.current?.doTouchStart(y.touches,y.timeStamp)},[]),v=h.useCallback(y=>{y.preventDefault(),x.current?.doTouchMove(y.touches,y.timeStamp)},[]),g=h.useCallback(y=>{x.current?.doTouchEnd(y.timeStamp)},[]),j=h.useCallback(({containerWidth:y,containerHeight:T,totalWidth:w,totalHeight:L})=>{x.current.setDimensions(y,T,w,L)},[]);h.useEffect(()=>{const y=f??b.current;if(!d&&ae().supportsTouchEvents&&y&&o){if(!x.current){const T={scrollingX:!0,scrollingY:!0,decelerationRate:.95,penetrationAcceleration:.08};x.current=new To(M,T)}ae().supportsTouchEvents&&(y.addEventListener("touchstart",m),y.addEventListener("touchend",g),y.addEventListener("touchmove",v)),j({containerWidth:o?.width,containerHeight:o?.height,totalWidth:o?.totalWidth,totalHeight:o?.totalHeight})}return()=>{y?.removeEventListener("touchstart",m),y?.removeEventListener("touchend",g),y?.removeEventListener("touchmove",v)}},[o?.width,o?.height,o?.totalWidth,o?.totalHeight,d,f]);const[R,{width:z}]=_t(),[F,{height:S}]=_t(),C=h.useMemo(()=>{const y=c({orientation:rt.Vertical,offset:o?.top,viewportSize:o?.height,totalSize:o?.totalHeight,onScrollOffset:T=>{_?.({top:T})}});return E.jsx("div",{style:{display:"flex",flex:"0"},ref:R,children:y})},[c,o?.top,o?.height,o?.totalHeight]),A=h.useMemo(()=>{const y=a({orientation:rt.Horizontal,offset:o?.left,viewportSize:o?.width,totalSize:o?.totalWidth,onScrollOffset:T=>_?.({left:T})});return E.jsxs("div",{style:{display:"flex",flex:"none",flexDirection:"row",alignItems:"stretch",justifyContent:"center"},children:[E.jsx("div",{style:{display:"flex",flex:"1 1 100%",flexDirection:"column",width:`calc(100% - ${z}px)`},children:E.jsx("div",{ref:F,className:"sizer",children:y})}),s?l({width:z,height:S}):E.jsx(E.Fragment,{})]})},[a,o?.left,o?.width,o?.totalWidth,s,l,z,S]);return E.jsx("div",{style:{position:"relative",display:"flex",minWidth:s?`${z}px`:void 0,minHeight:i?`${S}px`:void 0,...u},...p,ref:b,children:E.jsxs("div",{style:{position:"relative",width:"100%",flex:"1 1 100%",display:"flex",flexDirection:"column",boxSizing:"border-box"},children:[E.jsxs("div",{style:{display:"flex",flex:"1 1 100%",overflow:"hidden"},children:[E.jsx("div",{style:{display:"flex",flex:"1 1 100%",overflow:"hidden"},children:n}),s?C:E.jsx(E.Fragment,{})]}),i?A:E.jsx(E.Fragment,{})]})})}));zo.displayName="ScrollPane";const Qe={Error:"error",Warning:"warning",Info:"info"},tn=new Set,Mn={showMessage:(e,t)=>{if(t?.onceKey){if(tn.has(t.onceKey))return;tn.add(t.onceKey)}let n=console.log;t?.type!==Qe.Warning&&t?.type!==Qe.Error||(n=console.warn),n(e)},showBusy:(e,t)=>new Promise(n=>{n(()=>{})}),showError:e=>{console.error(e)}};let Rt=0;function Or(){const[e,t]=h.useState(!!document.fullscreenElement),n=h.useCallback(()=>{const o=document.fullscreenElement;return o?o.querySelector(".fullscreen-portal-root")||o:document.body},[]);return h.useEffect(()=>{function o(){const r=document.fullscreenElement;if(t(!!r),!r)return;let i=r.querySelector(".fullscreen-portal-root");i||(i=document.createElement("div"),i.className="fullscreen-portal-root _fullscreen-portal-root_1mjsr_4",r.appendChild(i))}return Rt++,o(),document.addEventListener("fullscreenchange",o),()=>{document.removeEventListener("fullscreenchange",o),Rt--,Rt<=0&&(document.querySelectorAll(".fullscreen-portal-root").forEach(r=>{r.parentNode&&r.parentNode.removeChild(r)}),Rt=0)}},[]),{getPortalContainer:n,isFullscreen:e}}const $o=100,Bo=100,Fo=1e6,No=100,Wo=50,Vo=h.memo(h.forwardRef((e,t)=>{const{offset:n=0,viewportSize:o=0,totalSize:r=0,minSize:i=0,endGap:s=$o,endScrollIncrement:l=Bo,style:a=Cn,onMouseDown:c,onScrollOffset:u,onScroll:f,scaleLimit:d=Fo,scaleFactor:p=No,precisionFactor:_=Wo,...b}=e;f&&console.warn("onScroll not supported for VirtualScrollbar. Use onScrollOffset instead");const x=k(c,[c]),M=()=>({offset:n,totalSize:d===0?r:Math.min(r??0,Math.max(i??0,(n??0)+(o??0))+(s??0))}),[m,v]=h.useState(M),g=d!==0&&m.totalSize>d?p:1,j=g/_,R=Math.ceil(m.totalSize/g),z=Math.ceil(m.offset/g),F=Math.ceil(o/g),S=h.useCallback(D=>{},[]),[C,A]=h.useState(!1),y=h.useRef(null);h.useLayoutEffect(()=>{if(!C){y.current={propTotalSize:r,propViewportSize:o,propOffset:n};const D=M();v(D)}},[r,o,n,C,i,s,l]);const T=k((D,X,W)=>{const V=y.current;y.current=null,V&&V.propTotalSize===r&&V.propViewportSize===o&&V.propOffset===n||(Math.abs(D-z)<j&&(D=z),u?.(D*g,z,F))},[u,g,j,z,F]),w=h.useCallback(D=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",w),A(!1)},[]),L=h.useCallback(D=>{x?.(D),A(!0),document.addEventListener("mousemove",S,{passive:!0}),document.addEventListener("mouseup",w,{passive:!0})},[S,w]);return E.jsx(fe,{ref:t,style:{...a},...b,offset:z,totalSize:R,viewportSize:F,onMouseDown:L,onScrollOffset:T})}));Vo.displayName="VirtualScrollbar";const jr={BottomEnd:"bottom-end",BottomStart:"bottom-start",Bottom:"bottom",LeftEnd:"left-end",LeftStart:"left-start",Left:"left",RightEnd:"right-end",RightStart:"right-start",Right:"right",TopEnd:"top-end",TopStart:"top-start",Top:"top"};function Jt(e,t){if(typeof e=="function")return e(t);e&&(e.current=t)}var Nt=parseInt(h.version.split(".")[0],10)>=19?function(e){return t=>{const n=[];for(const o of e){const r=Jt(o,t),i=typeof r=="function";n.push(i?r:()=>Jt(o,null))}return()=>{for(const o of n)o()}}}:function(e){return t=>{for(const n of e)Jt(n,t)}};h.memo(h.forwardRef((e,t)=>{const{refFocusStart:n,...o}=e,r=h.useRef(null),i=h.useCallback(()=>{if(n)return void n?.current?.focus();const s=r.current.parentElement.children;let l=[];for(let a=0;a<s.length&&s[a]!==r.current;a++){const c=s[a].getAttribute("tabindex");if(c==null||c==="-1"||s[a].getAttribute("disabled")==="true")continue;const u=s[a];u.focus&&l.push({tabindex:parseInt(c),child:u})}l.length!==0&&(l.sort(function(a,c){return a.tabindex-c.tabindex}),l[0].child.focus())},[n]);return E.jsx("div",{tabIndex:0,ref:Nt([r,t]),onFocus:i,...o})}));const Dr=h.memo(h.forwardRef((e,t)=>{const{className:n,style:o,children:r,radius:i=4,strokeWidth:s=1,strokeColor:l="grey",...a}=e,[c,{width:u,height:f}]=_t(),d=h.useRef(null),p=(M,m=0)=>{const v=M/2,g=f-v+m;return function(j,R,z=!1){if(R===0)return j;function F(w,L,D){let X=L.x-w.x,W=L.y-w.y,V=Math.sqrt(X*X+W*W);return S(w,L,Math.min(1,D/V))}function S(w,L,D){return{x:w.x+(L.x-w.x)*D,y:w.y+(L.y-w.y)*D}}function C(w,L){w.length>2&&(w[w.length-2]=L.x,w[w.length-1]=L.y)}function A(w){return{x:parseFloat(w[w.length-2]),y:parseFloat(w[w.length-1])}}let y=j.split(/[,\s]/).reduce(function(w,L){let D=L.match("([a-zA-Z])(.+)");return D?(w.push(D[1]),w.push(D[2])):w.push(L),w},[]).reduce(function(w,L){return parseFloat(L)==L&&w.length?w[w.length-1].push(L):w.push([L]),w},[]),T=[];if(y.length>1){let w=A(y[0]),L=null;y[y.length-1][0]==="Z"&&y[0].length>2&&(L=["L",w.x,w.y],y[y.length-1]=L),T.push(y[0]);for(let D=1;D<y.length;D++){let X=T[T.length-1],W=y[D],V=W===L?y[1]:y[D+1];if(V&&X&&X.length>2&&W[0]==="L"&&V.length>2&&V[0]==="L"){let K,I,N=A(X),H=A(W),et=A(V);z?(K=S(H,X.origPoint||N,R),I=S(H,V.origPoint||et,R)):(K=F(H,N,R),I=F(H,et,R)),C(W,K),W.origPoint=H,T.push(W);let gt=S(K,H,.5),yt=S(H,I,.5),$=["C",gt.x,gt.y,yt.x,yt.y,I.x,I.y];$.origPoint=H,T.push($)}else T.push(W)}if(L){let D=A(T[T.length-1]);T.push(["Z"]),C(T[0],D)}}else T=y;return T.reduce(function(w,L){return w+L.join(" ")+" "},"")}(`${`M 0 ${v} L ${i-.5} ${v} L ${i-.5} ${g} L ${2*i} ${g}`} ${`L ${u-2*i} ${g}`} ${`M ${u-2*i} ${g} L ${u-i} ${g} L ${u-i} ${v} L ${u} ${v}`}`,i)},_=h.useMemo(()=>p(s),[u,f,i,s]),b=h.useMemo(()=>{if(i===0)return;const M=i/2;return p(i)+`L ${u} 0 L 0 0 L 0 ${M}`},[_,i,s]),x=h.useMemo(()=>({style:{clipPath:`path('${b}')`}}),[b]);return E.jsxs("div",{className:n,style:{display:"flex",flexDirection:"row",...o},...a,ref:Nt([d,c,t]),children:[pt.isValidElement(r)?pt.cloneElement(r,x):E.jsx(E.Fragment,{}),E.jsx("svg",{style:{position:"absolute",top:0,left:0,pointerEvents:"none"},width:u,height:f,viewBox:`0 0 ${u} ${f}`,children:E.jsx("path",{d:_,stroke:l,fill:"none",vectorEffect:"non-scaling-stroke",strokeWidth:s})})]})})),Ko={},Ho=e=>{const{onPointerDown:t,style:n,splitDirection:o,paddingBefore:r=0,paddingAfter:i=0,disabled:s,key:l,hitAreaProps:a=Ko,...c}=e,u=o==="row",{style:f,className:d,...p}=a;return E.jsx("div",{style:{...n,position:"relative"},...c,children:E.jsx("div",{className:bt("hit-box",d),style:{left:(u?-r:0)+"px",width:`calc(100% + ${u?r+i:0}px)`,top:(u?0:-r)+"px",height:`calc(100% + ${u?0:r+i}px)`,position:"absolute",...f},onPointerDown:s?void 0:t,...p})},l)},At={},ft=(e,t,n=!0)=>e===null?null:e.pixels!==null?n?e.pixels:t-e.pixels:(n?e.percent:100-e.percent)/100*t,It=(e,t=!0)=>e?.percent?`${t?e.percent:100-e.percent}%`:e?.pixels?`${e.pixels}px`:void 0,ut=(e,t)=>{if(e==null)return null;const n={percent:null,pixels:null};let o=t;return typeof e=="string"&&((e=e.trim().toLowerCase()).endsWith("px")?(e=e.substring(0,e.length-2),o=!1):e.endsWith("%")&&(e=e.substring(0,e.length-1),o=!0),e=parseFloat(e)),o?n.percent=e:n.pixels=e,Object.freeze(n)},Pr=h.memo(h.forwardRef((e,t)=>{const{elementBefore:n,elementAfter:o,splitDirection:r="row",fixedPane:i=null,position:s,onPositionChange:l,minBefore:a,maxBefore:c,minAfter:u,maxAfter:f,children:d,className:p,style:_,disabled:b=!1,onDragStart:x,onDragResize:M,onDragFinish:m,resizerProps:v=At,paneProps:g=At,paneBeforeProps:j=At,paneAfterProps:R=At,createResizer:z=Ho}=e;if(d)throw new Error("Use elementBefore and elementAfter instead of children.");const F=h.useMemo(()=>pt.isValidElement(o)&&pt.isValidElement(n),[o,n]),S=h.useMemo(()=>{let O=null;i&&(i==="before"?O=0:i==="after"&&(O=1));const B=O===null;return{fixedPaneOffset:O,isPercent:B,minBefore:ut(a,B),maxBefore:ut(c,B),minAfter:ut(u,B),maxAfter:ut(f,B)}},[a,c,u,f]),C=k(l,[l]),[A,y]=h.useState(()=>ut(s,i===null));h.useEffect(()=>{y(ut(s,i===null))},[s,i]);const[T,{width:w,height:L}]=_t(),[D,{width:X,height:W}]=_t(),V=r==="row"?X:W,K=r==="row"?w:L,I=h.useMemo(()=>((O,B,G,U)=>{const lt=[null,null],nt=[null,null];if(O||(O={percent:U.fixedPaneOffset===null?50:null,pixels:U.fixedPaneOffset===null?null:0}),B===0)return O?.pixels!=null?U.fixedPaneOffset!==1?(lt[0]=O?.pixels,nt[1]=100):(lt[1]=O?.pixels-G,nt[0]=100):O?.percent!=null&&(U.fixedPaneOffset!==1?(nt[0]=O?.percent,nt[1]=100-O?.percent):(nt[1]=O?.percent,nt[0]=100-O?.percent)),{percents:nt,pixels:lt,minBefore:It(U.minBefore,!0),maxBefore:It(U.maxBefore,!0),minAfter:It(U.minAfter),maxAfter:It(U.maxAfter)};let ct=ft(O,B,U.fixedPaneOffset!==1),Q=B-G,ve=ft(U.minBefore,Q,!0)??0,qn=ft(U.maxBefore,Q,!0)??Q,Pt=0,Kt=0,xe=0,Se=Q;Pt=(ft(U.maxAfter,B,!1)??G)-G,Kt=ft(U.minAfter,B,!1)??B,xe=Math.max(ve,Pt),Se=Math.min(qn,Kt),ct=Math.max(xe,Math.min(ct,Se)),Kt=Math.min(Q-ct,ft(U.maxAfter,Q-ct,!0)??Q),Pt=Math.min(Q-ct,ft(U.minAfter,Q-ct,!0)??Q),lt[0]=ct,lt[1]=Q-lt[0];const Yn=Math.max(0,Math.min(100,ct/Q*100));return nt[0]=Yn,nt[1]=100-nt[0],{percents:nt,pixels:lt,minBefore:`${ve}px`,minAfter:`${Pt}px`,maxBefore:`${lt[0]}px`,maxAfter:`${lt[1]}px`}})(A,K,V,S),[S,A,K,V,r]),[N,H]=h.useState(!1),et=k(x,[x]),gt=k(M,[M]),yt=k(m,[m]),$=h.useRef(null),it=h.useRef(null),ot=h.useRef(null),{style:dt,className:st,...at}=g,Et={minWidth:0,minHeight:0,maxWidth:"100%",maxHeight:"100%",display:"flex",overflow:"hidden",...dt},{className:Pn,style:Rn,...An}=j,{className:In,style:zn,...$n}=R,Bn={flex:"1 1 100%",width:"100%",..._,flexDirection:r,display:"flex"},{className:me,style:_e,onPointerDown:ge,...ye}=v,Fn=k(O=>{const B=ut(O,i===null);y(B)},[i]),jt=k(O=>{if(b||!N)return;const B=be.current?.getBoundingClientRect();let G=0;G=r==="row"?(O.clientX??O.touches?.[0]?.clientX)-B.x:(O.clientY??O.touches?.[0]?.clientY)-B.y,G=Math.max(0,Math.min(K,G)),S.fixedPaneOffset===1&&(G=K-G),s&&A.pixels===G||y({pixels:G,percent:null}),gt?.(G),O.stopPropagation(),O.preventDefault()},[S,r,b,N,A,K]),we=k(O=>{if(document.removeEventListener("pointermove",jt),document.removeEventListener("touchmove",jt),document.removeEventListener("pointerup",we),!!N&&(H(!1),!!A)){if(yt(A.pixels),!ut(s,i===null)||A.pixels!==s){const B={...A};B.percent===null&&(B.percent=B.pixels/K*100),C(B)}O.stopPropagation(),O.preventDefault()}},[A,N,s,i,K]),Nn=k(O=>{ge?.(O),O.defaultPrevented||b||N||(H(!0),et(),document.addEventListener("pointermove",jt,{passive:!1}),document.addEventListener("touchmove",jt,{passive:!1}),document.addEventListener("pointerup",we,{passive:!1}))},[ge]),be=Ln(t,()=>({setPosition:Fn,isSplitPane:()=>!0}),[]),Wn=h.useMemo(()=>F?z?.({key:"resizer",ref:Nt([D,it]),className:bt("resizer",me),onPointerDownCapture:Nn,style:{cursor:b?void 0:r==="row"?"ew-resize":"ns-resize",minWidth:r==="row"?"2px":void 0,minHeight:r!=="row"?"2px":void 0,boxSizing:"border-box",pointerEvents:"all",zIndex:1,..._e},splitDirection:r,disabled:b,...ye}):null,[F,me,ye,r,_e,b]),Dt=r==="row"?"Width":"Height",Vn={...Et,...Rn,flex:S.fixedPaneOffset===0&&I?.pixels[0]!==null?`0 0 ${Math.round(I?.pixels[0])}px`:`1 1 ${Math.round(I?.percents[0]??100)}%`,[`min${Dt}`]:I?.minBefore,[`max${Dt}`]:o?I?.maxBefore:"100%"},Kn={...Et,...zn,flex:S.fixedPaneOffset===1&&I?.pixels[1]!==null?`0 0 ${Math.round(I?.pixels[1])}px`:`1 1 ${Math.round(I?.percents[1]??100)}%`,[`min${Dt}`]:I?.minAfter,[`max${Dt}`]:n?I?.maxAfter:"100%"},Hn=h.useMemo(()=>n?E.jsx("div",{ref:$,className:bt("before",st,Pn),style:Vn,...at,...An,children:n},"before"):null,[n,g,j,S,I]),Un=h.useMemo(()=>o?E.jsx("div",{ref:ot,className:bt("after",st,In),style:Kn,...at,...$n,children:o},"after"):null,[o,g,R,S,I]);return E.jsxs("div",{ref:Nt([T,be]),className:bt("splitPane",r==="row"?"vertical":"horizontal",{dragging:N},p),style:Bn,children:[Hn,Wn,Un]})}));function Uo(e){if(!e)throw new Error("must have a PointerHandlerOptions");const{onPointerDown:t,onPointerUp:n,onPointerMoveOrWait:o,processTouch:r=!1,consumeTouch:i=!0}=e,s=k(t,[t]),l=k(n,[n]),a=k(o,[o]),c=h.useRef(!1),u=e?.timerInitial??230,f=e?.timerContinuous??u/2,d=h.useRef(null),p=h.useRef(null),_=h.useRef(null),b=h.useRef(null),x=h.useCallback(()=>{b.current&&(clearTimeout(b.current),b.current=null)},[]),M=h.useCallback(C=>{b.current=setTimeout(()=>{window.requestAnimationFrame(()=>{c.current!==!1&&a?.(p.current,_.current,d.current)}),M(f)},C??u)},[]);h.useEffect(()=>()=>x(),[]);const m=r?"pointer":"mouse",v=h.useCallback(C=>{C.stopPropagation(),C.stopImmediatePropagation(),C.preventDefault()},[]),g=k(C=>{document.removeEventListener(`${m}move`,z),document.removeEventListener(`${m}up`,g),document.removeEventListener("keydown",F),document.removeEventListener("keyup",S),document.removeEventListener("touchstart",v,{capture:!0}),document.removeEventListener("touchmove",v,{capture:!0}),window.removeEventListener("blur",j),x(),window.requestAnimationFrame(()=>{c.current!==!1&&(c.current=!1,l?.(C,_.current,d.current),_.current=null)})},[]),j=h.useCallback(()=>{c.current!==!1&&(c.current=!1,g(p.current))},[]),R=k(()=>{x(),M(f),window.requestAnimationFrame(()=>{c.current!==!1&&a?.(p.current,_.current,d.current)})},[f]),z=k(C=>{p.current=C,R()},[]),F=k(C=>{_.current={ctrlKey:C.ctrlKey,shiftKey:C.shiftKey,altKey:C.altKey,metaKey:C.metaKey},R()},[]),S=k(C=>{_.current={ctrlKey:C.ctrlKey,shiftKey:C.shiftKey,altKey:C.altKey,metaKey:C.metaKey},R()},[f]);return k(C=>{C.isDefaultPrevented()||(_.current={ctrlKey:C.ctrlKey,shiftKey:C.shiftKey,altKey:C.altKey,metaKey:C.metaKey},s(C,_.current)!==!1&&(d.current=C,p.current=C.nativeEvent,document.addEventListener(`${m}up`,g,{passive:!1}),document.addEventListener(`${m}move`,z,{passive:!1}),document.addEventListener("keydown",F,{passive:!1}),document.addEventListener("keyup",S,{passive:!1}),window.addEventListener("blur",j,{passive:!0}),r&&i&&(document.addEventListener("touchstart",v,{passive:!1,capture:!0}),document.addEventListener("touchmove",v,{passive:!1,capture:!0})),c.current=!0,M(u)))},[u,r])}function Rr(e,t){return Uo({onPointerDown:e,onPointerMoveOrWait:(n,o,r)=>{e?.(r)},...t})}const qo=({initValue:e,useHookBody:t,applyStateChange:n})=>{const o=h.useRef(e);if(typeof t!="function")throw new Error("function expected as hook body parameter. got "+typeof t);const r=t();return h.useLayoutEffect(()=>{o.current!==r&&(o.current=r,n(r))},[n,r]),null},ce=e=>{console&&console.warn&&console.warn(e)},Qt=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||void 0;let Yo=1,ue=!1,kn=!1;const Bt=[],vt=[],Wt=()=>{vt.forEach(e=>e())},Xo=({automaticContainerInternalUseOnly:e})=>{const[t,n]=h.useState([]),o=h.useRef([]);return o.current=t,e||ue!==!1||(kn=!0),h.useEffect(()=>{let r=!0;function i(){if(r)return vt[0]!==i?(e||ue!==!0||ce("SingletonHooksContainer is mounted after some singleton hook has been used.Your SingletonHooksContainer will not be used in favor of internal one."),void n(s=>[])):void n([...Bt])}return vt.push(i),Wt(),()=>{r=!1,o.current?.length>0&&ce("SingletonHooksContainer is unmounted, but it has active singleton hooks. They will be reevaluated once SingletonHooksContainer is mounted again"),vt.splice(vt.indexOf(i),1),Wt()}},[e]),E.jsx(E.Fragment,{children:t.map(({hook:r,key:i})=>h.createElement(qo,{...r,key:i}))})},Go=e=>{const t=Yo++;return Bt.push({hook:e,key:t}),vt.length===0&&kn===!1&&(ue=!0,(n=>{if(Qt.document&&Qt.document.createElement){const o=Qt.document.createElement("div");Gn.createRoot(o).render(E.jsx(n,{automaticContainerInternalUseOnly:!0}))}else ce("Can not mount SingletonHooksContainer on server side. Did you manage to run useEffect on server? Please mount SingletonHooksContainer into your components tree manually.")})(Xo)),Wt(),()=>{Bt.splice(Bt.findIndex(n=>n.key===t),1),Wt()}};let he=null;he||(he=(e,t,n={})=>{let o,r,i=!1,s=!1,l=[],{unmountIfNoConsumers:a=!1}=n;const c=f=>{r=f,Xn.unstable_batchedUpdates(()=>l.forEach(d=>d(f)))},u=()=>(s||(r=typeof e=="function"?e():e,s=!0),r);return()=>{const[f,d]=h.useState(u);return h.useEffect(()=>(i||(i=!0,o=Go({initValue:e,useHookBody:t,applyStateChange:c})),l.push(d),r!==f&&d(r),()=>{l.splice(l.indexOf(d),1),l.length===0&&a&&(o(),i=!1)}),[]),f}});const On=he;let jn=()=>{console.warn("You must call useEditMode before setting its state.")};const Zo=On(null,()=>{const[e,t]=h.useState(null);return jn=t,e}),Ar=()=>{const e=Zo();return h.useMemo(()=>({setMode:t=>{jn(n=>(typeof t=="function"&&(t=t(n)),t?.onModeChange?.(t??null),t))},getMode:()=>e}),[e])};class de{constructor(t,n,o,r){this._listenersProperties=new Set,this._listenersExecute=new Set,this._key=t,this._target=n,this._applyProps(o||{}),this._callback=r,r===void 0&&(this._callback=()=>{console.log(`implement: ${this.label()} : ${this.description()}`)})}key(){return this._key}_resolve(t,n){if(typeof t=="function"){const o=n??this._context;return t(typeof o=="function"?o():o)}return t}target(){return typeof this._target=="function"?this._target():this._target}label(t,n){const o=this._scopedLabels?.[t]||this._label;let r=null;if(typeof o=="function"){const i=n??this._context;r=o(typeof i=="function"?i():i)}else r=o;return r}description(t){return this._resolve(this._description,t)}tags(t){return this._resolve(this._tags,t)}icon(t){return this._resolve(this._icon,t)}shortcut(){return this._resolve(this._shortcut)}disabled(){return this._resolve(this._disabled)||!this._callback}state(){return this._resolve(this._state)}context(){return typeof this._context=="function"?this._context():this._context}async execute(t,n){if(!this.disabled()&&this._callback){try{let o=!0;if(n?.beforeExecute&&(o=n?.beforeExecute(this,t)),await Promise.resolve(o)===!1)return!1;const r=this._callback.bind(this)(t,this);if(await Promise.resolve(r)===!1)return!1;n?.onExecute?.(this,t),this._notifyExecute(t)}catch(o){return console.warn(o),n?.onError(this,o,t),this._notifyError(t,o),!1}return!0}}addPropertyListener(t,n=!1){if(!t)throw new Error("listener must be specified");const o=this._listenersProperties;return o.add(t),n&&t({},this),()=>{o.delete(t)}}addExecuteListener(t){if(!t)throw new Error("listener must be specified");const n=this._listenersExecute;return n.add(t),function(){n.delete(t)}}_notifyExecute(t){const n=this;this._listenersExecute.forEach(o=>{o.onExecute(n,t)})}_notifyError(t,n){const o=this;this._listenersExecute.forEach(r=>{r.onError?.(o,t,n)})}updateCallback(t){return this._callback=t||null,this}update(t){if(!t)return;const n=this._applyProps(t);return Object.keys(n).length>0&&this._notifyPropertyChange(n),this}_notifyPropertyChange(t){const n=this;this._listenersProperties.forEach(o=>{o(t,n)})}_applyProps(t){let n={},o=this;return Object.keys(t).forEach(r=>{let i=t[r];o["_"+r]!==i&&(o["_"+r]=n[r]=i)}),n}}class te extends de{}class Dn{constructor(t,n){this._target=null,this._groupKey=null,this._root=null,this._parent=null,this._uuid=tt.uuidV4(),this._target=t,this._groupKey=n??null,this._root=this,this._nodes=new Map,this._nodes.set(n,this),this._children=new Map,this._listeners=new Set,this._commandsByKey=new Map,this._commandsByShortcut=new Map;const o=this;this._unListenersByCommand=new Map,this._listenersByKey=new Map,this._commandsPropertyListener=(r,i)=>{const s=o._root._listenersByKey,l=i.key(),a=s.get(l);a&&o._notifyCommands(a,"onCommandChange",i)}}_getCommand(t){return this._commandsByKey.get(t)||(this._parent?._getCommand(t)??null)}getCommand(t,n=!1){const o=this._root._focused;let r=o,i=o===this;for(;!i&&r;)r===this&&(i=!0),r=r._parent;return(i?o:this)._getCommand(t)}createChildGroup(t,n,o){let r;if(!o){let l=this;for(;l&&!r;){let a=l._nodes.get(n);a&&(r=a),l=l._parent}}r||(r=new Dn(t,n),r._parent=this,r._root=this._root,r._unListenersByCommand=null,r._listenersByKey=null,r._commandsPropertyListener=null);const i=(l,a)=>{!l.has(n)||o?l.set(n,a):o===void 0&&console.warn("commandGroup already registered",n)};i(this._root._nodes,r);let s=this._parent;for(;s;)i(this._nodes,r),s=s._parent;return this._children.set(n,r),this._notify("onGroupChange"),r}getKey(){return this._groupKey}getGroup(t){return this._nodes.get(t)}_addCommands(t,n=void 0){const o=this._commandsByKey,r=this._commandsByShortcut,i=this._root._commandsPropertyListener,s=this._root._unListenersByCommand;for(let l=0;l<t.length;l++){const a=t[l],c=a.key();if(o.has(c)&&!n){n===void 0&&console.warn("command already registered",c);continue}o.set(c,a);let u=s.get(a);u&&(u(),s.delete(a));const f=a.addPropertyListener(i);s.set(a,f);const d=a.shortcut();if(!d)continue;const p=Array.isArray(d)?d:[d];for(let _=0;_<p.length;_++){const b=Lt(p[_]),x=r.get(b);x&&!n&&n===void 0&&console.warn(`Shortcut already registered: ${b}, ${c}, ${x}.`),r.set(b,c)}}}removeFromParent(){if(!this._parent)return;let t=this._parent,n=[];const o=this._groupKey;for(;t;)n.push(t._nodes),t._nodes.delete(o),t=t._parent;t=this._parent;const r=i=>{i._children.forEach(s=>{for(let l=0;l<n.length;l++)s._nodes.delete(n[l]);r(s)})};r(this),this._parent=null,this._notify("onGroupChange")}addCommands(t,n){this._addCommands(t,n),this._notify("onGroupChange")}getActive(){return this._root._focused??this._root}activate(t){let n=this;if(t&&(n=this._nodes.get(t),!n))return void console.warn("group not found",t);let o=this._root._focused??this._root;for(;o;)o=o._parent;this._root._focused!==n&&(this._root._focused=n,this._notify("onGroupChange"),this._notify("onActiveChange"))}findCommandByEvent(t){const n=[];t.altKey&&n.push(Y.Alt),t.shiftKey&&n.push(Y.Shift),t.ctrlKey&&n.push(Y.Ctrl),t.metaKey&&n.push(Y.Meta);let o=Lt({key:t.code,modifiers:n});const r=this._commandsByShortcut;let i=r.get(o);i||(o=Lt({key:t.key,modifiers:n}),i=r.get(o)),!i&&t.code.startsWith("Digit")&&(o=Lt({key:t.code.substring(5,t.code.length),modifiers:n}),i=this._commandsByShortcut.get(o)),!i&&t.code.startsWith("Key")&&(i=Lt({key:t.code.substring(3,t.code.length),modifiers:n}),i=r.get(o));let s=null;return i&&(s=this._commandsByKey.get(i),s&&s.disabled()&&(s=null),!s||s.target()&&s.target().contains(t.target)||(s=null)),s||(this._parent?.findCommandByEvent(t)??null)}dispatchToFocusedCommand(t){const n=this.getActive();if(!n||t.isDefaultPrevented())return!1;const o=n.findCommandByEvent?.(t);return!!o&&(o.execute(),t.preventDefault(),!0)}getRoot(){return this._parent?this._parent.getRoot():this}getParent(){return this._parent}addListener(t,n){const o=this._listeners,r=n?.keys,i=this._root._listenersByKey;if(r&&!t.onCommandChange)throw new Error("keys were provided but the listener does not contain 'onCommandChange'.");let s=null;if(r)for(let l=0;l<r.length;l++){const a=r[l];if(!a)continue;let c=i.get(a);c||(c=new Set,i.set(a,c)),s||(s=[]),s.push(c),c.add(t)}return o.add(t),()=>{if(s)for(let l=0;l<s.length;l++)s[l].delete(t);o.delete(t)}}_notifyCommands(t,n,o){const r=this;setTimeout(()=>{t.forEach(i=>{i[n]?.(r,o)})},0)}_notify(t,n){const o=this;setTimeout(()=>{o._listeners.forEach(r=>{r[t]?.(o,n)}),o._parent&&o._parent._notify(t,n)},0)}getAllCommands(){const t=[],n=this._groupKey;return this._commandsByKey.forEach(o=>{t.push({command:o,groupKey:n})}),this._children.forEach(o=>{t.push(...o.getAllCommands())}),t}}const Jo=tt.getOS()===tt.OSType.MacOS||tt.getOS()===tt.OSType.IOS?"Cmd":"Ctrl",Qo=tt.getOS()===tt.OSType.MacOS||tt.getOS()===tt.OSType.IOS?"":"^",Lt=(e,t=!1)=>{const n={};for(let r=0;e.modifiers&&r<e.modifiers.length;r++)n[e.modifiers[r]]=!0;let o="";return(n?.[Y.Ctrl]||n?.[Y.Meta])&&(o+=(o.length>0?"+":"")+(t?Qo:Jo)),n?.[Y.Alt]&&(o+=t?"":"Alt"),n?.[Y.Shift]&&(o+=(o.length>0?"+":"")+(t?"":"Shift")),o+=(o.length>0?"+":"")+Tn(e.key),o};function Ir(e,t=null){const n=h.useRef(t);n.current=t;const[o,r]=h.useReducer(s=>s+1,0),i=h.useMemo(()=>Array.isArray(e)?e:[e],[e]);return h.useEffect(()=>{if(!i||i.length===0)return;const s=(c,u)=>{n.current?.onChange?.(u),r()};let l=null;t&&(l={onExecute(c,u){n.current?.onExecute?.(c,u)},onError(c,u,f){n.current?.onError?.(c,u,f)}});const a=new Set;for(let c=0;c<i.length;c++)a.add(i[c]?.addPropertyListener(tt.debounce(s,0),!0)),t&&a.add(i[c]?.addExecuteListener(l));return()=>{a.forEach(c=>{c?.()})}},[e]),o}const zt=(e,t)=>{const n=[];if(t)for(let o=0;o<t.length;o++){const r=t[o],i=r?e?.getCommand(r):null;n.push(i)}return n};function zr(e,t=null,n=null,o){const r=h.useRef(n);r.current=n,t&&!Array.isArray(t)&&(t=[t]);const[i,s]=h.useState(zt(e,t)),l=o?[...o,e]:[e];return h.useEffect(()=>{const a={onGroupChange:()=>{const d=zt(e,t);s(d),r.current?.onChange?.(this)}};let c;t&&t.length>0&&(c={keys:t},a.onCommandChange=(d,p)=>{r.current?.onChange?.(e),s(zt(e,t))});const u=e?.addListener(a,c),f=zt(e,t);return s(f),r.current?.onChange&&r.current?.onChange(e),()=>{u?.()}},l),i}const $r={Toolbar:"toolbar",Menuitem:"menuitem"},tr=On({setClipboard:e=>{throw new Error("This is only available via the useClipboard.")},getClipboard:()=>xt.Global,refNativeCopy:{current:null},refNativeLastKey:{current:null}},()=>{const[e,t]=h.useState(xt.Global);return{setClipboard:n=>t(n),getClipboard:()=>e,refNativeCopy:h.useRef(null),refNativeLastKey:h.useRef(null)}}),Br=e=>{const{source:t,target:n,onPaste:o,onClipboardUpdate:r,notifier:i=Mn,commands:s}=e,l=k(r,[r]),a=k(o,[o]),{getClipboard:c,refNativeCopy:u}=tr(),f=c();h.useMemo(()=>{const m=t?.element,v=n?.element??t?.element;if(!s)return;const g=[new te("cut",m,{label:"Cut",description:"Remove the selection and put it on the clipboard so you can paste it somewhere else.",shortcut:{key:"X",modifiers:[Y.Ctrl]}}),new te("copy",m,{label:"Copy",description:"Put a copy of the selection on the clipboard so you can paste it somewhere else.",shortcut:{key:"C",modifiers:[Y.Ctrl]}}),new te("paste",v,{label:"Paste",description:"Add content on the clipboard to your document.",shortcut:[{key:"V",modifiers:[Y.Ctrl]},{key:"F8",modifiers:[Y.Ctrl]}]})];s?.addCommands(g,!0)},[s]);const d=k(async m=>{if(!t?.element)return;let v=null;try{v=t.doCopy?.(m),typeof v=="string"?await f.writeText(v):await f.writeReference(v)}catch(g){throw g}},[t,i]),p=k(async m=>{const v=t?.element?.();if(v){u.current={sourceElement:v,args:m};try{await d(m)}catch(g){i?.showError?.(g)}}},[t?.element,i]),_=h.useCallback(()=>{p({isCut:!0})},[]),b=k(async(m,v,g)=>{try{if(await m.doPaste(v,g)===!1)return;a?.(v,g)}catch(j){i?.showError?.(j)}},[a]),x=k(async(m,v,g)=>{const j=n?.element?.();if(j&&await tt.whenFocus(j),!m&&!v)return;const R=await i?.showBusy?.("Pasting...");if(v)try{return await b(n,v,g),void R?.()}catch(S){R?.(),i?.showError?.(S)}let z,F=n.importFromExternal;F||(F=(S,C)=>({getItemType:()=>"text",toText:()=>m.text,isClipboardItem:!0}));try{z=await F(m,{isCut:!1})}catch(S){R?.(),i?.showError?.(S)}if(z)try{const S=await Promise.resolve(z);await b(n,S,g),R?.()}catch(S){R?.(),i?.showError?.(S)}else R?.()},[b,n,i]),M=k(async m=>{if(n?.element)try{const v=await f.readReference();if(v)return void await x(null,v,m);const g=[];g[0]=await Gt.readStringFromClipboard(f,P.plain),g[1]=await Gt.readHTMLFromClipboard(f,P.html),g[2]=await Gt.readBlobFromClipboard(f,P.png);const j={text:g[0]??null,html:g[1]??null,image:g[2]??null};await x(j,null,m)}catch(v){if(v?.message==="Document is not focused.")return;i?.showError?.(v)}},[x,n?.element,i]);return k(async m=>{},[t?.element]),k(async m=>{},[n?.element,x,i]),h.useEffect(()=>{if(!f)return;const m=async j=>{const R=await f.readReference();l?.(R)},v=j=>{i?.showMessage?.(xt.ErrorMessages.PermsRead,{onceKey:"clipboard.features"})},g=j=>{i?.showMessage?.(xt.ErrorMessages.PermsWrite,{onceKey:"clipboard.features"})};return f.addEventListener("clipboardchange",m),f.addEventListener("clipboarderrorread",v),f.addEventListener("clipboarderrorwrite",g),()=>{f.removeEventListener("clipboardchange",m),f.removeEventListener("clipboarderrorread",v),f.removeEventListener("clipboarderrorwrite",g)}},[f,i]),h.useEffect(()=>{},[d,x,t,n]),h.useEffect(()=>{s?.getCommand("cut")?.updateCallback(_).update({disabled:!t||!n}),s?.getCommand("copy")?.updateCallback(p).update({disabled:!t}),s?.getCommand("paste")?.updateCallback(M).update({disabled:!n})},[t,n,s]),{paste:M,copy:p,clipboard:f}};let ee=!1,er=0;var nr=typeof document<"u"?h.useLayoutEffect:h.useEffect;const en=()=>"sheetxl-ui-"+er++,or=pt.useId,Fr=or??function(){const[e,t]=pt.useState(()=>ee?en():void 0);return nr(()=>{e==null&&t(en())},[]),pt.useEffect(()=>{ee||(ee=!0)},[]),e},nn="Undo the last action.",on="Repeat the last action or undo the redo.",rr=e=>`Redo ${e}`,Nr=({manager:e,commands:t,disabled:n,notifier:o=Mn})=>{const r=k(s=>{try{e?.undo(s)}catch(l){o.showError?.(l)}},[e]),i=k(s=>{try{e?.redo(s)}catch(l){o.showError?.(l)}},[e]);return h.useMemo(()=>{if(!t)return;const s={contains:a=>!0,focus(){}},l=[new de("undo",s,{label:"Undo",description:nn,shortcut:{key:"z",modifiers:[Y.Ctrl]},disabled:!0},r),new de("redo",s,{label:"Redo",description:on,shortcut:[{key:"y",modifiers:[Y.Ctrl]},{key:"F4"},{key:"Enter",modifiers:[Y.Alt]}],disabled:!0},i)];t?.addCommands(l,!0)},[t]),h.useEffect(()=>{if(!t)return;const s=()=>{const a=e?.getTopUndoDescription(),c={};var u;t.getCommand("undo").update({disabled:n||!e||!e.hasUndo(),description:a?(u=a,`Undo ${u}`):nn,state:c,context:{undoManager:e}});const f=e?.getTopRedoDescription();t.getCommand("redo").update({disabled:n||!e||!e.hasRedo(),description:f?rr(f):on,state:c,context:{undoManager:e}})};if(s(),!e)return;const l=e.addListener({onStackChange(){s()}});return()=>l?.()},[e,t,n]),{undo:r,redo:i}};export{Rr as $,Ln as A,Mn as B,vo as C,Lr as D,Mr as E,rt as F,ar as G,cr as H,Qe as I,de as J,ur as K,Dn as L,zr as M,jr as N,Uo as O,Br as P,Er as Q,Vo as R,Dr as S,zo as T,Pr as U,xr as V,tr as W,tt as X,hr as Y,dr as Z,Nr as _,k as a,Tr as b,te as c,Y as d,Cr as e,Fr as f,Ir as g,$r as h,kr as i,_r as j,fr as k,br as l,wr as m,mr as n,gr as o,Ne as p,pr as q,Or as r,vr as s,fe as t,P as u,yr as v,Vt as w,Ar as x,Z as y,bo as z};
