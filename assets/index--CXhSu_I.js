import{j as re,r as oo}from"./index-J-Hv9Xln.js";import{Z as W,a as L,X as jt,H as Ze,A as ro,T as So,i as Q,b as Hn,O as nn,G as x,c as ae,d as ue,e as Pt,Q as dn,y as Wt,r as lo,f as Co}from"./index-DvhsF04y.js";import{r as o}from"./iframe-CBk8unIv.js";(function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode("._sheetxl-grid_h9wwa_7{position:relative;box-sizing:border-box;user-select:none}._sheetxl-grid_h9wwa_7 *{box-sizing:border-box!important}._sheetxl-grid_h9wwa_7 *:focus{outline:none}._sheetxl-grid_h9wwa_7 .cell-container{position:absolute;overflow:visible;white-space:pre}._sheetxl-grid_h9wwa_7 .cell-container>*{inset:0;position:absolute}._sheetxl-grid_h9wwa_7 .sheetxl-stage{contain:strict}._sheetxl-grid_h9wwa_7 .sheetxl-stage>*{contain:strict}")),document.head.appendChild(e)}}catch(n){console.error("vite-plugin-css-injected-by-js",n)}})();/**
 * @license @sheetxl/grid-react - Grid React - Advanced grid component for React - v0.6.6
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const tn=({itemType:e,index:n,itemSize:r,instanceProps:l,scale:d=1})=>{let a,s,i;e==="column"?(a=l.columnMetadataMap,s=l.lastMeasuredColumnIndex,i=l.recalcColumnIndices):(a=l.rowMetadataMap,s=l.lastMeasuredRowIndex,i=l.recalcRowIndices);const f=i.length>0;if(n>s){let P=0;if(s>=0){const A=a[s];P=A.offset+A.size}for(let A=s+1;A<=n;A++){let R=f?i.includes(A)?r(A)*d:a[A]?.size||r(A)*d:r(A)*d;a[A]={offset:P,size:R},P+=R}e==="column"?l.lastMeasuredColumnIndex=n:l.lastMeasuredRowIndex=n}return a[n],a[n]},qn=({itemType:e,itemSize:n,itemCount:r,instanceProps:l,offset:d,scale:a})=>{let s,i;e==="column"?(s=l.columnMetadataMap,i=l.lastMeasuredColumnIndex):(s=l.rowMetadataMap,i=l.lastMeasuredRowIndex);let f=0;return f=(i>0?s[i].offset:0)>=d?io({itemType:e,itemSize:n,instanceProps:l,high:i,low:0,offset:d,scale:a}):yo({itemType:e,itemSize:n,itemCount:r,instanceProps:l,index:Math.max(0,i),offset:d,scale:a}),f=Math.min(f,r),f},io=({itemType:e,itemSize:n,instanceProps:r,high:l,low:d,offset:a,scale:s})=>{for(;d<=l;){const i=d+Math.floor((l-d)/2),f=tn({itemType:e,itemSize:n,index:i,instanceProps:r,scale:s}).offset;if(f===a)return i;f<a?d=i+1:f>a&&(l=i-1)}return d>0?d-1:0},yo=({itemType:e,itemSize:n,itemCount:r,instanceProps:l,index:d,offset:a,scale:s})=>{let i=1;for(;d<r&&tn({itemType:e,itemSize:n,index:d,instanceProps:l,scale:s}).offset<a;)d+=i,i*=2;return io({itemType:e,itemSize:n,instanceProps:l,high:Math.min(d,r-1),low:Math.floor(d/2),offset:a,scale:s})},Eo=e=>{const{rowCount:n,columnCount:r,defaultRowHeight:l,getRowHeight:d,defaultColumnWidth:a,getColumnWidth:s}=e||{},i=o.useRef({columnMetadataMap:{},rowMetadataMap:{},lastMeasuredColumnIndex:-1,lastMeasuredRowIndex:-1,recalcColumnIndices:[],recalcRowIndices:[]}),f=L(k=>qn({itemType:"row",itemCount:n,itemSize:d??(()=>l??20),instanceProps:i.current,offset:k}),[n,d,l]),P=L(k=>k===-1?0:tn({itemType:"row",index:k,itemSize:d??(()=>l??20),instanceProps:i.current}).offset,[d,l]),A=L(k=>tn({itemType:"row",index:k,itemSize:d??(()=>l??20),instanceProps:i.current}).size,[d,l]),R=L(k=>qn({itemType:"column",itemCount:r,itemSize:s??(()=>a??75),instanceProps:i.current,offset:k}),[r,s,a]),T=L(k=>k===-1?0:tn({itemType:"column",index:k,itemSize:s??(()=>a??75),instanceProps:i.current}).offset,[s,a]),$=L(k=>tn({itemType:"column",index:k,itemSize:s??(()=>a??75),instanceProps:i.current}).size,[s,a]),[Y,q]=o.useReducer(k=>k+1,0),J=()=>({getRowOffset:P,getColOffset:T,getRowIndex:f,getColIndex:R}),[ye,G]=o.useState(()=>e?J():null);return o.useEffect(()=>{G(e?J():null)},[Y,n,r,a,l,A,$]),ye},so="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ~`!@#$%^&*()-_=+[{]};:'\",<.>/?|\\",Nn=e=>{if(!e)return null;if(e.eventType==="start")return{type:e.eventType};if(e.eventType==="submit")return{type:e.eventType};if(e.eventType==="cancel")return{type:e.eventType};if(e.eventType==="keyboard")return{type:e.eventType,key:e.event.key};if(e.eventType==="pointer")return{type:e.eventType};if(e.eventType==="coordsChange"){const n={type:e.eventType};return e.activeCoords&&(n.activeCoords=e.activeCoords),n}return{type:e.eventType??"unknown"}},Io=e=>!0,Ro=e=>!!e&&!(e.ctrlKey||e.metaKey||e.altKey||e.isComposing)&&(!(e.shiftKey||e.key!=="F2"&&e.key!==" "&&e.key!=="Backspace")||(!e.shiftKey||e.key!==" ")&&so.indexOf(e.key)!==-1),ko=e=>!!e&&e.type==="dblclick"&&{editMode:!0},Mo=e=>{const{session:n,refLatestCoords:r,handleSubmitEdit:l,handleCancelEdit:d,cellBounds:a,isInBounds:s,getCellEditor:i,propsEditor:f,borderStrokeFill:P="rgb(33, 115, 70)",borderStrokeWidth:A=2,alignment:R=dn.Left,style:T,...$}=e,Y=o.useRef(null),q=o.useRef(null),[J,ye]=o.useState(!1),G=n.coords,k=o.useCallback(async ge=>{if(Y.current?.getBoundingClientRect()){if(ge.eventType==="keyboard"){const ee=ge.event,X=new KeyboardEvent(ee.type,{bubbles:!0,cancelable:!0,view:window,key:ee.key,code:ee.code,location:ee.location,repeat:ee.repeat,isComposing:ee.isComposing,charCode:ee.charCode,keyCode:ee.keyCode,which:ee.which,ctrlKey:ee.ctrlKey,shiftKey:ee.shiftKey,altKey:ee.altKey,metaKey:ee.metaKey});X.isSynthetic=!0,X.key,q.current?.dispatchEvent(X)}else ge.eventType==="pointer"||console.warn("unsupported event type",ge);await new Promise(ee=>requestAnimationFrame(ee))}},[]);o.useEffect(()=>{const ge=q.current;return ye(!0),q.current.startEdit?.(n.startEvent),(async()=>{n.editorRefs.push(ge),n.editorRefsDispatchEditorEvent.push(k);const ee=[...n.events];for(let X=0;X<ee.length;X++)await k(ee[X]);n.onMount(ge)})(),()=>{const ee=n.editorRefs.indexOf(ge);ee!==-1&&n.editorRefs.splice(ee,1),n.onUnmount(ge)}},[]);const V=o.useCallback(()=>l(n),[]),fe=o.useCallback(()=>{d(n)},[]),M=r.current&&W.isEqualCells(r.current,G),ce=s&&M&&J,je=i({autoFocus:!!n.startEvent?.autoFocus,...f,onSubmitEdit:V,onCancelEdit:fe,ref:q},G),ke=a.x+Q.boundPixel(-A/2),Ve=Q.boundPixel(a.width+A/2,!0);return re.jsx("div",{tabIndex:0,ref:Y,style:{background:void 0,...T,opacity:ce?T?.opacity??1:0,pointerEvents:"auto",position:"absolute",boxSizing:"border-box",top:`${a.y+Q.boundPixel(-A/2)}px`,height:Q.boundPixel(a.height+A/2,!0),left:`${ke}px`,width:Ve},...$,children:re.jsx("div",{className:"editor-container",style:{position:"absolute",boxSizing:"border-box",left:`${Q.boundPixel(1)}px`,top:`${Q.boundPixel(1)}px`,width:Q.boundPixel(a.width-2,!0),height:Q.boundPixel(a.height-2,!0),outline:`${A}px ${P} solid`,boxShadow:"rgba(60,64,67,.35) 2px 2px 6px 3px",maxHeight:"100%",overflow:"hidden",display:"flex"},children:je})})},rr=e=>{const{view:n,canEdit:r=Io,getCellEditor:l,onBeforeStartEdit:d,onStartEdit:a,onSubmitEdit:s,onCancelEdit:i,onDoneEdit:f,isEditorStartKeyEvent:P=Ro,isEditorStartPointerEvent:A=ko,containerProps:R,borderStrokeFill:T,borderStrokeWidth:$=2,getRangeCoords:Y=null,activeCoords:q,alignment:J=dn.Left}=e,[ye,G]=o.useState(!1),[k,V]=o.useState(void 0),fe=L((O,S,Re,le,me,Be)=>{if(!S)return null;const tt=me?.(S,O),St=O.getRangeCoordsBounds(tt),nt=O.toClipBounds(St),Vt=St,ht=O.getZoom();if(!nt)return null;Re&&(Re*=ht),le&&(le*=ht);let v=Vt,ie=!1;if(Re!==void 0){let _e={...tt},Zt=0;for(;!ie&&v.width<=Re&&Zt<20;){Zt++,Zt>19&&console.warn("max width reached");const Nt=O.getTotalRangeCoords(),It=O.getLayout();Be===dn.Left?_e.colEnd+1<Nt.colEnd?_e.colEnd=It.getColIndex(v.x+Re):ie=!0:Be===dn.Right?_e.colStart-1>=0?_e.colStart=It.getColIndex(v.x-(Re-v.width)):ie=!0:Be===dn.Center&&_e.colEnd+1<Nt.colEnd&&_e.colStart-1>=0?(_e.colStart=It.getColIndex(v.x-(Re-v.width)/2),_e.colEnd=It.getColIndex(v.x+v.width+(Re-v.width)/2)):ie=!0,ie||(v=O.getRangeCoordsBounds(_e))}}v.height=Vt.height,le!==void 0&&(v.height=Math.max(le+1,Vt.height));const{width:Xe,height:at}=O.getViewportSize();return{x:v.x??0,y:v.y??0,height:Math.min(at-v.y,v.height)+1,width:Math.min(Xe-v.x,v.width)+1}},[J]),M=L(r,[r]),ce=o.useCallback(()=>{n?.getStage()?.focus()},[n]),je=o.useRef(null),ke=L(O=>{d?.(O),z(),G(!0),je.current=null},[d]),Ve=L(O=>{a?.(O.coords)},[a]),ge=L(O=>{O.isSubmitted||O.isCancelled||(m.current.isEditorClosed=!0,ce(),O.isCancelled=!0,i?.(O.coords),z())},[i]),ee=L(O=>{if(O.isSubmitted||O.isCancelled)return!1;try{return je.current=O.coords,O.isEditorClosing=!0,O.isSubmitted=!0,O.isEditorSubmitted||(O.isEditorSubmitted=!0,O.editorRefs[0]?.submitEdit?.()),O.coords,s?.(O.coords),O.isEditorClosed=!0,ce(),z(),!0}catch(S){throw O.isEditorClosing=!1,O.isSubmitted=!1,S}},[s]),X=L(O=>{G(!1),f?.(O.coords),z()},[f]),m=o.useRef(null),qe=o.useRef(null),Ne=o.useRef(null),oe=o.useRef([]),[Ee,Z]=o.useReducer(O=>O+1,0),z=o.useCallback(O=>{O&&oe.current.push(O),Z()},[]),K=L(O=>{if(O.defaultPrevented||O.isSynthetic||!n)return;const S=n?.getCellCoordsFromClient(O.clientX,O.clientY);S&&z({eventType:"pointer",event:O,coords:S})},[n]),yt=L(O=>{const S=O.nativeEvent;K(S)},[n]),vt=L(O=>{if(O.defaultPrevented||O.isSynthetic||!n?.getStage())return;const S=qe.current;P(O,S)&&(O.stopPropagation(),O.preventDefault()),O.key,z({eventType:"keyboard",event:O,coords:S})},[n]);o.useLayoutEffect(()=>{const O=(le,me)=>{const Be=me?.cell??le;if(!Be)return null;const tt=Be;if(!M(Be))return null;ke?.(Be);const St=jt.uuidV4();me=Object.freeze({autoFocus:!0,...me}),Ne.current=Be;const nt={coords:tt,startEvent:me,uuid:St,isMounted:!1,isStarted:!1,isSubmitted:!1,isEditorSubmitted:!1,isEditorClosing:!1,isEditorClosed:!1,isCancelled:!1,events:[],editorRefsDispatchEditorEvent:[],editorRefs:[],onMount:Vt=>{nt.isMounted||(nt.isMounted=!0,z())},onUnmount:Vt=>{if(nt.editorRefs.length===0){const ht=()=>{nt.isMounted=!1,z()};if(document.activeElement!==document.body)ht();else{const v=ie=>{ie.defaultPrevented||ie.target!==document.body||vt(ie)};window.addEventListener("keydown",v,!0),n.getStage()?.addEventListener("focusin",()=>{window.removeEventListener("keydown",v),ht()},{once:!0}),ce()}}}};return nt};if(oe.current.length<=0&&!m.current)return;const S=oe.current[0];Nn(S),(le=>{const me=[],Be=le?.length??0;for(let tt=0;tt<Be;tt++){const St=le[tt];me.push(Nn(St))}})(oe.current),m.current,m.current;let Re=m.current;if(m.current){if(m.current.isDone)m.current=null;else if(m.current.isSubmitted||m.current.isCancelled){if(m.current.isMounted)return;m.current.isDone||(X(m.current),m.current.isDone=!0)}}if(S){if(S.eventType==="start"){const le=S,me=le.startEvent?.cell??qe.current;m.current&&W.isEqualCells(m.current.coords,me)||(m.current=O(me,le.startEvent))}else if(S.eventType==="keyboard"){const le=S.event;if(m.current){let me=!1;switch(le.which){case Pt.Left:case Pt.Right:case Pt.Up:case Pt.Down:case Pt.Enter:case Pt.Tab:me=!0}if(!me){m.current.events.push(S);for(let Be=0;Be<m.current.editorRefsDispatchEditorEvent.length;Be++)m.current.editorRefsDispatchEditorEvent[Be](S)}}else if(P(le,S.coords)){const Be=O(qe.current,void 0);Be&&Be.events.push(S),m.current=Be}}else if(S.eventType==="pointer"){const le=S.event;if(m.current){m.current.events.push(S);for(let me=0;me<m.current.editorRefsDispatchEditorEvent.length;me++)m.current.editorRefsDispatchEditorEvent[me](S)}else{const me=S?.coords??qe.current,Be=A(le,me);if(Be){let tt;typeof tt!="boolean"&&(tt=Be);const St=O(me,tt);St&&St.events.push(S),m.current=St}}}else if(S.eventType==="submit"){if(m.current&&!m.current.isSubmitted&&!m.current.isCancelled){if(!m.current.isMounted)return;ee(m.current)}}else if(S.eventType==="cancel"){if(m.current&&!m.current.isSubmitted&&!m.current.isCancelled){if(!m.current.isMounted)return;ge(m.current)}}else if(S.eventType==="coordsChange"){const le=S;if(qe.current=le.activeCoords,m.current,m.current&&!m.current.isSubmitted&&!m.current.isCancelled){if(!m.current.isMounted)return;try{ee(m.current)}catch{}}}}oe.current.length>0&&(oe.current.shift(),z()),oe.current.length===0&&(!m.current||m.current.isEditorClosing||m.current.isEditorClosed?!m.current&&Re&&ce():m.current.isMounted&&!m.current.isStarted&&(m.current.isStarted=!0,m.current.startEvent.autoFocus&&(typeof m.current.startEvent.autoFocus=="string"?m.current.editorRefs[0]?.autoFocus(m.current.startEvent.autoFocus):m.current.editorRefs[0]?.autoFocus()),Ve?.(m.current),requestAnimationFrame(()=>{n&&m.current?.coords&&n.scrollCellCoordsIntoView(m.current.coords)})))},[Ee]),o.useEffect(()=>{Ne.current=q;const O=m.current?.coords;W.isEqualCells(O,q)||(m.current&&(m.current.isEditorClosing=!0),z({eventType:"coordsChange",activeCoords:q}))},[q]);const ut=o.useCallback(O=>{vt(O.nativeEvent)},[]),{width:ct=0,height:we=0}=k??{width:0,height:0},At=L(l,[l]);return{overlay:L(O=>{if(!m.current||m.current.isEditorClosed)return m.current,null;m.current.coords;let S=fe(O,m.current.coords,ct,we,Y,J),Re=!0;S&&S.width!==0&&S.height!==0||(S={x:0,y:0,width:ct,height:ct},Re=!1);const le=O.getZoom(),me={containerBounds:{x:0,y:0,width:S.width/le,height:S.height/le},setNaturalDimensions:V,zoom:le};return re.jsx(Mo,{session:m.current,refLatestCoords:Ne,handleSubmitEdit:ee,handleCancelEdit:ge,cellBounds:S,borderStrokeWidth:$,borderStrokeFill:T,isInBounds:Re,getCellEditor:At,propsEditor:me,alignment:J,...R},"editor:"+m.current.uuid)},[l,Y,Ee,ct,we,J,$,T]),startEdit:o.useCallback(O=>{z({eventType:"start",startEvent:O})},[]),submitEdit:o.useCallback(()=>{z({eventType:"submit"})},[]),cancelEdit:o.useCallback(()=>{z({eventType:"cancel"})},[]),onKeyboardEvent:ut,onPointerEvent:yt,onKeyboardEventNative:vt,onPointerEventNative:K,isEditing:ye}};var Po=function(){},co=typeof window<"u",To=co?o.useLayoutEffect:o.useEffect,Yn={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};const ao=co&&window.ResizeObserver!==void 0?function(){var e=o.useState(null),n=e[0],r=e[1],l=o.useState(Yn),d=l[0],a=l[1],s=o.useMemo(function(){return new window.ResizeObserver(function(i){if(i[0]){var f=i[0].contentRect,P=f.x,A=f.y,R=f.width,T=f.height,$=f.top,Y=f.left,q=f.bottom,J=f.right;a({x:P,y:A,width:R,height:T,top:$,left:Y,bottom:q,right:J})}})},[]);return To(function(){if(n)return s.observe(n),function(){s.disconnect()}},[n]),[r,d]}:function(){return[Po,Yn]},Oo=3,zo=.1,Do=50,$n=e=>({x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,left:e.left,right:e.right,bottom:e.bottom});function Lo(e={}){const{threshold:n=zo,stillnessThreshold:r=Oo,maxHierarchyDepth:l=Do}=e,[d,a]=ao(),s=o.useRef(null),[i,f]=o.useReducer(Y=>Y+1,0),P=o.useRef(void 0),A=o.useRef({x:0,y:0,width:0,height:0,top:0,left:0,right:0,bottom:0}),R=o.useCallback(Y=>{s.current=Y,typeof d=="function"&&d(Y)},[d]),[T,$]=o.useState(a);return o.useEffect(()=>{a&&!T&&$(a)},[a,T]),o.useEffect(()=>{const Y=s.current;if(!Y)return;let q=!1,J=0;const ye=()=>{if(!Y)return;const M=Y.getBoundingClientRect(),ce=A.current;Math.abs(M.x-ce.x)>n||Math.abs(M.y-ce.y)>n||Math.abs(M.width-ce.width)>n||Math.abs(M.height-ce.height)>n?(q||(q=!0,$($n(M)),f()),J=0):J++,q&&J>=r&&(q=!1,$($n(M)),f()),A.current=$n(M),P.current=requestAnimationFrame(ye)};P.current=requestAnimationFrame(ye);const G=M=>{q=!0,f()},k=M=>{q=!1,J=r,f()};let V=Y;const fe=[];for(;V&&V!==document.documentElement&&(V.addEventListener("animationstart",G,!0),V.addEventListener("animationend",k,!0),V.addEventListener("transitionstart",G,!0),V.addEventListener("transitionend",k,!0),fe.push(V),V=V.parentElement,!(fe.length>l)););return()=>{P.current&&cancelAnimationFrame(P.current),fe.forEach(M=>{M.removeEventListener("animationstart",G,!0),M.removeEventListener("animationend",k,!0),M.removeEventListener("transitionstart",G,!0),M.removeEventListener("transitionend",k,!0)})}},[i,a,n,r,l]),[R,T]}const lr=({gridRef:e,gridMainRef:n,orientation:r=Wt.Row,headerCount:l,selectionPolicy:d="multiple",newSelectionMode:a="clear",alwaysScrollToActiveCoords:s=!0,onDragStart:i,onDragEnd:f,pointerDownInterceptor:P,pointerMoveInterceptor:A,onPointerUp:R,newSelection:T,modifySelection:$,appendSelection:Y,clearSelections:q})=>{const J=l??((r===Wt.Row?e.current?.rowCount:e.current?.columnCount)||0),ye=o.useRef(null),G=o.useRef(null),k=o.useRef(!1),V=o.useRef(null),fe=o.useCallback(X=>r===Wt.Column?{rowIndex:0,colIndex:X.colIndex}:{rowIndex:X.rowIndex,colIndex:0},[r]),M=o.useCallback(X=>r===Wt.Column?{rowIndex:n.current?n.current.rowCount-1:0,colIndex:X.colIndex}:{rowIndex:X.rowIndex,colIndex:n.current?n.current.columnCount-1:0},[r]),ce=X=>{G.current=M(X),$(G.current,ye.current)},je=o.useCallback((X,m)=>{if(!e.current)return;const qe=e.current.getViewFromClient(X,m)?.getCellCoordsFromClient(X,m);return qe?(r===Wt.Column?qe.rowIndex=n.current.getViewport().rowStart:qe.colIndex=n.current.getViewport().colStart,qe):void 0},[]),ke=o.useCallback((X,m=!1)=>{let qe=X;return m||(qe={...X},r===Wt.Row?delete qe.colIndex:delete qe.rowIndex),n.current?.scrollCellCoordsIntoView(qe)},[r]),Ve=L(f,[f]),ge=L(i,[i]),ee=o.useMemo(()=>({onPointerDown:X=>{if(!e||!e.current||X.nativeEvent.defaultPrevented)return;const m=je(X.nativeEvent.clientX,X.nativeEvent.clientY);if(!m)return;X.nativeEvent.which;const qe=X.nativeEvent.shiftKey,Ne=X.nativeEvent.ctrlKey||X.nativeEvent.metaKey;if(P?.(X,m)===!1)return;ge?.(),k.current=!0;const oe=n.current?.getViewFromClient(X.nativeEvent.clientX,X.nativeEvent.clientY),Ee=((Z,z)=>r===Wt.Column?{...Z,rowIndex:z.rowStart}:{...Z,colIndex:z.colStart})(m,oe.getVisibleRangeCoords());if(qe)ce(m);else{if(Ne)return((Z,z=Z,K)=>{ye.current=fe(Z),G.current=M(z),Y(ye.current,G.current,K)})(m,m,Ee),void(s&&ke(Ee,!0));((Z,z=Z,K)=>{ye.current=fe(Z),G.current=M(z),T(ye.current,G.current,K)})(m,m,Ee),ce(m),s&&ke(Ee,!0)}},onPointerMoveOrWait:jt.throttle(X=>{if(!k.current||!e?.current)return;const m=je(X.clientX,X.clientY);if(m&&A?.(X,m)!==!1){if(W.isEqualCells(V.current,m))return q();ce(m),ke(m)}},60),onPointerUp:X=>{k.current=!1,Ve?.(),R?.(X)},processTouch:!0,consumeTouch:!0}),[d,s,J,a,q,P,R]);return{onPointerDown:L(nn(ee),[]),getCellCoordsFromClient:je}},We=(e,n,r)=>{if(!e)return n;let l=n;const d=r===x.Right||r===x.Down;for(;;){const a=e(l,!d);if(a===0)return l;d?l+=a:l-=a}},Sn=(e,n,r)=>{const l=[];let d=n;for(;d<=r;){const a=Math.max(0,e(d));a===0?(l.push(d),d++):d+=a}return l},$o=(e,n,r,l,d,a)=>{if(!n)return a;let{rowIndex:s,colIndex:i}=e;switch(l){case x.Down:{s=We(r,Math.min(s+1,a),l);let f=n({rowIndex:s,colIndex:i});for(;!f&&s<a;)s=We(r,Math.min(++s,a),l),f=n({rowIndex:s,colIndex:i});return s}case x.Up:{s=We(r,Math.max(s-1,a),l);let f=n({rowIndex:s,colIndex:i});for(;!f&&s>a;)s=We(r,Math.max(--s,a),l),f=n({rowIndex:s,colIndex:i});return s}case x.Right:{i=We(r,Math.min(i+1,a),l);let f=n({rowIndex:s,colIndex:i});for(;!f&&i<a;)i=We(r,Math.min(++i,a),l),f=n({rowIndex:s,colIndex:i});return i}case x.Left:{i=We(r,Math.max(i-1,a),l);let f=n({rowIndex:s,colIndex:i});for(;!f&&i>a;)i=We(r,Math.max(--i,a),l),f=n({rowIndex:s,colIndex:i});return i}default:return a}},Ao=(e,n=()=>!0,r,l,d,a)=>{let{rowIndex:s,colIndex:i}=e;switch(l){case x.Down:{s=We(r,Math.min(s+1,a),l);let f=n?.({rowIndex:s,colIndex:i});for(;f&&s<a;)s=We(r,Math.min(++s,a),l),f=n?.({rowIndex:s,colIndex:i});return n?.({rowIndex:s,colIndex:i})?s:s-1}case x.Up:{s=We(r,Math.max(s-1,a),l);let f=n?.({rowIndex:s,colIndex:i});for(;f&&s>a;)s=We(r,Math.max(--s,a),l),f=n?.({rowIndex:s,colIndex:i});return n?.({rowIndex:s,colIndex:i})?s:s+1}case x.Right:{i=We(r,Math.min(i+1,a),l);let f=n?.({rowIndex:s,colIndex:i});for(;f&&i<a;)i=We(r,Math.min(++i,a),l),f=n?.({rowIndex:s,colIndex:i});return n?.({rowIndex:s,colIndex:i})?i:i-1}case x.Left:{i=We(r,Math.max(i-1,a),l);let f=n?.({rowIndex:s,colIndex:i});for(;f&&i>a;)i=We(r,Math.max(--i,a),l),f=n?.({rowIndex:s,colIndex:i});return n?.({rowIndex:s,colIndex:i})?i:i+1}default:return null}},Fo=(e,n,r,l,d,a)=>{if(!n)return a;let s,{rowIndex:i,colIndex:f}=e;l===x.Down?s={rowIndex:i+1,colIndex:f}:l===x.Up?s={rowIndex:i-1,colIndex:f}:l===x.Right?s={rowIndex:i,colIndex:f+1}:l===x.Left&&(s={rowIndex:i,colIndex:f-1});const P=n(e),A=n(s);var R,T;return(T=A,!(R=P)&&!T||!R&&T||R&&!T?$o:Ao)(e,n,r,l,!1,a)??a},Kn=(e,n)=>`${e}:${n}`,Gn=(e,n,r,l,d,a)=>{if(r-n>=d-l)return l;let s=l;return e==="nearest"&&(l-n>0?e="start":r-d>0&&(e="end")),e==="start"?s=n:e==="end"?s=r-(d-l):e==="center"&&(s=n+(r-n)/2-(d-l)/2),Math.max(0,Math.min(s,a-(d-l)))},Xn=(e,n,r,l)=>(console.log("todo: implement convertToVisibleRanges"),e),jn=(e,n=x.Right,r,l,d,a=null)=>{if(a&&W.isEqualSelectionCoords(a,e))return e;const s=e.ranges[e.rangeIndex];if(!W.isRangesIntersect({rowStart:e.cell.rowIndex,colStart:e.cell.colIndex,rowEnd:e.cell.rowIndex,colEnd:e.cell.colIndex},s))return e;let i={...e.cell},f=e.rangeIndex;switch(n){case x.Right:i.colIndex=We(d,i.colIndex+1,n);break;case x.Left:i.colIndex=We(d,i.colIndex-1,n);break;case x.Down:i.rowIndex=We(l,i.rowIndex+1,n);break;case x.Up:i.rowIndex=We(l,i.rowIndex-1,n)}const P=T=>{if(T){f=e.rangeIndex>=e.ranges.length-1?0:e.rangeIndex+1;const $=e.ranges[f];i={colIndex:$.colStart,rowIndex:$.rowStart}}else{f=e.rangeIndex<=0?e.ranges.length-1:e.rangeIndex-1;const $=e.ranges[f];i={colIndex:$.colEnd,rowIndex:$.rowEnd}}};if(n===x.Right&&i.colIndex>s.colEnd&&i.rowIndex===s.rowEnd)P(!0);else if(n===x.Left&&i.colIndex<s.colStart&&i.rowIndex===s.rowStart)P(!1);else if(n===x.Down&&i.colIndex===s.colEnd&&i.rowIndex>s.rowEnd)P(!0);else if(n===x.Up&&i.colIndex===s.colStart&&i.rowIndex<s.rowStart)P(!1);else{let T=i.rowIndex,$=i.colIndex;switch(n){case x.Right:$>s.colEnd&&(T=We(l,T+1,n),$=s.colStart,T>s.rowEnd&&(T=s.rowStart));break;case x.Left:$<s.colStart&&(T=We(l,T-1,n),$=s.colEnd,T<s.rowStart&&(T=s.rowEnd));break;case x.Down:T>s.rowEnd&&($=We(d,$+1,n),T=s.rowStart,$>s.colEnd&&($=s.colStart));break;case x.Up:T<s.rowStart&&($=We(d,$-1,n),T=s.rowEnd,$<s.colStart&&($=s.colEnd))}i={rowIndex:T,colIndex:$}}let A=r(i);if(!W.isRangeWithinRange(A,s)){const T=W.intersectRanges(A,s);T&&(A=T)}let R={rowStart:We(l,A.rowStart,x.Down),colStart:We(d,A.colStart,x.Right),rowEnd:We(l,A.rowEnd,x.Up),colEnd:We(d,A.colEnd,x.Left)};if(R.rowStart!==i.rowIndex||R.colStart!==i.colIndex){switch(n){case x.Right:e.ranges[f].colStart===R.colStart&&e.ranges[f].colEnd===R.colEnd&&(i.rowIndex=R.rowEnd),i.colIndex=R.colEnd;break;case x.Left:e.ranges[f].colStart===R.colStart&&e.ranges[f].colEnd===R.colEnd&&(i.rowIndex=R.rowStart),i.rowIndex===R.rowStart?i.colIndex=R.colStart+1:i.colIndex=R.colStart;break;case x.Down:e.ranges[f].rowStart===R.rowStart&&e.ranges[f].rowEnd===R.rowEnd&&(i.colIndex=R.colEnd),i.rowIndex=R.rowEnd;break;case x.Up:e.ranges[f].rowStart===R.rowStart&&e.ranges[f].rowEnd===R.rowEnd&&(i.colIndex=R.colStart),i.colIndex===R.colStart?i.rowIndex=R.rowStart+1:i.rowIndex=R.rowStart}return jn({cell:i,ranges:e.ranges,rangeIndex:f},n,r,l,d,a??e)}return{ranges:e.ranges,cell:i,rangeIndex:f}},_n=(e,n)=>{let r,l=0,d=0;return n.colStart<e.colStart?(r=x.Left,l=e.colStart-n.colStart,d=n.colStart):n.colEnd>e.colEnd?(r=x.Right,l=n.colEnd-e.colEnd,d=n.colEnd):n.rowStart<e.rowStart?(r=x.Up,l=e.rowStart-n.rowStart,d=n.rowStart):n.rowEnd>e.rowEnd&&(r=x.Down,l=n.rowEnd-e.rowEnd,d=n.rowEnd),{direction:r,amount:l,index:d}},En=(e,n=!1,r,l)=>{if(!r)return 0;const d=!n,a=d?1:-1;let s=r(d?e:e+1),i=r(d?e+1:e),f=e+(d?2:-1),P=0;for(;(i-s)*a<=0;){if(d&&f-1>l+1||!d&&f+1<l)return P;s=i,i=r(f),f+=a,P++}return P},Zn=(e,n,r,l,d)=>{const a={};let s=null,i=null;for(let f=0;f<=r.length&&r[f]<=d;f++){const P=r[f];if(P<l)continue;const A=s===P?i:n?e.getColOffset(P):e.getRowOffset(P),R=n?e.getColOffset(P+1):e.getRowOffset(P+1);s=P+1,i=R,a[P]=Object.freeze({offset:A,size:R-A,spanIndex:f})}return Object.freeze(a)},Qn=(e,n,r)=>{const l=e.getColOffset(n.colStart)+(r?.left??0),d=e.getRowOffset(n.rowStart)+(r?.top??0);return{x:l,y:d,width:e.getColOffset(n.colEnd+1)+(r?.right??0)-(r?.left??0)-l,height:e.getRowOffset(n.rowEnd+1)+(r?.bottom??0)-(r?.top??0)-d}},Wo=(e,n,r)=>!!r&&!(e<r.x||e>r.x+r.width)&&!(n<r.y||n>r.y+r.height),An=(e,n=!0)=>`M ${Q.boundPixel(e.left)} ${Q.boundPixel(e.top)} L ${Q.boundPixel(e.right,!0)} ${Q.boundPixel(e.top)} L ${Q.boundPixel(e.right,!0)} ${Q.boundPixel(e.bottom,!0)} L ${Q.boundPixel(e.left)} ${Q.boundPixel(e.bottom,!0)} L ${Q.boundPixel(e.left)} ${Q.boundPixel(e.top)} ${n?"Z":""}`,Jn=e=>{const{linePoints:n,bounds:r,pathProps:l,style:d,...a}=e;return re.jsx("svg",{width:`${Q.boundPixel(r.width,!0)}`,height:`${Q.boundPixel(r.height,!0)}`,viewBox:`0 0 ${Q.boundPixel(r.width,!0)} ${Q.boundPixel(r.height,!0)}`,style:{position:"absolute",left:`${Q.boundPixel(r.x)}px`,top:`${Q.boundPixel(r.y)}px`,width:`${Q.boundPixel(r.width,!0)}px`,height:`${Q.boundPixel(r.height,!0)}px`,pointerEvents:"none",transitionTimingFunction:"linear",transitionDelay:"0",transitionProperty:"left, top, width, height",willChange:"left, top, width, height, stroke-dashoffset",...d},...a,children:re.jsx("path",{d:`M ${Q.boundPixel(n[0])} ${Q.boundPixel(n[1])} L ${Q.boundPixel(n[2])} ${Q.boundPixel(n[3])}`,fill:"none",vectorEffect:"non-scaling-stroke",stroke:"black",...l})})},jo=e=>{const{x:n=0,y:r=0,width:l=0,height:d=0,fill:a,stroke:s,strokeWidth:i=0,strokeDasharray:f,strokeDashoffset:P,clipPath:A,pathBounds:R,pathProps:T,style:$,...Y}=e,q=r,J=n,ye=l,G=d;let k=null;if(a){let V=An({top:0,left:0,bottom:G,right:ye});R&&(V=V+" "+An({top:R.y-q,left:R.x-J,bottom:R.height+R.y-q,right:R.width+R.x-J})),k=[re.jsx("path",{d:V,fill:a,stroke:"none",fillRule:"evenodd"},"fill")]}return re.jsxs("svg",{width:`${Q.boundPixel(l,!0)}`,height:`${Q.boundPixel(d,!0)}`,viewBox:`0 0 ${Q.boundPixel(l,!0)} ${Q.boundPixel(d,!0)}`,preserveAspectRatio:"none",style:{position:"absolute",left:`${Q.boundPixel(n)}px`,top:`${Q.boundPixel(r)}px`,pointerEvents:"none",transitionDuration:"0ms",transitionTimingFunction:"linear",transitionDelay:"0",transitionProperty:"left, top, width, height",willChange:"left, top, width, height, stroke-dashoffset",boxShadow:"rgb(60 64 67 / 5%) 0px 1px 4px 2px, rgb(255 255 255 / 15%) 0px 0px 2px 1px",overflow:"visible",...$},...Y,children:[k,re.jsx("path",{d:An({top:0,left:0,right:ye,bottom:G}),fill:"none",strokeDasharray:f,strokeDashoffset:P,stroke:s,vectorEffect:"non-scaling-stroke",strokeWidth:i,...T})]})},Vo=e=>{const{key:n,...r}=e;return re.jsx(uo,{...r},n)},uo=o.memo(e=>{const{stroke:n,fill:r,x:l=0,y:d=0,width:a=0,height:s=0,style:i,isAnimatedStroke:f,animatedStrokeProps:P,range:A,cell:R,...T}=e,$=f||!!P,Y={name:"walking-offset",dashGap:2,speed:50,dashLength:8,...P};let q=Y.dashGap+Y.dashLength;const J=Y.speed*q,ye=Co().replaceAll(":",""),G=`${Y.name}-${ye}`;let k;return o.useEffect(()=>{if(!$)return;const V=`@keyframes ${G} {
      to {
        stroke-dashoffset: 0px;
      }
    }`,fe=document.createElement("style");return fe.appendChild(document.createTextNode(V)),document.head.appendChild(fe),fe.sheet.insertRule(V,0),()=>{document.head.removeChild(fe)}},[$]),$&&(k={strokeDasharray:`${Y.dashLength}px ${Y.dashGap}px`,strokeDashoffset:`${q}px`,animation:`${G} ${J}ms linear infinite`,willChange:"stroke-dashoffset"}),re.jsx(jo,{x:l,y:d,width:a,height:s,stroke:n,fill:r,shapeRendering:"crispEdges",style:{...k,...i},...T})});function ho(e){var n,r,l="";if(typeof e=="string"||typeof e=="number")l+=e;else if(typeof e=="object")if(Array.isArray(e)){var d=e.length;for(n=0;n<d;n++)e[n]&&(r=ho(e[n]))&&(l&&(l+=" "),l+=r)}else for(r in e)e[r]&&(l&&(l+=" "),l+=r);return l}function _t(){for(var e,n,r=0,l="",d=arguments.length;r<d;r++)(e=arguments[r])&&(n=ho(e))&&(l&&(l+=" "),l+=n);return l}uo.displayName="Selection";const fo=o.memo(o.forwardRef((e,n)=>{const{x:r=0,y:l=0,borderWidth:d=1,size:a=6,borderStroke:s,corner:i,style:f,className:P,background:A,...R}=e;if(r===0||l===0)return null;let T=!0,$=!0,Y=!0,q=!0;switch(i){case"tl":T=!1,$=!1;break;case"bl":T=!1,q=!1;break;case"br":Y=!1,q=!1;break;case"tr":$=!1,Y=!1}return re.jsx("div",{className:_t("fill-handle",P),style:{position:"absolute",left:r-(a+(T?d:0))/2,top:l-(a+($?d:0))/2,width:a,height:a,borderLeft:T?`${d}px ${s}`:void 0,borderTop:$?`${d}px ${s}`:void 0,borderRight:Y?`${d}px ${s}`:void 0,borderBottom:q?`${d}px ${s}`:void 0,background:A,cursor:"crosshair",pointerEvents:"all",transitionDuration:"0ms",transitionTimingFunction:"linear",transitionDelay:"0",transitionProperty:"left, top",willChange:"left, top",...f},tabIndex:-1,...R})}));function Fn(e,n){if(typeof e=="function")return e(n);e&&(e.current=n)}fo.displayName="FillHandle";var Bo=parseInt(o.version.split(".")[0],10)>=19?function(e){return n=>{const r=[];for(const l of e){const d=Fn(l,n),a=typeof d=="function";r.push(a?d:()=>Fn(l,null))}return()=>{for(const l of r)l()}}}:function(e){return n=>{for(const r of e)Fn(r,n)}};const Uo=Q.detectIt().supportsTouchEvents,Vn=o.memo(o.forwardRef((e,n)=>{const{range:r,view:l,anchor:d,borderStroke:a="rgb(33, 115, 70)",background:s="white",borderWidth:i=1.5,size:f=22,style:P,className:A,selectionTouchPointerHandler:R,onTouchSelectStart:T,onTouchSelectEnd:$,currentTouchAnchor:Y,scrollableElement:q,scrollableRoot:J,...ye}=e;if(!Uo)return null;const G=L(T,[T]),k=L($,[$]),{bounds:V,coordsPivot:fe,key:M}=o.useMemo(()=>{if(!r||!l)return null;let Ee=null,Z=null;switch(d){case"tl":Ee={colIndex:r.colEnd,rowIndex:r.rowEnd},Z={colIndex:r.colStart,rowIndex:r.rowStart};break;case"br":Ee={colIndex:r.colStart,rowIndex:r.rowStart},Z={colIndex:r.colEnd,rowIndex:r.rowEnd};break;case"t":case"l":Ee={colIndex:r.colEnd,rowIndex:r.rowEnd};break;case"b":Ee={colIndex:r.colStart,rowIndex:r.rowStart};break;case"r":Ee={colIndex:r.colStart,rowIndex:r.rowEnd}}let z=l.getRangeCoordsBounds(Z?{rowStart:Z.rowIndex,colStart:Z.colIndex,rowEnd:Z.rowIndex,colEnd:Z.colIndex}:r);const K=l.getBounds(),yt=l.getViewportSize(),vt=K.x,ut=K.y,ct=yt.width,we=yt.height;switch(d){case"tl":break;case"br":z.x=z.x+z.width,z.y=z.y+z.height;break;case"t":z.x=ct/2-vt;break;case"b":z.x=ct/2-vt,z.y=z.y+z.height;break;case"l":z.y=we/2-ut;break;case"r":z.x=z.x+z.width,z.y=we/2-ut}const At=l.toClipBounds(z,0);return!At||At.width<=0||At.height<=0||z.x<0||z.y<0||z.x>ct||z.y>we?{bounds:null,coordsAnchor:null,coordsPivot:null,key:null}:{bounds:z,coordsAnchor:null,coordsPivot:Ee,key:"touchSelect-"+l.getAnchor()+"-"+d}},[r,l,d]),ce=o.useRef(null),je=o.useMemo(()=>{const Ee=Z=>d==="t"||d==="b"?{...Z,colIndex:void 0}:d==="l"||d==="r"?{...Z,rowIndex:void 0}:Z;return{processTouch:!0,consumeTouch:!0,onPointerDown:(Z,z)=>{const K=Ee(l.getCellCoordsFromClient(Z.clientX,Z.clientY));return ce.current={coordsPivot:fe},G?.(d),R.onSelectionPointerDown(Z,z,l,K,fe,!1,!0)},onPointerMoveOrWait:(Z,z,K)=>{const yt=Ee(l.getCellCoordsFromClient(Z.clientX,Z.clientY));return R.onSelectionPointerMoveOrWait(Z,z,K,l,yt,ce.current?.coordsPivot,!0,!0)},onPointerUp:(Z,z,K)=>(ce.current=null,k?.(d),R.onPointerUp(Z,z,K))}},[R,r,l,d]),ke=nn(je),[Ve,{y:ge,x:ee}]=Lo(),X=o.useRef(null),{getPortalContainer:m,isFullscreen:qe}=lo(),[Ne,oe]=o.useState(null);return o.useEffect(()=>{const Ee=X.current?.getBoundingClientRect();if(!Ee||!V)return void oe(null);let Z=0,z=0,K=q;for(;K;)Z+=K.scrollLeft,z+=K.scrollTop,K=J&&K===J.parentElement?null:K.parentElement;oe(oo.createPortal(re.jsx("div",{className:_t("touch-select-handle",A),ref:n,style:{position:"absolute",left:Z+(Ee?.x??0)-(f+i)/2,top:z+(Ee?.y??0)-(f+i)/2,width:f,height:f,borderWidth:`${i}px`,border:a,borderRadius:"50%",background:s,boxShadow:`0 0 0 1.5px ${s}`,cursor:"grab",pointerEvents:"all",opacity:Y?0:1,transitionDuration:"160ms",transitionProperty:"opacity",...P},tabIndex:-1,onPointerDown:ke,...ye}),J??m(),M))},[ge,ee,V?.x,V?.y,V?.width,V?.height,A,Y,s,f,i,a,q,qe]),V?re.jsxs(re.Fragment,{children:[re.jsx("div",{ref:Bo([Ve,X]),style:{position:"absolute",left:V.x,top:V.y,opacity:0}}),Ne]}):null}));Vn.displayName="TouchSelectHandle";const $t=-10,Ho=Object.freeze({rowStart:0,colStart:0,rowEnd:0,colEnd:0}),go=Object.freeze({colIndex:0,rowIndex:0}),Bn=Object.freeze([]),Ot=e=>{if(e&&e.cell&&e.ranges&&e.rangeIndex>-1&&e.rangeIndex<=e.ranges.length)return e;const n={cell:null,ranges:e?.ranges??Bn};return n.rangeIndex=e?.rangeIndex??n.ranges.length-1,n.cell=e?.cell,!n.cell&&n.ranges.length>0&&(n.cell={rowIndex:n.ranges[n.rangeIndex].rowStart,colIndex:n.ranges[n.rangeIndex].colStart}),n.cell||(n.cell=go),W.isEqualSelectionCoords(n,e)?e:n},Cn=(e,n,r)=>{const l=e.getVisibleRangeCoords(),d=e.getScrollOrientation();!d.horizontal&&(n.colIndex>l.colEnd||n.colIndex<l.colStart)&&(n={...n,colIndex:n.colIndex>l.colEnd?l.colEnd+1:l.colEnd-1},e=r.current.getViewFromLocation(Ze.Center)),!d.vertical&&(n.rowIndex>l.rowEnd||n.rowIndex<l.rowStart)&&(n={...n,rowIndex:n.rowIndex>l.rowEnd?l.rowEnd+1:l.rowEnd-1},e=r.current.getViewFromLocation(Ze.Center)),e.scrollCellCoordsIntoView(n)},qo=()=>!1,ir=({gridRef:e,commands:n,layout:r,selection:l,onSelectionChange:d,onSelectionDragStart:a,onSelectionDragEnd:s,selectionPolicy:i="multiple",newSelectionMode:f="clear",allowDeselectSelection:P=!0,onFillPreview:A,onFillCancel:R,onFillDone:T,onFill:$,disableFillDrag:Y=!$,fillHandleBorderColor:q="white",hiddenRowsAt:J,hiddenColumnsAt:ye,isContentfulCell:G,contentfulCellFinder:k=Fo,getDataCoords:V,alwaysScrollToActiveCoords:fe=!1,selectionBounds:M,pointerDownInterceptor:ce,pointerMoveInterceptor:je,mergedRanges:ke,canSelectionSpanMergedCells:Ve=qo,onMoveDragStart:ge,onMoveDragUpdate:ee,onMoveDragEnd:X,onMoveDragDone:m,selectionRenderer:qe=Vo,disableMoveDrag:Ne=!X,getCellCoordsAsRangeCoords:oe=W.cellToRange,moveDragHitSize:Ee=6,moveDragOutlineSize:Z=4,selectionBackgroundColor:z="rgba(16, 124, 65, 0.1)",selectionBorderColor:K="rgb(33, 115, 70)",selectionRemoveBorderColor:yt="rgb(255, 0, 0)",selectionRemoveBackgroundColor:vt="rgba(250, 10, 10, 0.1)",disableTouchSelection:ut=!1,touchSelectHandleProps:ct})=>{const we=o.useCallback(()=>({top:M?.top??0,left:M?.left??0,bottom:e.current?.rowCount-1||0,right:e.current?.columnCount-1||0}),[]),At=L($,[$]),O=L(A,[A]),S=L(R,[R]),Re=L(T,[T]),le=L(G,[G]),me=L(qe,[qe]),Be=L((t,u=!1)=>En(t,u,r.getRowOffset,u?we().bottom:we().top),[r?.getRowOffset]),tt=L(J??Be,[J]),St=L((t,u=!1)=>En(t,u,r.getColOffset,u?we().right:we().left),[r?.getColOffset]),nt=L(ye??St,[ye]),[Vt,ht]=o.useState(()=>Ot(l)),v=o.useMemo(()=>Ot(Vt),[Vt]),ie=o.useRef(v),Xe=o.useRef(!0);o.useLayoutEffect(jt.throttle(()=>{ht(t=>{Xe.current=!0;const u=Ot(l);return W.isEqualSelectionCoords(u,t)?t:u})},0),[l]),o.useLayoutEffect(()=>{ie.current=v},[v]),o.useEffect(()=>{Xe.current||!d||W.isEqualSelectionCoords(l,v)||d(v)},[v]);const at=o.useCallback(t=>{ht(u=>{Xe.current=!1,u=Ot(u);let h=typeof t=="function"?t(u.ranges):t??Bn;if(W.isEqualRangesArrays(h,u.ranges))return u;let c=Math.max(h.length?0:-1,Math.min(u.rangeIndex,h.length-1)),w=u.cell;c===-1||W.isCellWithinRange(w,h[c])||(w={rowIndex:h[c].rowStart,colIndex:h[c].colStart}),h.length===1&&W.isSingleCell(h[0])&&W.isCellWithinRange(w,h[0])&&(h=[],c=-1);const I={cell:w,ranges:h,rangeIndex:c};return W.isEqualSelectionCoords(I,u)?u:I})},[]),_e=L(t=>{ht(u=>{Xe.current=!1,u=Ot(u);const h=t??go,c=oe(h);if(!W.isSingleCell(c)&&u.ranges.length===0)return{ranges:[c],rangeIndex:0,cell:h};if(W.isEqualCells(h,u.cell))return u;let w=u.ranges,I=u.rangeIndex;u.ranges.length===1&&(W.isSingleCell(u.ranges[0])&&W.isCellWithinRange(h,u.ranges[0])||!W.isCellWithinRange(h,u.ranges[0]))&&(w=[],I=-1);const p={ranges:w,rangeIndex:I,cell:h};return W.isEqualSelectionCoords(p,u)?u:p})},[oe]),[Zt,Nt]=o.useState(null),[It,on]=o.useState(null),qt=o.useRef(null),[Me,Ft]=o.useState(null),gt=o.useRef(null),zt=o.useRef(null),[un,Qt]=o.useState(null),Ue=o.useRef(null),Ae=o.useRef(null),Kt=o.useRef(ke);o.useEffect(()=>{Kt.current=ke},[ke]);const wt=L((t,u={inline:"nearest",block:"nearest"})=>{let{rowIndex:h,colIndex:c}=t;h===void 0&&v?.cell&&(h=v.cell.rowIndex),c===void 0&&v?.cell&&(c=v.cell.colIndex),h!==void 0&&c!==void 0&&e.current?.scrollCellCoordsIntoView({rowIndex:h,colIndex:c},u)},[v]),Bt=o.useCallback(t=>{const u=we();return t.rowIndex<u.top||t.colIndex<u.left||t.colIndex>u.right||t.rowIndex>u.bottom},[]),Pe=L((t,u)=>{if(!e?.current)return null;const h={rowStart:Math.min(t.rowIndex,u.rowIndex),colStart:Math.min(t.colIndex,u.colIndex),rowEnd:Math.max(t.rowIndex,u.rowIndex),colEnd:Math.max(t.colIndex,u.colIndex)};if(Ve?.(h))return h;const c=oe(t),w=oe(u),I={rowStart:Math.min(c.rowStart,w.rowStart),colStart:Math.min(c.colStart,w.colStart),rowEnd:Math.max(c.rowEnd,w.rowEnd),colEnd:Math.max(c.colEnd,w.colEnd)};let p;return typeof Kt.current=="function"?p=Kt.current(I):ke&&(p=ke),p?W.extendRangeToUnionRanges(I,p):I},[Ve,oe]),Ye=L((t,u,h)=>{const c=t.ranges.length>0?t.ranges[t.rangeIndex]:{rowStart:t.cell.rowIndex,colStart:t.cell.colIndex,rowEnd:t.cell.rowIndex,colEnd:t.cell.colIndex},w={rowStart:Math.min(u.rowIndex??c.rowStart,h.rowIndex??c.rowStart),colStart:Math.min(u.colIndex??c.colStart,h.colIndex??c.colStart),rowEnd:Math.max(u.rowIndex??c.rowEnd,h.rowIndex??c.rowEnd),colEnd:Math.max(u.colIndex??c.colEnd,h.colIndex??c.colEnd)},I={rowIndex:w.rowStart,colIndex:w.colStart},p={rowIndex:w.rowEnd,colIndex:w.colEnd};if(!(Bt(I)||Bt(p)))return Pe(I,p)},[Pe]),dt=L((t,u,h)=>{if(i==="single"||!ie.current)return;const c=Ye(ie.current,t,u??ie.current.cell);if(!c)return;const w=ie.current.rangeIndex;at(I=>I.length?I.map((p,ne)=>w===ne?c:p):[c]),h&&c&&_e({colIndex:c.colStart,rowIndex:c.rowStart})},[]),bt=o.useCallback((t,u,h)=>{if(!ie.current)return;t={...ie.current?.cell,...t},u=u??t;const c=Ye(ie.current,t,u);if(!c)return;const w={rowIndex:c.rowStart,colIndex:c.colStart},I={...w,...h};f==="clear"?(Ue.current=I,Yt()):f==="modify"?dt(w):Te(w),_e(I)},[]),Te=o.useCallback((t,u=t,h)=>{i!=="multiple"||!t||Bt(t)||Bt(u)||ht(c=>{Xe.current=!1,c=Ot(c);const w=Pe(t,u);if(!w)return c;let I=c.ranges.length>0?[...c.ranges]:[Pe(c.cell,c.cell)];I.push(w);const p={ranges:I,cell:{rowIndex:w.rowStart,colIndex:w.colStart,...h},rangeIndex:I.length-1};return W.isEqualSelectionCoords(p,c)?c:p})},[]),Yt=()=>{at(Bn)},Rt=Q.detectIt().primaryInput==="touch",Qe=o.useRef(null),Ct=o.useRef(null),kt=o.useRef(null),Jt=o.useMemo(()=>({onPointerDown:t=>{if(!e||!e.current)return!1;const u=t.nativeEvent,h=e.current.getViewFromClient(u.clientX,u.clientY);if(u.pointerType==="touch"||u.type==="touchstart")return Ct.current={topLeft:h.getScrollTopLeft(),point:{x:u.clientX,y:u.clientY}},!0;const c=h.getCellCoordsFromClient(t.nativeEvent.clientX,t.nativeEvent.clientY);if(!c)return!1;Qe.current={anchor:h.getAnchor(),coords:c},Ae.current=null;const w=t.nativeEvent.which===Hn.Right;if(w&&W.indexOfCoords(c,v.ranges)!==-1)return!1;const I=t.nativeEvent.shiftKey,p=t.nativeEvent.ctrlKey||t.nativeEvent.metaKey,ne=p,B=P,U=v.ranges.length>0,te=p&&B;if(ce?.(t,c,v)===!1)return!1;a?.(ie.current,t.nativeEvent);const be=!w&&i!=="single";if(I)return dt(c),be;const N=W.isEqualCells(c,v.cell);if(ne){if(N&&(!te||!U))return be;if(p&&W.indexOfCoords(c,v.ranges)!==-1&&B){gt.current=c;const H=Pe(c,c);return zt.current=H,Ft(H),be}return Te(c),be}fe&&wt(c),N&&v.ranges.length===0||bt(c)},onPointerMoveOrWait:jt.throttle((t,u)=>{if(!e?.current||t.pointerType==="touch"||t.type==="touchmove"||!Qe.current)return;const h=Qe.current.anchor;let c=e.current.getViewFromLocation(h),w=c.getCellCoordsFromClient(t.clientX,t.clientY);if(!W.isEqualCells(w,Qe.current?.coords)&&(Qe.current={anchor:h,coords:w},w&&je?.(t,w,ie.current)!==!1)){if(gt.current){const I={rowStart:Math.min(w.rowIndex,gt.current.rowIndex),colStart:Math.min(w.colIndex,gt.current.colIndex),rowEnd:Math.max(w.rowIndex,gt.current.rowIndex),colEnd:Math.max(w.colIndex,gt.current.colIndex)},p={rowIndex:I.rowStart,colIndex:I.colStart},ne={rowIndex:I.rowEnd,colIndex:I.colEnd};if(Bt(p)||Bt(ne))return;const B=Pe(p,ne);zt.current=B,Ft(B)}else dt(w);kt.current=u,Cn(c,w,e)}},60),onPointerUp:t=>{if(Qe.current=null,t.pointerType==="touch"||t.type==="touchend"){if(Ct.current){const h=e.current.getViewFromClient(Ct.current.point.x,Ct.current.point.y),c=h.getScrollTopLeft();if(c.left===Ct.current.topLeft.left&&c.top===Ct.current.topLeft.top){const w=h.getCellCoordsFromClient(Ct.current.point.x,Ct.current.point.y);bt(w)}}return Ct.current=null,void(Qe.current=null)}try{s?.(ie.current,t)}catch(h){console.warn(h)}if(!gt.current)return;const u=zt.current;gt.current=null,zt.current=null,Ft(null),ht(h=>{if(Xe.current=!1,(h=Ot(h)).ranges.length===0)return h;let c=[],w=-1,I=h.cell;for(let ne=0;ne<h.ranges.length;ne++){const B=h.ranges[ne];if(W.isRangesIntersect(B,u)){const U=jt.subtractRect({top:B.rowStart,left:B.colStart,bottom:B.rowEnd+1,right:B.colEnd+1},{top:u.rowStart,left:u.colStart,bottom:u.rowEnd+1,right:u.colEnd+1});for(let te=0;te<U.length;te++){const be={rowStart:U[te].top,colStart:U[te].left,rowEnd:U[te].bottom-1,colEnd:U[te].right-1};c.push(be),W.isCellWithinRange(h.cell,be)&&(w=c.length-1)}}else c.push(B);c.length>0&&w===-1&&W.isCellWithinRange(h.cell,B)&&(w=c.length-1,I={rowIndex:c[c.length-1].rowStart,colIndex:c[c.length-1].colStart})}const p={cell:I,rangeIndex:w,ranges:c};return W.isEqualSelectionCoords(p,h)?h:p})},processTouch:!0,consumeTouch:!1}),[v,i,P,fe,f]),In=L(nn(Jt),[]),Rn=o.useMemo(()=>({onSelectionPointerDown:(t,u,h,c,w=v.cell,I=fe,p=t.nativeEvent.shiftKey,ne=!1)=>{if(!e||!e.current)return!1;t.stopPropagation(),t.preventDefault(),t.nativeEvent.stopImmediatePropagation();const B=h??e.current.getViewFromClient(t.nativeEvent.clientX,t.nativeEvent.clientY),U=c??B.getCellCoordsFromClient(t.nativeEvent.clientX,t.nativeEvent.clientY);if(!U)return!1;Qe.current={anchor:B.getAnchor(),coords:U},Ae.current=null;const te=t.nativeEvent.which===Hn.Right;if(te&&W.indexOfCoords(U,v.ranges)!==-1)return!1;const be=t.nativeEvent.ctrlKey||t.nativeEvent.metaKey,N=be,H=P,st=v.ranges.length>0,E=be&&H;if(ce?.(t,U,v)===!1)return!1;a?.(ie.current,t.nativeEvent);const pe=!te&&i!=="single";if(p)return dt(U,w,ne),pe;const mt=W.isEqualCells(U,w);if(N){if(mt&&(!E||!st))return pe;if(E&&W.indexOfCoords(U,v.ranges)!==-1&&H){gt.current=U;const xe=Pe(U,U);return zt.current=xe,Ft(xe),pe}return Te(U),pe}I&&wt(U),mt&&v.ranges.length===0||bt(U)},onSelectionPointerMoveOrWait:(t,u,h,c,w,I=v.cell,p=!0,ne=!1)=>{if(!e?.current||(t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation(),!Qe.current))return;const B=Qe.current.anchor;let U=c??e.current.getViewFromLocation(B),te=w??U.getCellCoordsFromClient(t.clientX,t.clientY);if(!W.isEqualCells(te,Qe.current?.coords)&&(Qe.current={anchor:B,coords:te},te&&je?.(t,te,ie.current)!==!1)){if(gt.current){const be={rowStart:Math.min(te.rowIndex,gt.current.rowIndex),colStart:Math.min(te.colIndex,gt.current.colIndex),rowEnd:Math.max(te.rowIndex,gt.current.rowIndex),colEnd:Math.max(te.colIndex,gt.current.colIndex)},N={rowIndex:be.rowStart,colIndex:be.colStart},H={rowIndex:be.rowEnd,colIndex:be.colEnd};if(Bt(N)||Bt(H))return;const st=Pe(N,H);zt.current=st,Ft(st)}else dt(te,I,ne);p&&Cn(U,te,e)}},onPointerUp:t=>{Qe.current=null,t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation();try{s?.(ie.current,t)}catch(h){console.warn(h)}if(!gt.current)return;const u=zt.current;gt.current=null,zt.current=null,Ft(null),ht(h=>{if(Xe.current=!1,(h=Ot(h)).ranges.length===0)return h;let c=[],w=-1,I=h.cell;for(let ne=0;ne<h.ranges.length;ne++){const B=h.ranges[ne];if(W.isRangesIntersect(B,u)){const U=jt.subtractRect({top:B.rowStart,left:B.colStart,bottom:B.rowEnd+1,right:B.colEnd+1},{top:u.rowStart,left:u.colStart,bottom:u.rowEnd+1,right:u.colEnd+1});for(let te=0;te<U.length;te++){const be={rowStart:U[te].top,colStart:U[te].left,rowEnd:U[te].bottom-1,colEnd:U[te].right-1};c.push(be),W.isCellWithinRange(h.cell,be)&&(w=c.length-1)}}else c.push(B);c.length>0&&w===-1&&W.isCellWithinRange(h.cell,B)&&(w=c.length-1,I={rowIndex:c[c.length-1].rowStart,colIndex:c[c.length-1].colStart})}const p={cell:I,rangeIndex:w,ranges:c};return W.isEqualSelectionCoords(p,h)?h:p})}}),[v,i,P,fe,f]),et=L((t,u=!1,h=!1,c=0)=>{if(!e.current||!v.cell)return;let w=v.cell,I=v.cell;if(u&&v.ranges.length>0){const E=v.ranges[v.rangeIndex],pe=v.cell;switch(t){case x.Up:I={rowIndex:pe.rowIndex===E.rowStart?E.rowEnd:E.rowStart,colIndex:E.colEnd},w={rowIndex:pe.rowIndex===E.rowStart?E.rowStart:E.rowEnd,colIndex:E.colStart};break;case x.Down:I={rowIndex:pe.rowIndex===E.rowEnd?E.rowStart:E.rowEnd,colIndex:E.colEnd},w={rowIndex:pe.rowIndex===E.rowEnd?E.rowEnd:E.rowStart,colIndex:E.colStart};break;case x.Left:I={rowIndex:E.rowEnd,colIndex:pe.colIndex===E.colStart?E.colEnd:E.colStart},w={rowIndex:E.rowStart,colIndex:pe.colIndex===E.colStart?E.colStart:E.colEnd};break;case x.Right:I={rowIndex:E.rowEnd,colIndex:pe.colIndex===E.colEnd?E.colStart:E.colEnd},w={rowIndex:E.rowStart,colIndex:pe.colIndex===E.colEnd?E.colEnd:E.colStart}}}const p=oe(I);let{rowStart:ne,colStart:B}=p;const U=we();if(Ae.current)switch(t){case x.Up:case x.Down:Ae.current.colIndex>=p.colStart&&Ae.current.colIndex<=p.colEnd&&(B=Ae.current.colIndex);break;case x.Left:case x.Right:Ae.current.rowIndex>=p.rowStart&&Ae.current.rowIndex<=p.rowEnd&&(ne=Ae.current.rowIndex)}if(!c){switch(t){case x.Up:ne=We(tt,Math.max(p.rowStart-1,U.top),t);break;case x.Down:ne=We(tt,Math.min(p.rowEnd+1,U.bottom),t);break;case x.Left:B=We(nt,Math.max(p.colStart-1,U.left),t);break;case x.Right:B=We(nt,Math.min(p.colEnd+1,U.right),t)}if(h)switch(t){case x.Up:ne=k({...I,colIndex:v.cell.colIndex},le,tt,t,!1,Math.max(U.top,tt(U.top,!1)));break;case x.Down:ne=k({...I,colIndex:v.cell.colIndex},le,tt,t,!1,Math.min(U.bottom,U.bottom-tt(U.bottom,!0)));break;case x.Left:B=k({...I,rowIndex:v.cell.rowIndex},le,nt,t,!1,Math.max(U.left,nt(U.left,!1)));break;case x.Right:B=k({...I,rowIndex:v.cell.rowIndex},le,nt,t,!1,Math.min(U.right,U.right-nt(U.right,!0)))}}let te=null;if(c){let E=0;switch(t){case x.Up:E=r.getRowOffset(ne+1),ne=Math.max(U.top,r.getRowIndex(E-c)),te={top:r.getRowOffset(ne+1)-(E-e.current.getScrollPosition().top)};break;case x.Down:E=r.getRowOffset(ne),ne=Math.min(U.bottom,r.getRowIndex(E+c)),te={top:r.getRowOffset(ne)-(E-e.current.getScrollPosition().top)};break;case x.Left:E=r.getColOffset(B+1),B=Math.max(U.left,r.getColIndex(E-c)),te={left:r.getColOffset(B+1)-(E-e.current.getScrollPosition().left)};break;case x.Right:E=r.getColOffset(B),B=Math.min(U.right,r.getColIndex(E+c)),te={left:r.getColOffset(B)-(E-e.current.getScrollPosition().left)}}}const be={rowIndex:ne,colIndex:B},N=oe(be),H={rowIndex:N.rowStart,colIndex:N.colStart};u||(Ae.current=be);const st=W.isEqualCells(Ue.current,H)&&W.isEqualCells(Ue.current,w);if(u&&!st?dt(H,w):bt(H),te)e.current.scrollTo(te);else{if(u&&Ue.current){const E=we();if(t===x.Right&&Ue.current.colIndex===E.left||t===x.Left&&Ue.current.colIndex===E.right||t===x.Up&&Ue.current.rowIndex===E.bottom||t===x.Down&&Ue.current.rowIndex===E.top)return}t===x.Left||t===x.Right?wt({colIndex:be.colIndex}):t!==x.Up&&t!==x.Down||wt({rowIndex:be.rowIndex})}},[v,oe]),Ut=L(t=>{if(!e.current)return;if(v.ranges.length===0)return void et(t);const u=oe(v.cell);if(W.isEqualRangesArrays([u],v.ranges))return void et(t);const h=jn(v,t,oe,tt,nt);ht(c=>{Xe.current=!1,c=Ot(c);const w={...c,cell:h.cell,rangeIndex:h.rangeIndex};return W.isEqualSelectionCoords(w,c)?c:w}),h.cell&&wt(h.cell)},[v,oe]),kn=o.useCallback(()=>{const t=we();dt({rowIndex:t.top},{rowIndex:t.bottom})},[]),Mn=o.useCallback(()=>{const t=we();dt({colIndex:t.left},{colIndex:t.right})},[]),Gt=L(()=>{v.cell&&e?.current&&wt(v.cell)},[v.cell]),hn=o.useCallback((t=!1)=>{const u={rowIndex:we().top};t?dt(u):bt(u),wt(u)},[]),fn=o.useCallback((t=!1)=>{const u={rowIndex:we().bottom};t?dt(u):bt(u),wt(u)},[]),rn=o.useCallback((t=!1)=>{const u={colIndex:we().left};t?dt(u):bt(u),wt(u)},[]),en=o.useCallback((t=!1)=>{const u=we(),h={rowIndex:u.top,colIndex:u.left};t?dt(h):bt(h),wt(h)},[]),ln=o.useCallback((t=!1)=>{const u=we(),h={colIndex:V?.()?.colEnd??u.right};t?dt(h):bt(h),wt(h)},[V]),Xt=o.useCallback((t=!1)=>{const u=we(),h={rowIndex:V?.()?.rowEnd??u.bottom,colIndex:V?.()?.colEnd??u.right};t?dt(h):bt(h),wt(h)},[V]),sn=L(t=>{if(!e.current||v.ranges.length<=1)return;const u=t===x.Left||t===x.Up;let h=v.rangeIndex+(u?-1:1);h<0?h=v.ranges.length-1:h>v.ranges.length-1&&(h=0);const c=v.ranges[h],w=jn({cell:{rowIndex:c.rowEnd,colIndex:c.colEnd},rangeIndex:0,ranges:[c]},x.Right,oe,tt,nt);ht(I=>{Xe.current=!1,I=Ot(I);const p={...I,cell:w.cell,rangeIndex:h};return W.isEqualSelectionCoords(p,I)?I:p}),w.cell&&wt(w.cell)},[v,oe]),Pn=L(()=>{const t=Xn(v);ht(u=>{Xe.current=!1,u=Ot(u);const h={...u,visibleSelection:t};return W.isEqualSelectionCoords(h,u)?u:h}),t.cell&&wt(t.cell)},[v,oe]),Tn=L(()=>{if(!e.current||v.ranges.length===0)return;const t=v.cell,u=v.ranges[v.rangeIndex],h=Xn({cell:t,rangeIndex:0,ranges:[u]}),c=h.ranges[h.rangeIndex];let w;w=c.rowStart===t.rowIndex&&c.colStart===t.colIndex?{rowIndex:c.rowStart,colIndex:c.colEnd}:c.rowStart===t.rowIndex&&c.colEnd===t.colIndex?{rowIndex:c.rowEnd,colIndex:c.colStart}:c.rowEnd===t.rowIndex&&c.colStart===t.colIndex?{rowIndex:c.rowEnd,colIndex:c.colEnd}:{rowIndex:c.rowStart,colIndex:c.colStart},ht(I=>{I=Ot(I);const p={...I,cell:w};return W.isEqualSelectionCoords(p,I)?I:p}),w&&wt(w)},[v,oe]),gn=o.useCallback((t=!1)=>{et(x.Down,t,!1,e.current.getDimensions().containerHeight)},[]),Dt=o.useCallback((t=!1)=>{et(x.Up,t,!1,e.current.getDimensions().containerHeight)},[]),wn=o.useCallback((t=!1)=>{et(x.Right,t,!1,e.current.getDimensions().containerWidth)},[]),cn=o.useCallback((t=!1)=>{et(x.Left,t,!1,e.current.getDimensions().containerWidth)},[]),xn=o.useCallback(()=>{Ut(x.Left)},[]),pn=o.useCallback(()=>{Ut(x.Right)},[]),On=o.useCallback(()=>{Ut(x.Up)},[]),zn=o.useCallback(()=>{Ut(x.Down)},[]),an=o.useCallback(()=>{sn(x.Left)},[]),Dn=o.useCallback(()=>{sn(x.Right)},[]),Ln=o.useCallback(()=>{Tn()},[]),mn=o.useCallback(()=>{et(x.Left,!1,!1)},[]),g=o.useCallback(()=>{et(x.Left,!0,!1)},[]),b=o.useCallback(()=>{et(x.Left,!1,!0)},[]),D=o.useCallback(()=>{et(x.Left,!0,!0)},[]),y=o.useCallback(()=>{et(x.Right,!1,!1)},[]),C=o.useCallback(()=>{et(x.Right,!0,!1)},[]),F=o.useCallback(()=>{et(x.Right,!1,!0)},[]),_=o.useCallback(()=>{et(x.Right,!0,!0)},[]),se=o.useCallback(()=>{et(x.Up,!1,!1)},[]),de=o.useCallback(()=>{et(x.Up,!0,!1)},[]),j=o.useCallback(()=>{et(x.Up,!1,!0)},[]),Se=o.useCallback(()=>{et(x.Up,!0,!0)},[]),Ke=o.useCallback(()=>{et(x.Down,!1,!1)},[]),Oe=o.useCallback(()=>{et(x.Down,!0,!1)},[]),De=o.useCallback(()=>{et(x.Down,!1,!0)},[]),He=o.useCallback(()=>{et(x.Down,!0,!0)},[]),Ie=o.useCallback(()=>{at(t=>t.slice(0,-1))},[]),xt=o.useMemo(()=>{const t=we();return((u,h,c,w,I)=>{for(let p=0;p<u.length;p++){const ne=u[p];if(ne.rowStart===h&&ne.colStart===c&&ne.rowEnd===w&&ne.colEnd===I)return!0}return!1})(v.ranges,t.top,t.left,t.bottom,t.right)},[M,v.ranges]),rt=o.useCallback((t,u=!0)=>{Ue.current=t,_e(t),u&&t&&e?.current&&wt(t)},[]),$e=L((t=!0)=>{const u=qt.current;if(!ie.current?.cell)return;const h=ie.current?.ranges,c=ie.current?.cell;if(!c||!u||!u)return;let w=null;if(w=h.length>0?h[h.length-1]:oe(c),w.colEnd>=w.colStart&&w.rowEnd>=w.rowStart){const I=_n(w,u);let p=t?At:O;try{p?.(w,u,I.direction)}catch(ne){console.warn(ne)}finally{t&&Re?.()}}},[oe]),Ce=o.useRef(null),ot=o.useMemo(()=>({onPointerDown:(t,u)=>{if(kt.current=u,!e||!e.current)return!1;const h=e.current.getViewFromClient(t.nativeEvent.clientX,t.nativeEvent.clientY),c=h?.getCellCoordsFromClient(t.nativeEvent.clientX,t.nativeEvent.clientY);c&&(t.stopPropagation(),Nt("crosshair"),Ce.current={anchor:h.getAnchor(),coords:c})},onPointerMoveOrWait:(t,u)=>{if(Y||!e?.current||!ie.current||!Ce.current)return;const h=Ce.current.anchor;let c=e.current.getViewFromLocation(h),w=c.getCellCoordsFromClient(t.clientX,t.clientY);if(!w)return;Ce.current={anchor:h,coords:w};const I=ie.current.ranges;let p=Pe(ie.current.cell,w);if(!p)return;const ne=I.length>0,B=ne?I[I.length-1]:oe(ie.current.cell);if(!p)return;const U=p.rowStart<B.rowStart?x.Up:p.rowEnd>B.rowEnd?x.Down:p.colEnd>B.colEnd?x.Right:x.Left,te=we();U===x.Left&&(p={...B,colStart:Math.max(te.left,p.colStart)}),U===x.Up&&(p={...B,rowStart:Math.max(te.top,p.rowStart)}),U===x.Right&&(p={...B,colEnd:Math.min(te.right,p.colEnd)}),U===x.Down&&(p={...B,rowEnd:Math.min(te.bottom,p.rowEnd)});const be=_n(B,p);if(!Ve?.(B)){let N;typeof Kt.current=="function"?N=Kt.current(B):ke&&(N=ke),p=((H,st,E,pe,mt,xe)=>{const he={...st};if(E.length===0)return he;if(mt===x.Left){const it=H.colEnd+1-H.colStart;he.colStart=H.colStart-Math.ceil(xe/it)*it,he.colStart<pe.left&&(he.colStart=he.colStart+Math.ceil((pe.left-he.colStart)/it)*it)}else if(mt===x.Right){const it=H.colEnd+1-H.colStart;he.colEnd=H.colEnd+Math.ceil(xe/it)*it,he.colEnd>pe.right&&(he.colEnd=he.colEnd-Math.ceil((pe.right-he.colEnd)/it)*it)}else if(mt===x.Up){const it=H.rowEnd+1-H.rowStart;he.rowStart=H.rowStart-Math.ceil(xe/it)*it,he.rowStart<pe.top&&(he.rowStart=he.rowStart+Math.ceil((pe.top-he.rowStart)/it)*it)}else if(mt===x.Down){const it=H.rowEnd+1-H.rowStart;he.rowEnd=H.rowEnd+Math.ceil(xe/it)*it,he.rowEnd>pe.bottom&&(he.rowEnd=he.rowEnd-Math.ceil((pe.bottom-he.rowEnd)/it)*it)}return he})(B,p,N,te,be.direction,be.amount)}if(ne&&W.isRangeWithinRange(p,B)&&(p=null),!W.isEqualRanges(p,qt.current)){if(on(p),qt.current=p,!p){try{S?.()}catch{}return void Re?.()}$e(!1)}kt.current=u,Cn(c,w,e)},onPointerUp:(t,u)=>{kt.current=u,Promise.resolve($e(!0)).finally(()=>{Re?.(),on(null),qt.current=null,Ce.current=null,Nt(null),e.current?.focus()})}}),[oe]),Mt=nn(ot),ve=o.useMemo(()=>({onPointerDown:Mt}),[Mt]),[Ge,Et]=o.useState(null),Fe=o.useRef(null),Je=o.useMemo(()=>({onPointerDown:(t,u)=>{if(kt.current=u,!e||!e.current)return!1;const h=e.current.getViewFromClient(t.nativeEvent.clientX,t.nativeEvent.clientY),c=h?.getCellCoordsFromClient(t.nativeEvent.clientX,t.nativeEvent.clientY);if(!c)return;if(ce?.(t,c,v)===!1)return!1;t.stopPropagation(),Nt("default");const w=h.getRelativePointFromClient(0,0),I=ie.current?.ranges[ie.current?.ranges.length-1]??W.cellToRange(ie.current?.cell),p=h.toClipBounds(h.getRangeCoordsBounds(I)),ne={x:0,y:0};p.x-w.x>t.nativeEvent.clientX?ne.x=t.nativeEvent.clientX-(p.x-w.x):t.nativeEvent.clientX>=p.x-w.x+p.width&&(ne.x=Math.max(0,t.nativeEvent.clientX-(p.x-w.x+p.width))+1),p.y-w.y>t.nativeEvent.clientY?ne.y=t.nativeEvent.clientY-(p.y-w.y):t.nativeEvent.clientY>=p.y-w.y+p.height&&(ne.y=Math.max(0,t.nativeEvent.clientY-(p.y-w.y+p.height))+1),ge?.(I,t.nativeEvent,u),Fe.current={range:I,anchor:h.getAnchor(),cell:c,isMoving:!1,extrusion:ne}},onPointerMoveOrWait:(t,u,h)=>{if(Ne||!e?.current||!ie.current||!Fe.current)return;const c=t.clientX-h.clientX,w=t.clientY-h.clientY;if(Fe.current.isMoving=Fe.current.isMoving||Math.abs(c)>Math.max(1,2)||Math.abs(w)>Math.max(1,2)||performance.now()-h.timeStamp>500,!Fe.current.isMoving)return;const I=Fe.current.anchor,p=Fe.current.extrusion;let ne=e.current.getViewFromLocation(I),B=ne.getCellCoordsFromClient(t.clientX-p.x,t.clientY-p.y,!0);if(!B)return;const U=Fe.current.cell,te=Fe.current.range,be=we(),N=te.colEnd-te.colStart+1,H=Math.min(Math.max(0,U.colIndex-te.colStart),N-1),st=Math.min(be.right-N+1,Math.max(be.left,B.colIndex-H)),E=te.rowEnd-te.rowStart+1,pe=Math.min(Math.max(0,U.rowIndex-te.rowStart),E-1),mt=Math.min(be.bottom-E+1,Math.max(be.top,B.rowIndex-pe)),xe={colStart:st,colEnd:st+N-1,rowStart:mt,rowEnd:mt+E-1};W.isEqualRanges(Ge,xe)&&!(he=>!he||!kt.current||kt.current.ctrlKey!==he.ctrlKey||kt.current.shiftKey!==he.shiftKey||kt.current.altKey!==he.altKey||kt.current.metaKey!==he.metaKey)(t)||(Et(xe),ee?.(xe,t,u)),kt.current=u,Cn(ne,B,e)},onPointerUp:(t,u)=>{kt.current=u;const h=()=>{Et(null),Fe.current=null,Nt(null),e.current?.focus()};if(!Fe.current)return void h();const c=Fe.current.range,w=Ge;X?.(c,t,u),Promise.resolve(c&&w&&m?.(c,w,t,u)).finally(()=>{h()})}}),[Ge]),Le=nn(Je),ze=o.useMemo(()=>({onPointerDown:Le}),[Le]),ft=o.useRef(null),lt=o.useMemo(()=>{const t=W.isEqualSelectionCoords(v,ft.current)?ft.current:v;return ft.current=t,t},[v]),pt=o.useCallback(t=>{let u=null,h="br";const c=[],w={stroke:q,fill:z,strokeWidth:.5},I=(N,H,st)=>{const E=t.toClipBounds(t.getRangeCoordsBounds(N),$t);if(!E)return;E.x=E.width>0?E.x:E.x-w.strokeWidth/2,E.y=E.height>0?E.y:E.y-w.strokeWidth/2,E.width=Math.max(E.width,w.strokeWidth),E.height=Math.max(E.height,w.strokeWidth);const pe={key:`selection-fill-${H}`,range:N,...E,...w};if(st){const mt=t.getCellCoordsAsRangeCoords(st);pe.cell=st,pe.pathBounds=t.toClipBounds(t.getRangeCoordsBounds(mt),$t),pe.pathBounds&&(pe.pathBounds.width<=0||pe.pathBounds.height<=0)&&(delete pe.pathBounds,delete pe.cell)}return me(pe)};let p=v?Ot(v):null;const ne=p?.cell?t.getCellCoordsAsRangeCoords(p?.cell):Ho;!p||p.ranges&&p.ranges.length!==0||(p={ranges:[ne],rangeIndex:0,cell:p.cell});for(let N=0;p&&N<p.ranges.length;N++){const H=p.ranges[N],st=I(H,N,N===p.rangeIndex?p.cell:null);st&&c.push(st);const E=2,pe=.5,mt=t.toClipBounds(t.getRangeCoordsBounds(H,{top:0,left:0,right:0,bottom:0}),$t);if(mt){const xe=(p.ranges.length,4);c.push(me({range:H,key:`selection-inside-edge-${N}`,x:mt.x-1,y:mt.y-1,width:Math.max(mt.width+1,0),height:Math.max(mt.height+1,0),style:{overflow:"hidden"},stroke:q,strokeWidth:xe}))}if(p.ranges.length===1){const xe=t.toClipBounds(t.getRangeCoordsBounds(H),$t);if(xe){Ne||c.push(me({range:H,key:`move-selection-hit-box-${N}`,x:xe.width>1?xe.x:xe.x-(Ee/2+1),y:xe.height>1?xe.y:xe.y-(Ee/2+1),width:Math.max(xe.width+2,1),height:Math.max(xe.height+2,1),stroke:"transparent",style:{boxShadow:"none"},pathProps:{cursor:Ge?void 0:"move",pointerEvents:"stroke"},strokeWidth:Ee,...ze}));const he=E;c.push(me({range:H,key:`selection-single-${N}`,x:xe.x-he/2,y:xe.y-he/2,width:Math.max(xe.width+he/2,1),height:Math.max(xe.height+he/2,1),stroke:K,strokeWidth:he}))}}else{const xe=t.toClipBounds(t.getRangeCoordsBounds(H,{top:-1,left:-1,right:-2,bottom:-2}),$t);xe&&c.push(me({range:H,key:`selection-multi-${N}`,x:xe.width>1?xe.x:xe.x-pe/2,y:xe.height>1?xe.y:xe.y-pe/2,width:Math.max(xe.width,pe)+1,height:Math.max(xe.height,pe)+1,stroke:K,style:{overflow:"hidden"},strokeWidth:2}))}if(p.ranges.length>1&&N===p.rangeIndex){const xe=t.getCellCoordsAsRangeCoords(p.cell),he=t.toClipBounds(t.getRangeCoordsBounds(xe,{top:1,left:1,right:-1,bottom:-1}),$t);he&&c.push(me({range:H,key:`selection-anchor-${N}`,x:he.x,y:he.y,width:Math.max(he.width,pe),height:Math.max(he.height,pe),stroke:K,style:{overflow:"hidden"},strokeWidth:2}))}if(N===p.ranges.length-1){u=null,h=null;const xe=H.rowStart===we().top&&H.rowEnd===we().bottom,he=H.colStart===we().left&&H.colEnd===we().right,it=t.getRangeCoordsBounds(H);let Lt=null;if(xe||he){if(Lt=t.toClipBounds(it,$t),Object.keys(t.allViews()).length>1){const vn=t.getVisibleRangeCoords(),Un=t.allViews()[Ze.TopLeft],vo=t.allViews()[Ze.Top],bo=t.allViews()[Ze.Left],bn=t.getAnchor();(he&&(bn===Ze.Top&&Un||bn===Ze.Center&&bo||!W.isCellWithinRange({colIndex:H.colStart,rowIndex:H.rowEnd},vn)&&!W.isCellWithinRange({colIndex:H.colStart,rowIndex:H.rowEnd+1},vn))||xe&&(bn===Ze.Left&&Un||bn===Ze.Center&&vo||!W.isCellWithinRange({colIndex:H.colEnd,rowIndex:H.rowStart},vn)&&!W.isCellWithinRange({colIndex:H.colEnd+1,rowIndex:H.rowStart},vn)))&&(Lt=null)}}else Lt=t.toClipBounds(it,$t);if(!Lt||Lt.width===0||Lt.height===0)continue;u={x:Lt.x+Lt.width+1,y:Lt.y+Lt.height+1},Lt.width===0||Lt.height===0||H.rowStart===we().top&&H.colStart===we().left&&H.rowEnd===we().bottom&&H.colEnd===we().right||(xe?(u.y=E,h="tr"):he&&(u.x=E,h="bl"))}}let B=null;if(Me){const N=t.toClipBounds(t.getRangeCoordsBounds(Me,{top:0,left:0,right:0,bottom:0}),$t);N&&(B=me({...w,range:Me,key:"remove-selection",x:N.x,y:N.y,width:N.width,height:N.height,strokeWidth:2,stroke:yt,fill:vt}))}let U=null;if(It){const N=t.toClipBounds(t.getRangeCoordsBounds(It,{top:0,left:0,right:0,bottom:0}),$t);N&&(U=me({range:It,key:"selection-fill-outline",x:N.x-2/2,y:N.y-2/2,width:N.width+2/2,height:N.height+2/2,strokeWidth:2,stroke:K,strokeDasharray:"3 2"}))}let te=null;!Y&&u&&!Ge&&(te=o.createElement(fo,{...u,corner:h,size:7.5,borderStroke:`${q} solid`,style:{borderRadius:1},background:K,...ve,key:"fillHandle"}));const be=[...c];if(B&&be.push(B),U&&be.push(U),te&&be.push(te),!ut&&Rt&&p?.ranges.length===1&&p.ranges[p.ranges.length-1]){const N=p.ranges[p.ranges.length-1],H=N.rowStart===we().top&&N.rowEnd===we().bottom,st=N.colStart===we().left&&N.colEnd===we().right,E={view:t,range:N,borderStroke:`${K} solid`,background:q,selectionTouchPointerHandler:Rn,...ct,onTouchSelectStart:pe=>Qt(pe),onTouchSelectEnd:()=>Qt(null),currentTouchAnchor:un};be.push(re.jsx(Vn,{anchor:st?"b":H?"r":"br",scrollableElement:e.current,...E},"touch-select-handle-after")),be.push(re.jsx(Vn,{anchor:st?"t":H?"l":"tl",scrollableElement:e.current,...E},"touch-select-handle-before"))}if(Ge){const N=t.toClipBounds(t.getRangeCoordsBounds(Ge,{top:1,left:1,right:1,bottom:1}),$t);N&&be.push(me({range:Ge,key:"selection-move-outline",x:N.x-Z/2,y:N.y-Z/2,width:Math.max(N.width+Z/2,1),height:Math.max(N.height+Z/2,1),stroke:K,style:{boxShadow:"none",transitionDuration:"70ms",transitionTimingFunction:"ease-in",transitionProperty:"left, top, width, height",willChange:"left, top, width, height"},strokeWidth:Z}))}return re.jsx("div",{children:be},"selection")},[lt,Me,Y,It,Ne,Ge,we,q,K,z,yt,vt,ut,ct,un]),Tt=o.useMemo(()=>{const t=()=>e.current;return[new ae("moveToPageDown",t,{label:"Page Down",description:"Shift viewport down one page.",shortcut:[{key:"PageDown"}]},()=>gn(!1)),new ae("selectToPageDown",t,{label:"Select To Page Down",description:"Shift viewport and select down one page.",shortcut:[{key:"PageDown",modifiers:[ue.Shift]}]},()=>gn(!0)),new ae("moveToPageRight",t,{label:"Page Right",description:"Shift viewport right one page.",shortcut:[{key:"PageDown",modifiers:[ue.Alt]}]},()=>wn(!1)),new ae("selectToPageRight",t,{label:"Page Right",description:"Shift viewport right one page.",shortcut:[{key:"PageDown",modifiers:[ue.Alt,ue.Shift]}]},()=>wn(!0)),new ae("moveToPageUp",t,{label:"Page Up",description:"Shift viewport up one page.",shortcut:[{key:"PageUp"}]},()=>Dt(!1)),new ae("selectToPageUp",t,{label:"Page Up",description:"Shift viewport up one page.",shortcut:[{key:"PageUp",modifiers:[ue.Shift]}]},()=>Dt(!0)),new ae("moveToPageLeft",t,{label:"Page Left",description:"Shift viewport left one page.",shortcut:[{key:"PageUp",modifiers:[ue.Alt]}]},()=>cn(!1)),new ae("selectToPageLeft",t,{label:"Page Left",description:"Shift viewport left one page.",shortcut:[{key:"PageUp",modifiers:[ue.Alt,ue.Shift]}]},()=>cn(!0)),new ae("selectColumn",t,{label:"Select Column",description:"Select the columns for the selected cells.",shortcut:{key:"Space",modifiers:[ue.Ctrl]}},kn),new ae("selectRow",t,{label:"Select Row",description:"Select the rows for the selected cells.",shortcut:{key:"Space",modifiers:[ue.Shift]}},Mn),new ae("selectToColumnStart",t,{label:"Select To Column Start",description:"Select the columns to the beginning of the sheet."},()=>hn(!0)),new ae("selectToColumnEnd",t,{label:"Select To Column End",description:"Select the columns to the end of the sheet."},()=>fn(!0)),new ae("moveToRowStart",t,{label:"Move to Row Home",description:"Move to the beginning of the row.",shortcut:[{key:"Home"}]},()=>rn(!1)),new ae("selectToRowStart",t,{label:"Select to Row Home",description:"Select to the beginning of the row.",shortcut:[{key:"Home",modifiers:[ue.Shift]}]},()=>rn(!0)),new ae("moveToSheetStart",t,{label:"Move to Sheet Home",description:"Move to the beginning of the sheet.",shortcut:[{key:"Home",modifiers:[ue.Ctrl]}]},()=>en(!1)),new ae("selectToSheetStart",t,{label:"Select to Sheet Home",description:"Select to the beginning of the sheet.",shortcut:[{key:"Home",modifiers:[ue.Ctrl,ue.Shift]}]},()=>en(!0)),new ae("moveToRowEnd",t,{label:"Move to Row End",description:"Move to the end of the row.",shortcut:[{key:"End"}]},()=>ln(!1)),new ae("selectToRowEnd",t,{label:"Select to Row End",description:"Select to the end of the row.",shortcut:[{key:"End",modifiers:[ue.Shift]}]},()=>ln(!0)),new ae("moveToSheetEnd",t,{label:"Move to Sheet End",description:"Move to the end of the sheet.",shortcut:[{key:"End",modifiers:[ue.Ctrl]}]},()=>Xt(!1)),new ae("selectToSheetEnd",t,{label:"Select to Sheet End",description:"Select to the end of the sheet.",shortcut:[{key:"End",modifiers:[ue.Ctrl,ue.Shift]}]},()=>Xt(!0)),new ae("scrollToActiveCoords",t,{label:"Scroll to Active Cell",description:"Scroll to the Active Cell.",shortcut:{key:"Backspace",modifiers:[ue.Ctrl]}},Gt),new ae("scrollToActiveCoordsClearSelection",t,{label:"Scroll to Active Cell",description:"Scroll to the Active Cell and clear selection.",shortcut:{key:"Backspace",modifiers:[ue.Shift]}},()=>{Yt(),rt(v.cell,!0)}),new ae("traverseSelectionRight",t,{label:"Traverse Right",description:"Traverse the selection moving rightward.",shortcut:{key:"Tab"}},pn),new ae("traverseSelectionLeft",t,{label:"Traverse Left",description:"Traverse the selection moving leftward.",shortcut:{key:"Tab",modifiers:[ue.Shift]}},xn),new ae("traverseSelectionDown",t,{label:"Traverse Down",description:"Traverse the selection moving downward.",shortcut:[{key:"Enter"},{key:"NumpadEnter"}]},zn),new ae("traverseSelectionUp",t,{label:"Traverse Up",description:"Traverse the selection moving upward.",shortcut:[{key:"Enter",modifiers:[ue.Shift]},{key:"NumpadEnter",modifiers:[ue.Shift]}]},On),new ae("moveLeft",t,{label:"Move Left",description:"Move active cell to the left.",shortcut:[{key:"ArrowLeft"}]},mn),new ae("selectLeft",t,{label:"Select Left",description:"Extend selection left.",shortcut:[{key:"ArrowLeft",modifiers:[ue.Shift]}]},g),new ae("moveContentfulLeft",t,{label:"Move Left Contentful",description:"Move left to the next cell with content.",shortcut:[{key:"ArrowLeft",modifiers:[ue.Ctrl]}]},b),new ae("selectContentfulLeft",t,{label:"Select Left Contentful",description:"Extend selection left to the next cell with content.",shortcut:[{key:"ArrowLeft",modifiers:[ue.Ctrl,ue.Shift]}]},D),new ae("moveRight",t,{label:"Move Right",description:"Move active cell to the right.",shortcut:[{key:"ArrowRight"}]},y),new ae("selectRight",t,{label:"Select Right",description:"Extend selection right.",shortcut:[{key:"ArrowRight",modifiers:[ue.Shift]}]},C),new ae("moveContentfulRight",t,{label:"Move Right Contentful",description:"Move right to the next cell with content.",shortcut:[{key:"ArrowRight",modifiers:[ue.Ctrl]}]},F),new ae("selectContentfulRight",t,{label:"Select Right Contentful",description:"Extend selection right to the next cell with content.",shortcut:[{key:"ArrowRight",modifiers:[ue.Ctrl,ue.Shift]}]},_),new ae("moveUp",t,{label:"Move Up",description:"Move active cell to the up.",shortcut:[{key:"ArrowUp"}]},se),new ae("selectUp",t,{label:"Select Up",description:"Extend selection up.",shortcut:[{key:"ArrowUp",modifiers:[ue.Shift]}]},de),new ae("moveContentfulUp",t,{label:"Move Up Contentful",description:"Move up to the next cell with content.",shortcut:[{key:"ArrowUp",modifiers:[ue.Ctrl]}]},j),new ae("selectContentfulUp",t,{label:"Select Up Contentful",description:"Extend selection up to the next cell with content.",shortcut:[{key:"ArrowUp",modifiers:[ue.Ctrl,ue.Shift]}]},Se),new ae("moveDown",t,{label:"Move Down",description:"Move active cell to the down.",shortcut:[{key:"ArrowDown"}]},Ke),new ae("selectDown",t,{label:"Select Down",description:"Extend selection down.",shortcut:[{key:"ArrowDown",modifiers:[ue.Shift]}]},Oe),new ae("moveContentfulDown",t,{label:"Move Down Contentful",description:"Move down to the next cell with content.",shortcut:[{key:"ArrowDown",modifiers:[ue.Ctrl]}]},De),new ae("selectContentfulDown",t,{label:"Select Down Contentful",description:"Extend selection down to the next cell with content.",shortcut:[{key:"ArrowDown",modifiers:[ue.Ctrl,ue.Shift]}]},He),new ae("selectVisible",t,{label:"Select Visible",description:"Select visible cells only.",shortcut:{key:";",modifiers:[ue.Alt]}},Pn),new ae("traverseSelectionPreviousRange",t,{label:"Traverse Previous Range",description:"Traverse the selection to the previous range.",shortcut:{key:"ArrowLeft",modifiers:[ue.Ctrl,ue.Alt]}},an),new ae("traverseSelectionNextRange",t,{label:"Traverse Next Range",description:"Traverse the selection to the next range.",shortcut:{key:"ArrowRight",modifiers:[ue.Ctrl,ue.Alt]}},Dn),new ae("traverseSelectionCorners",t,{label:"Traverse Corners",description:"Traverse the selection through the corners of the selected range.",shortcut:{key:".",modifiers:[ue.Ctrl]}},Ln)]},[]);return o.useMemo(()=>{n?.addCommands(Tt,!0)},[n]),{selection:lt,setSelectionCell:rt,setSelectionRanges:at,overlay:pt,cursor:Zt,onPointerDown:In,clearLastSelection:Ie,newSelection:bt,modifySelection:dt,appendSelection:Te,clearSelections:Yt,isEntire:xt,navigate:et,navigateSelection:Ut}};function yn(e,n){if(!e)throw new Error("Invariant failed")}const eo={"sheetxl-grid":"_sheetxl-grid_h9wwa_7"},No=Object.freeze({top:0,left:0}),Yo=Object.freeze({bottom:-4,right:-4}),Ko=Object.freeze({horizontal:!0,vertical:!0}),to=[Ze.TopLeft,Ze.Top,Ze.Left,Ze.Center],Ht=3e3,Wn={},wo=o.memo(o.forwardRef((e,n)=>{const{width:r,height:l,rowCount:d=1,columnCount:a=1,defaultRowHeight:s,defaultColumnWidth:i,getRowHeight:f,getColumnWidth:P,layout:A,onViewportScroll:R,onImmediateScroll:T,showGridLines:$=!0,gridLineColor:Y="rgb(224, 224, 224)",gridLineRowsProps:q,gridLineColumnsProps:J,clipCells:ye=!0,cursor:G,freezeLeft:k=0,freezeTop:V=0,freezeLeftProps:fe,freezeTopProps:M,cellRenderer:ce,onViewportChange:je,onFirstRender:ke,overlayRenderer:Ve,overlayProps:ge,overlays:ee,overlaysProps:X,allowOverlaysOverflow:m=!1,stageProps:qe,stageWrapper:Ne=null,hiddenRowsAt:oe,hiddenColumnsAt:Ee,hiddenCellAt:Z,getVisibleCells:z,zoom:K=1,enableMouseWheel:yt=!0,onWheelScroll:vt,getCellCoordsAsRangeCoords:ut=W.cellToRange,scrollPoint:ct=No,style:we={},...At}=e;yn(ce),yn(!e?.children);const O=L(T,[T]),S=L(je,[je]),Re=L(R,[R]),le=L(vt,[vt]),me=L(ke,[ke]),Be=o.useRef(null),tt=o.useRef(null),St=o.useRef(null),[nt,Vt]=o.useReducer(g=>g+1,0),[ht,v]=o.useState({left:ct?.left??0,top:ct?.top??0,horizontalScrollDirection:null,verticalScrollDirection:null}),ie=o.useRef(null),Xe=o.useRef(ht),{top:at,left:_e,verticalScrollDirection:Zt,horizontalScrollDirection:Nt}=ht,It=o.useRef(!1),on=Eo({rowCount:d,columnCount:a,defaultRowHeight:s,defaultColumnWidth:i,getRowHeight:f,getColumnWidth:P}),qt=o.useRef(null),Me=o.useMemo(()=>{const g=A||on;return qt.current=null,{getColOffset:b=>g.getColOffset(b)*K,getColIndex:b=>g.getColIndex(b/K),getRowOffset:b=>g.getRowOffset(b)*K,getRowIndex:b=>g.getRowIndex(b/K)}},[on,A,K]),Ft=(g,b,D)=>{const y=(b?.left??0)+0,C=(b?.top??0)+0;return{getColOffset:F=>g.getColOffset(F)-y,getColIndex:F=>g.getColIndex(F+y),getRowOffset:F=>g.getRowOffset(F)-C,getRowIndex:F=>g.getRowIndex(F+C)}},gt=o.useCallback((g,b=!1)=>En(g,b,Me.getRowOffset,b?0:d),[d,Me?.getRowOffset]),zt=L(oe??gt,[oe]),un=o.useCallback((g,b=!1)=>En(g,b,Me.getColOffset,b?a:0),[a,Me?.getColOffset]),Qt=L(Ee??un,[Ee]),Ue=o.useMemo(()=>Math.min(r??800,Me.getColOffset(a)),[Me.getColOffset,a,r]),Ae=o.useMemo(()=>Math.min(l??600,Me.getRowOffset(d)),[Me.getRowOffset,d,l]),Kt=o.useCallback(g=>{jt.canUseDOM&&setTimeout(()=>{Be.current?.focus({preventScroll:!0,...g})},0)},[]),wt=o.useCallback(g=>Be.current?.contains(g)||tt.current?.contains(g),[]);o.useEffect(()=>{It.current&&(ie.current&&ie.current.left!==Xe.current?.left&&ie.current.top!==Xe.current?.top||(ie.current=null,Re?.({left:_e,top:at})))},[_e,at]);const Bt=L(()=>({top:at,left:_e}),[at,_e]),Pe=o.useMemo(()=>{const g=[];let b=0,D=0;typeof V=="number"?b=V:(b=V.index??0,D=(V.scrollOffset??0)*K);const y=D,C=Me.getRowOffset(b),F=C-y;if(b>0){const Ke=Ft(Me,{top:D+Me.getRowOffset(0)}),Oe=Me.getRowIndex(y),De=Me.getRowIndex(C-1);let He;g[1]={minIndex:Oe,maxIndex:De,minCoord:0,maxCoord:b-1,minBounds:0,maxBounds:F,visibleIndices:()=>He||(He=Object.freeze(Sn(zt,Oe,De)),He),layout:Ke,maxVirtualBounds:C,scrollOffset:D,freezeOffset:D}}const _=Math.max(0,Ae-F),se=Ft(Me,{top:at+F}),de=se.getRowIndex(0),j=se.getRowIndex(_);let Se;return g[0]={minIndex:de,maxIndex:j,minCoord:b,maxCoord:d-1,minBounds:F,maxBounds:_,visibleIndices:()=>Se||(Se=Object.freeze(Sn(zt,de,j)),Se),layout:se,maxVirtualBounds:Me.getRowOffset(d),scrollOffset:at,freezeOffset:(b>0?Me.getRowOffset(b):0)-D},g},[Me.getRowIndex,Me.getRowOffset,zt,Ae,d,V,at,K]),Ye=o.useMemo(()=>{const g=[];let b=0,D=0;typeof k=="number"?b=k:(b=k.index??0,D=(k.scrollOffset??0)*K);const y=D,C=Me.getColOffset(b),F=C-y;if(b>0){const Ke=Ft(Me,{left:D+Me.getColOffset(0)}),Oe=Me.getColIndex(y),De=Me.getColIndex(C-1);let He;g[1]={minIndex:Oe,maxIndex:De,minCoord:0,maxCoord:b-1,minBounds:0,maxBounds:F,visibleIndices:()=>He||(He=Object.freeze(Sn(Qt,Oe,De)),He),layout:Ke,maxVirtualBounds:C,scrollOffset:D,freezeOffset:D}}const _=Math.max(0,Ue-F),se=Ft(Me,{left:_e+F}),de=se.getColIndex(0),j=se.getColIndex(_);let Se;return g[0]={minIndex:de,maxIndex:j,minCoord:b,maxCoord:a-1,minBounds:F,maxBounds:_,visibleIndices:()=>Se||(Se=Object.freeze(Sn(Qt,de,j)),Se),layout:se,maxVirtualBounds:Me.getColOffset(a),scrollOffset:_e,freezeOffset:(b>0?Me.getColOffset(b):0)-D},g},[Me.getColIndex,Me.getColOffset,Qt,Ue,a,k,_e,K]),dt=o.useRef({}),bt=o.useRef([]),Te=o.useMemo(()=>{let g={};const b=(y,C,F,_,se)=>{const de={vertical:_?.vertical||!1,horizontal:_?.horizontal||!1};if(y>=Ye.length||C>=Pe.length)return null;const j={rowStart:Pe[C].minIndex,colStart:Ye[y].minIndex,rowEnd:Pe[C].maxIndex,colEnd:Ye[y].maxIndex};if(j.rowStart>j.rowEnd||j.colStart>j.colEnd)return null;const Se={getColIndex:ve=>Ye[y].layout.getColIndex(ve),getColOffset:ve=>Ye[y].layout.getColOffset(ve),getRowIndex:ve=>Pe[C].layout.getRowIndex(ve),getRowOffset:ve=>Pe[C].layout.getRowOffset(ve)},Ke=Object.freeze({left:se?.left??0,top:se?.top??0,right:se?.right??0,bottom:se?.bottom??0}),Oe=Object.freeze({x:Ye[y].minBounds,y:Pe[C].minBounds,width:Ye[y].maxBounds,height:Pe[C].maxBounds}),De=(ve,Ge)=>Qn(Se,ve??j,Ge),He={width:Ye[y].maxVirtualBounds,height:Pe[C].maxVirtualBounds},Ie={left:Ye[y].scrollOffset,top:Pe[C].scrollOffset},xt={left:Ye[y].freezeOffset,top:Pe[C].freezeOffset},rt={width:Ue,height:Ae};let $e=null,Ce=null;const ot=(xt.top+(_.vertical?Ie.top:0))/K,Mt=(xt.left+(_.horizontal?Ie.left:0))/K;return{getStage:()=>Be.current??null,getVisibleRangeCoords:()=>j,toClipBounds:(ve,Ge)=>{let Et,Fe=0;return Ge===void 0||typeof Ge=="number"?(Et=De(j),Fe=Ge):Et=Ge,((Je,Le,ze=0)=>{if(Je.x>Le.width||Je.y>Le.height)return null;const ft={left:Je.x,top:Je.y,bottom:Je.height+Je.y,right:Je.width+Je.x},lt={left:Le.x+ze,top:Le.y+ze,bottom:Le.height-2*ze+Le.y,right:Le.width-2*ze+Le.x},pt={left:Math.max(ft.left,lt.left),top:Math.max(ft.top,lt.top),bottom:Math.min(ft.bottom,lt.bottom),right:Math.min(ft.right,lt.right)},Tt={x:pt.left,y:pt.top,width:pt.right-pt.left,height:pt.bottom-pt.top};return Tt.height<0||Tt.width<0?null:Tt})(ve??{x:0,y:0,width:Oe.width,height:Oe.height},Et,Fe)},toViewBounds:ve=>Mt===0&&ot===0&&K===1?ve:{x:(ve.x-Mt)*K,y:(ve.y-ot)*K,width:ve.width*K,height:ve.height*K},toAbsoluteBounds:ve=>Mt===0&&ot===0&&K===1?ve:{x:ve.x/K+Mt,y:ve.y/K+ot,width:ve.width/K,height:ve.height/K},getRelativePointFromClient:(ve,Ge)=>{const Et=Jt(ve,Ge);return{x:Et.x-Oe.x,y:Et.y-Oe.y}},getLayout:()=>Se,getCellCoordsAsRangeCoords:ut,getVisibleColumns:()=>Ye[y].visibleIndices(),getVisibleRows:()=>Pe[C].visibleIndices(),getVisibleColumnOffsets:()=>($e||($e=Zn(Ye[y].layout,!0,Ye[y].visibleIndices(),j.colStart,j.colEnd)),$e),getVisibleRowOffsets:()=>(Ce||(Ce=Zn(Pe[C].layout,!1,Pe[C].visibleIndices(),j.rowStart,j.rowEnd)),Ce),getTotalRangeCoords:()=>({colStart:Ye[y].minCoord,colEnd:Ye[y].maxCoord,rowStart:Pe[C].minCoord,rowEnd:Pe[C].maxCoord}),getRangeCoordsBounds:De,scrollCellCoordsIntoView:(ve,Ge)=>rn(ve,Ge,F),getCellCoordsFromClient:(ve,Ge,Et=!1)=>{const Fe=Jt(ve,Ge);if(!Fe)return null;const Je=Se.getColIndex(Fe.x-Oe.x),Le={rowIndex:Se.getRowIndex(Fe.y-Oe.y),colIndex:Je};if(Et)return Le;const ze=ut(Le);return{rowIndex:ze.rowStart,colIndex:ze.colStart}},getZoom:()=>K,getAnchor:()=>F,getBounds:()=>Oe,getInsets:()=>Ke,getTotalSize:()=>He,getViewportSize:()=>rt,getScrollTopLeft:()=>Ie,getFreezeTopLeft:()=>xt,getScrollOrientation:()=>de,allViews:()=>g}};let D=g[Ze.Center]=b(0,0,Ze.Center,Ko,Yo);return D&&(g[Ze.Center]=D),D=b(0,1,Ze.Top,{horizontal:!0}),D&&(g[Ze.Top]=D),D=b(1,0,Ze.Left,{vertical:!0}),D&&(g[Ze.Left]=D),D=b(1,1,Ze.TopLeft,{}),D&&(g[Ze.TopLeft]=D),dt.current=null,g=Object.freeze(g)},[Pe,Ye,ut]),Yt=Object.keys(Te),Rt=Ye[0]?.maxVirtualBounds??0,Qe=Pe[0]?.maxVirtualBounds??0,Ct=o.useMemo(()=>({left:Ye[1]?Ye[1].layout.getColOffset(Ye[1].maxIndex+1):0,top:Pe[1]?Pe[1].layout.getRowOffset(Pe[1].maxIndex+1):0}),[Te]);o.useEffect(()=>{if(bt.current.length>0){for(let g=0;g<bt.current.length;g++)bt.current[g]();bt.current=[]}},[Te]);const kt=L(()=>({containerWidth:Ue,containerHeight:Ae,totalWidth:Rt,totalHeight:Qe}),[Ue,Ae,Me]);o.useEffect(()=>{!ie.current&&It.current&&S({top:at,left:_e,width:Ue,height:Ae,totalWidth:Rt,totalHeight:Qe})},[at,_e,Rt,Qe]),o.useEffect(()=>{It.current&&S({top:at,left:_e,width:Ue,height:Ae,totalWidth:Rt,totalHeight:Qe})},[Ue,Ae]);const Jt=o.useCallback((g,b)=>{yn(typeof g=="number"&&typeof b=="number");const D=Be.current?.getBoundingClientRect();return D?{x:g-D.x,y:b-D.y}:{x:g,y:b}},[]),In=L(g=>Te[g]||null,[Te]),Rn=L((g,b)=>{if(Object.keys(Te).length===1)return Te[Ze.Center];const D=Jt(g,b);if(!D)return null;const{x:y,y:C}=D;let F=null;const _=to,se=_.length;for(let de=0;!F&&de<se;de++){const j=Te[_[de]];j&&Wo(y,C,j.getBounds())&&(F=j)}return F||(F=Te[Ze.Center]),F},[Te,ut]),et=L(()=>Te[Ze.Center].getVisibleRangeCoords(),[Te[Ze.Center]]),Ut=o.useRef(null),kn=o.useCallback(()=>{Ut.current!==null&&jt.cancelTimeout(Ut.current),Ut.current=jt.requestTimeout(Mn,150)},[]),Mn=o.useCallback(()=>{Ut.current=null,v(g=>{const b={...g,verticalScrollDirection:null,horizontalScrollDirection:null};return Xe.current=b,b})},[]),Gt=L(g=>{const b=g?.left??g?.[0],D=g?.top??g?.[1],y=b!==void 0?Math.min(Rt-Ue,Math.max(Ye?.[1]?.scrollOffset??0,b)):Xe.current.left,C=D!==void 0?Math.min(Qe-Ae,Math.max(Pe?.[1]?.scrollOffset??0,D)):Xe.current.top;if(Xe.current.left===y&&Xe.current.top===C)return;let F=null,_=null;Xe.current.left>y?F=x.Left:Xe.current.left<y&&(F=x.Right),Xe.current.top>C?_=x.Up:Xe.current.top<C&&(_=x.Down),jt.throttle(()=>{v(se=>{const de={...se,left:y,top:C,horizontalScrollDirection:F,verticalScrollDirection:_};return Xe.current=de,de})},17)(),ie.current?.top===C&&ie.current?.left===y||(ie.current={left:y,top:C},O({left:y,top:C}),S({left:y,top:C,width:Ue,height:Ae,totalWidth:Rt,totalHeight:Qe})),kn()},[Rt,Qe,Pe,Ye]);o.useEffect(()=>{ie.current||Gt({left:_e,top:at})},[Rt,Ue,Qe,Ae]),o.useLayoutEffect(()=>{ie.current={left:ct?.left,top:ct?.top},Gt(ie.current)},[ct?.left,ct?.top]);const hn=L(g=>{const b=g?.left??g?.[0],D=g?.top??g?.[1],y=g?.behavior??"auto",C={left:Xe.current.left+(b??0),top:Xe.current.top+(D??0)};y&&(C.behavior=y),Gt(C)},[Rt,Ue,Qe,Ae]),fn=o.useCallback(g=>{let b=null;if(Object.keys(Te).length>1){const D=to,y=D.length;for(let C=0;!b&&C<y;C++){const F=Te[D[C]];F&&W.isCellWithinRange(g,F.getVisibleRangeCoords())&&(b=F)}}return b||(b=Te[Ze.Center]),b},[Te]),rn=L((g,b={inline:"nearest",block:"nearest"},D=null)=>{const y={rowIndex:0,colIndex:0,...g};let C=null;if(D!==null){if(C=Te[D],C===null)return new Promise((rt,$e)=>{$e("Invalid view")})}else C=fn(y);const F=ut(y),_=C.getLayout(),se=_.getColOffset(F.colStart),de=_.getRowOffset(F.rowStart),j=_.getColOffset(F.colEnd+1),Se=_.getRowOffset(F.rowEnd+1),Ke=C.getBounds(),Oe=C.getTotalSize(),De=C.getScrollTopLeft(),He=((rt,$e,Ce=!0)=>(Ce=Ce===!0?{block:"start",inline:"end"}:Ce===!1?{block:"end",inline:"end"}:{block:"end",inline:"end",...Ce},{left:Gn(Ce.inline,rt.x,rt.x+rt.width,$e.left,$e.left+$e.width,$e.totalWidth),top:Gn(Ce.block,rt.y,rt.y+rt.height,$e.top,$e.top+$e.height,$e.totalHeight)}))({x:se+De.left,y:de+De.top,width:j-se,height:Se-de},{left:De.left,top:De.top,width:Ke.width,height:Ke.height,totalWidth:Oe.width,totalHeight:Oe.height},b),Ie={...He};Ie.left>_e?Ie.left+=20:Ie.left<_e&&(Ie.left-=0),Ie.top>at?Ie.top+=20:Ie.top<at&&(Ie.top-=0);const xt=C.getScrollOrientation();return xt.horizontal&&g.colIndex!==void 0||delete Ie.left,xt.vertical&&g.rowIndex!==void 0||delete Ie.top,new Promise((rt,$e)=>{try{Gt(Ie),rt(Ie)}catch(Ce){$e(Ce)}})},[Rt,Qe,Te,ut]),en=L(g=>{const b=g.shiftKey;g.preventDefault();const{deltaX:D,deltaY:y,deltaMode:C}=g;if(St.current||le?.(g)===!1)return;let F=b?y:D,_=y;const se=b||Math.abs(F)>Math.abs(_);C===1&&(_*=0),St.current=window.requestAnimationFrame(()=>{St.current=null,hn(se?{left:F}:{top:_})})},[Rt,Ue,Qe,Ae,le]),ln=o.useCallback((g=null)=>{qt.current=null,dt.current=null,Vt()},[]);o.useLayoutEffect(()=>{ln()},[ce]);const Xt=ro(n,()=>({stage:Be.current,focus:Kt,contains:wt,invalidate:ln,scrollTo:Gt,scrollBy:hn,scrollCellCoordsIntoView:rn,getScrollPosition:Bt,getDimensions:kt,getViewport:et,handleWheel:en,rowCount:d,columnCount:a,getLayout:()=>Me,getRelativePointFromClient:Jt,getViewFromClient:Rn,getViewFromCellCoords:fn,getViewFromLocation:In,onViewChangeOnce:g=>{bt.current.push(g)}}),[d,a,Te]);o.useEffect(()=>(yt&&Xt.current?.addEventListener("wheel",en,{passive:!1}),It.current=!0,ie.current=null,()=>{Xt.current?.removeEventListener("wheel",en)}),[yt]);const sn=o.useRef([]),Pn=(g,b)=>{!g||!Ve||(sn.current=[],b.push(((D,y)=>{const C=`view:${D.getAnchor()}:overlay:${b.length}`,F=Ve?.({key:C,view:D},se=>sn.current[y]=se);if(!F)return null;const _=D.getBounds();return re.jsx("div",{style:{position:"absolute",left:"0px",top:"0px",width:`${_.width}px`,height:`${_.height}px`,overflow:"hidden"},children:F},`overlay-${D.getAnchor()}-${y}`)})(g,0)))},Tn=o.useMemo(()=>{const g={},b=Object.keys(Te),D=b.length;for(let y=0;y<D;y++){const C=b[y],F=[];Pn(Te[C],F),g[C]={overlays:F}}return g},[nt,Ve,d,a,Pe,Ye]),gn=(g,b,D,y,C,F,_)=>{if(!g)return;const se=g.getVisibleColumns(),de=g.getVisibleRows();if(se.length===0||de.length===0)return;let j=null;if(z)j=z(g);else{j=[];const Fe=de.length,Je=se.length;for(let Le=0;Le<Fe;Le++){const ze=de[Le];for(let ft=0;ft<Je;ft++){const lt={rowIndex:ze,colIndex:se[ft]};if(Z?.(lt))continue;const pt={coords:lt,range:ut(lt)};j.push(pt)}}}const Se=g.getVisibleColumnOffsets(),Ke=g.getVisibleRowOffsets(),Oe=g.getScrollTopLeft(),De=g.getFreezeTopLeft(),He=Oe.left+De.left,Ie=Oe.top+De.top,xt=Math.trunc(He/Ht),rt=Math.trunc(Ie/Ht),$e={},Ce=(Fe,Je,Le,ze,ft)=>{const lt=`view:${Fe.getAnchor()}:cell:${Kn(Je.rowIndex,Je.colIndex)}`,pt=ze.x,Tt=ze.y,t=Math.trunc((He+pt)/Ht)-xt,u=Math.trunc((Ie+Tt)/Ht)-rt;$e[u]||($e[u]={});let h=$e[u][t];h||(h=$e[u][t]=[]);let c=F?.get(lt);if(!c){const w=(He+pt)%Ht,I=(Ie+Tt)%Ht;c=ce({key:lt,coords:Je,bounds:ze,zoom:K,range:Le,view:Fe,value:ft,style:{left:Q.boundPixel(w),top:Q.boundPixel(I),width:Q.boundPixel(ze.width,!0),height:Q.boundPixel(ze.height,!0)}})}_?.set(lt,c),h.push(c)},ot=j.length;for(let Fe=0;j&&Fe<ot;Fe++){const Je=j[Fe],Le=Je?.coords??Je;if(!Le)continue;const ze=Je?.range??{rowStart:Le.rowIndex,colStart:Le.colIndex,rowEnd:Le.rowIndex,colEnd:Le.colIndex},ft=g.getVisibleRangeCoords();if(!W.isRangesIntersect(ze,ft)&&!W.isRangeWithinRange(ze,ft))continue;const lt=ze&&!W.isSingleCell(ze);if(!lt&&Z?.(Le))continue;const pt=Le.rowIndex,Tt=Le.colIndex,t=Ke[pt],u=Se[Tt];let h=null;t&&u&&(h={x:u.offset,y:t.offset,width:u.size,height:t.size});const c=Kn(ze.rowStart,ze.colStart);if(lt){if(C.has(c))continue;C.add(c),ze.rowEnd-ze.rowStart>0&&D.push(ze),ze.colEnd-ze.colStart>0&&y.push(ze)}if(lt&&(h=Qn(g.getLayout(),ze)),!h){console.warn("no bounds for cell",c);continue}const w=Je?.value;Ce(g,Le,ze,h,w)}const Mt=He%Ht,ve=Ie%Ht,Ge=Object.keys($e),Et=Ge.length;for(let Fe=0;Fe<Et;Fe++){const Je=Ge[Fe],Le=$e[Je];if(!Le)continue;const ze=Object.keys(Le),ft=ze.length;for(let lt=0;lt<ft;lt++){const pt=ze[lt],Tt=Le[pt];if(!Tt)continue;const t=parseInt(Je),u=parseInt(pt),h=t+rt,c=u+xt,w=`view:${g.getAnchor()}:segment:${c}:${h}`;b.push(re.jsx("div",{className:"cell-container",style:{transform:`translate(${Q.boundPixel(u*Ht-Mt,!0)}px, ${Q.boundPixel(t*Ht-ve,!0)}px)`,willChange:"transform"},children:Tt},w))}}},Dt=o.useMemo(()=>{const g=qt.current,b=new Map,D={},y=Object.keys(Te),C=y.length;for(let F=0;F<C;F++){const _=y[F],se=[],de=[],j=[];gn(Te[_],j,se,de,new Set,g,b),D[_]={cells:j,rangesH:se,rangesV:de}}return qt.current=b,D},[nt,d,a,Pe,Ye,$,we,ye,Z,z,ut]),wn=(g,b,D,y,C)=>{if(g)if(b){const F=`view:${g.getAnchor()}:hl:`,_=g.getVisibleRows();if(!_||_.length===0)return;const se=0,de=g.getBounds().width;let j=[];const Se=C.sort(W.rowFirstRangeComparator),Ke=g.getVisibleRangeCoords();for(let Oe=0;Oe<_.length&&_[Oe]<=Ke.rowEnd;Oe++){const De=_[Oe];if(De<Ke.rowStart)continue;let He=!1;for(;Se.length>0&&Se[0].rowStart<=De;){const Ce=Se.shift();Ce.rowEnd>De&&(j.push(Ce),He=!0)}He&&(j=j.sort(W.columnFirstRangeComparator));const Ie=g.getLayout(),xt=Ie.getRowOffset(De+1);let rt=se;const $e=j.length;for(let Ce=0;Ce<$e+1;Ce++){let ot=rt,Mt=de;const ve=j[Ce];Ce<$e&&(Mt=Math.min(de,Ie.getColOffset(ve.colStart)),rt=Math.min(de,Ie.getColOffset(ve.colEnd+1))),y.push(o.createElement("path",{d:`M ${Q.boundPixel(ot)} ${Q.boundPixel(xt,!1,D)} L ${Q.boundPixel(Mt)} ${Q.boundPixel(xt,!1,D)}`,stroke:Y,strokeWidth:1,vectorEffect:"non-scaling-stroke",...q,key:F+De+":"+Ce}))}for(let Ce=$e-1;Ce>=0;Ce--)j[Ce].rowEnd<=_[Oe+1]&&j.splice(Ce,1)}}else{const F=`view:${g.getAnchor()}:vl:`,_=g.getVisibleColumns();if(!_||_.length===0)return;const se=0,de=g.getBounds().height;let j=[];const Se=C.sort(W.columnFirstRangeComparator),Ke=g.getVisibleRangeCoords(),Oe=_.length;for(let De=0;De<Oe&&_[De]<=Ke.colEnd;De++){const He=_[De];if(He<Ke.colStart)continue;let Ie=!1;for(;Se.length>0&&Se[0].colStart<=He;){const ot=Se.shift();ot.colEnd>He&&(j.push(ot),Ie=!0)}Ie&&(j=j.sort(W.rowFirstRangeComparator));const xt=g.getLayout(),rt=xt.getColOffset(He+1);let $e=se;const Ce=j.length;for(let ot=0;ot<Ce+1;ot++){let Mt=$e,ve=de;const Ge=j[ot];ot<Ce&&(ve=Math.min(de,xt.getRowOffset(Ge.rowStart)),$e=Math.min(de,xt.getRowOffset(Ge.rowEnd+1)));let Et=Y;y.push(re.jsx("path",{d:`M ${Q.boundPixel(rt,!1,D)} ${Q.boundPixel(Mt)} L ${Q.boundPixel(rt,!1,D)} ${Q.boundPixel(ve)}`,stroke:Et,strokeWidth:1,vectorEffect:"non-scaling-stroke",...J},F+He+":"+ot))}for(let ot=Ce-1;ot>=0;ot--)j[ot].colEnd<=_[De+1]&&j.splice(ot,1)}}},cn=g=>{if(!Dt)return;const b={},D=Yt.length;for(let y=0;y<D;y++){const C=Yt[y],F=Te[C],_=[];wn(F,g,0,_,g?Dt[C].rangesH:Dt[C].rangesV);const se=F.getRangeCoordsBounds(),de=Math.ceil(se.width),j=Math.ceil(se.height);b[C]=re.jsx("svg",{width:`${de}`,height:`${j}`,viewBox:`0 0 ${de} ${j}`,preserveAspectRatio:"none",shapeRendering:"crispEdges",style:{position:"absolute"},children:_})}return b},xn=o.useMemo(()=>$===!0||$?.horizontal===!0?cn(!0):null,[nt,$,Pe,V,k,Y,q,d,a,Ue,Rt,Dt]),pn=o.useMemo(()=>$===!0||$?.vertical===!0?cn(!1):null,[nt,$,Ye,V,k,Y,J,d,a,Ae,Qe,Dt]),On=o.useMemo(()=>Ct.left===0?null:re.jsx(Jn,{linePoints:[0,0,0,Ae+1],bounds:{x:Ct.left,y:0,width:1,height:Ae+1},...fe}),[nt,Ct.left,Ae,fe]),zn=o.useMemo(()=>Ct.top===0?null:re.jsx(Jn,{linePoints:[0,0,Ue+1,0],bounds:{x:0,y:Ct.top,width:Ue+1,height:1},...M}),[nt,Ct.top,Ue,M]),an=o.useMemo(()=>{const g=[],b=y=>{if(!y||!Te[y])return;const C=Te[y].getBounds();return re.jsxs("div",{style:{position:"absolute",pointerEvents:"none",left:C.x,top:C.y,width:C.width,height:C.height,clip:`rect(0, ${C.width+1}px, ${C.height+1}px, 0)`},className:`view view-${y}`,children:[xn?.[y],pn?.[y],Dt?.[y].cells]},`view:${y}`)},D=Yt.length;for(let y=0;y<D;y++)g.push(b(Yt[y]));return re.jsx(re.Fragment,{children:g})},[Te,xn,pn,Dt]),Dn=o.useMemo(()=>{if(!n)return;const g=(se,de,j,Se)=>{if(!Se||Se.length===0)return;const Ke=[],Oe=Se.length;for(let De=0;De<Oe;De++){const He=Se[De];let Ie=se?.get(He);Ie!==Wn&&(Ie=He(j)??Wn),de.set(He,Ie),Ie&&Ie!==Wn&&Ke.push(Ie)}return Ke},b=(se,de,j)=>{if(!j)return;const Se=j.getBounds(),Ke=j.getInsets(),Oe=j.getAnchor();return re.jsxs("div",{className:_t("view",`view-${Oe}`,eo.view),style:{position:"absolute",pointerEvents:"none",left:Se.x-Ke.left,top:Se.y-Ke.top,width:Se.width-(Ke.left+Ke.right),height:Se.height-(Ke.top+Ke.bottom),clipPath:m?"inset(-2px)":"inset(0px)"},children:[g(se,de,j,ee),Tn?.[Oe].overlays]},`view:${Oe}`)},D=dt.current,y={},C=[],F=Object.keys(Te),_=F.length;for(let se=0;se<_;se++){const de=F[se],j=D?.[de],Se=y[de]=new Map;C.push(b(j,Se,Te[de]))}return dt.current=y,C},[nt,Te,m,ee]),Ln=o.useMemo(()=>{const{style:g,...b}=qe??{};return re.jsx("div",{style:{width:Ue,height:Ae,...g},className:"sheetxl-stage",tabIndex:0,ref:Be,...b,...At,children:Ne?Ne(an):an})},[Ue,Ae,an,qe,Ne]),mn=o.useRef(!1);return o.useEffect(()=>{!mn.current&&Dt&&(mn.current=!0,me?.(Xt.current))},[Dt]),re.jsxs("div",{className:_t("sheetxl-grid",eo["sheetxl-grid"]),style:{overflow:"visible",cursor:G,maxWidth:Ue,maxHeight:Ae,width:Ue,height:Ae,...we},ref:Xt,children:[Ln,re.jsxs("div",{className:_t("sheetxl-overlays"),ref:tt,...X,children:[Dn,On,zn]})]})}));wo.displayName="BaseGrid";const xo=o.memo(o.forwardRef((e,n)=>{const{width:r,height:l,style:d={},className:a,...s}=e,[i,{width:f,height:P}]=ao();return re.jsx("div",{className:a,style:{...d},children:re.jsx("div",{style:{position:"relative",top:"0px",left:"0px",width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%",boxSizing:"content-box"},ref:i,children:re.jsx(wo,{ref:n,width:r??f,height:l??P,...s})})})}));xo.displayName="Grid";const Go=o.memo(o.forwardRef((e,n)=>{const{showVerticalScrollbar:r,showHorizontalScrollbar:l,createHorizontalScrollbar:d,createVerticalScrollbar:a,createScrollCorner:s,viewport:i,onScrollViewport:f,style:P={},className:A,onScroll:R,...T}=e,[$,Y]=o.useState(null),q=o.useRef(null),J=o.useRef(null);yn(!i),o.useImperativeHandle(n,()=>J.current&&q.current?Object.assign(J.current,q.current):null);const ye=o.useCallback(G=>{J.current?.scrollTo(G),f?.(G)},[]);return re.jsx(So,{className:A,style:P,ref:q,showVerticalScrollbar:r,showHorizontalScrollbar:l,createHorizontalScrollbar:d,createVerticalScrollbar:a,createScrollCorner:s,viewport:$,onScrollViewport:ye,children:re.jsx(xo,{style:{width:"100%",height:"100%"},...T,onViewportChange:G=>Y(G),ref:J})})}));Go.displayName="ScrollableGrid";const no=()=>!1,Xo=o.memo(e=>{const{index:n,value:r,zoom:l,zoomScale:d=100,headerText:a=ee=>`${ee}`,headerStyle:s,headerStyleSelect:i=s,headerStyleSelectAll:f=i,headerStyleHover:P=f,verticalPadding:A=0,horizontalPadding:R=0,isSelected:T=no,isSelectedAll:$=no,coords:Y,bounds:q,range:J,orientation:ye,view:G,style:k,...V}=e,fe=d/100,M=o.useRef(null),[ce,je]=o.useState(!1),ke=T?.(n)||!1,Ve=$?.(n)?f:ke?i:s;let ge=Ve;if(ce){let ee=P;typeof P=="function"&&(ee=P(Ve)),ge=jt.mergeContentful(Ve,ee)}return re.jsx("div",{ref:M,style:{background:ge.fill,color:ge.text?.fill,fontFamily:ge.text?.fontFamily??s.text?.fontFamily,fontSize:96*(ge.text?.fontSize??11)/72*fe,fontStyle:ge.text?.fontStyle,fontWeight:ge.text?.fontWeight,lineHeight:1.2,display:"flex",justifyContent:"center",alignItems:"end",pointerEvents:"auto",paddingBottom:`${fe}px`,...k,left:k.left-(ye===Wt.Column?1:0),top:k.top-(ye===Wt.Row?1:0),width:k.width+1,height:k.height+1,overflow:"hidden"},...V,onMouseMove:ee=>{Q.detectIt().primaryInput!=="touch"&&ee.buttons===0&&je(!0)},onMouseOut:ee=>{je(!1)},children:a(n)})});Xo.displayName="HeaderRenderer";const po="ew-resize",mo="ns-resize",_o=o.memo(o.forwardRef((e,n)=>{const{orientation:r,view:l,index:d,className:a,style:s,disabled:i=!1,disabledResize:f=!1,isNextHidden:P,isHidden:A,isSelected:R,isSelectedAll:T,showTouchDivider:$,headerStyle:Y,headerStyleSelect:q,headerStyleSelectAll:J,headerStyleHover:ye,bounds:G,onPointerDown:k,onAutoFit:V,...fe}=e,M=r===Wt.Column;let ce=Y;R&&q&&(ce=q),T&&J&&(ce=J);const je=Q.detectIt().primaryInput==="touch";let ke=M?14:8,Ve=ke/2,ge=0;P&&(ge=-2),A&&(ge=2),A&&(ke=ke/2+ge,Ve=2*ge);let ee=ce.dividerStrokeFill??ce.strokeFill;return!(R||T)&&ge===0&&(ee=`linear-gradient(${M?180:90}deg, ${ce.fill}, ${ee} 55%, ${ee} 100%)`),re.jsxs("div",{className:_t("header-divider",{disabled:i},a,`index-${d}`),ref:n,onPointerDown:je?void 0:k,onDoubleClick:je?void 0:()=>V?.(),style:{top:(M?0:-ke/2+(ge-1))+"px",left:(M?-ke/2+(ge-1):0)+"px",width:M?ke:"calc(100% + 1px)",height:M?"calc(100% + 1px)":ke,position:"absolute",overflow:"visible",pointerEvents:"all",cursor:i||f||je?void 0:M?po:mo,...s},...fe,children:[re.jsx("div",{style:{position:"relative",top:`${M?0:Ve}px`,left:`${M?Ve:0}px`,width:M?1:"100%",height:M?"100%":1,background:ee},onDoubleClick:()=>V?.()}),$&&je?re.jsx("div",{style:{position:"absolute",cursor:"grab",zIndex:1,borderRadius:"4px",right:M?"-6px":"2px",bottom:M?"2px":"-9px",height:"24px",width:M?"24px":"18px",maxHeight:M?"calc(100% - 4px)":void 0,maxWidth:M?void 0:"calc(100% - 4px)",background:ce.fill,border:`${J.edgeStrokeFill} solid 1px`,boxShadow:`0.5px 0.5px 0px 0px ${Y.text.fill}`,display:"flex",alignItems:"center",justifyContent:"center"},onPointerDown:k,children:re.jsx("div",{style:{width:"6.4px",height:"12px",backgroundImage:`url("data:image/svg+xml,%3Csvg width='6.4' height='12' viewBox='0 0 9.6 16' version='1.1' fill='${encodeURIComponent(q.text.fill)}' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg'%3E%3Cpath d='M 9.60008,14.40009 C 9.60008,15.28374 8.88368,16 8.00003,16 7.11639,16 6.40012,15.28374 6.40012,14.40009 c 0,-0.88365 0.71627,-1.60005 1.59991,-1.60005 0.88365,0 1.60005,0.7164 1.60005,1.60005 m 0,-6.40012 c 0,0.88364 -0.7164,1.60004 -1.60005,1.60004 -0.88364,0 -1.59991,-0.7164 -1.59991,-1.60004 0,-0.88365 0.71627,-1.60005 1.59991,-1.60005 0.88365,0 1.60005,0.7164 1.60005,1.60005 m 0,-6.40006 c 0,0.88365 -0.7164,1.60005 -1.60005,1.60005 -0.88364,0 -1.59991,-0.7164 -1.59991,-1.60005 C 6.40012,0.71626 7.11639,0 8.00003,0 8.88368,0 9.60008,0.71626 9.60008,1.59991 M 3.19996,14.40009 C 3.19996,15.28374 2.48369,16 1.60005,16 0.7164,16 0,15.28374 0,14.40009 c 0,-0.88365 0.7164,-1.60005 1.60005,-1.60005 0.88364,0 1.59991,0.7164 1.59991,1.60005 m 0,-6.40012 c 0,0.88364 -0.71627,1.60004 -1.59991,1.60004 C 0.7164,9.60001 0,8.88361 0,7.99997 0,7.11632 0.7164,6.39992 1.60005,6.39992 c 0.88364,0 1.59991,0.7164 1.59991,1.60005 m 0,-6.40006 c 0,0.88365 -0.71627,1.60005 -1.59991,1.60005 C 0.7164,3.19996 0,2.48356 0,1.59991 0,0.71626 0.7164,0 1.60005,0 2.48369,0 3.19996,0.71626 3.19996,1.59991' /%3E%3C/svg%3E%0A")`,backgroundRepeat:"no-repeat",backgroundPosition:"center",transform:M?void 0:"rotate(90deg)"}})}):null]})})),Zo=(e,n)=>re.jsx(_o,{...e,ref:n}),sr=o.memo(o.forwardRef((e,n)=>{const{orientation:r,view:l,index:d,disabled:a=!1,disabledResize:s=!1,resizeThreshold:i=1,dividerRenderer:f=Zo,onDividerMouseDown:P,onDividerResizeStart:A,onDividerResize:R,onDividerResizeEnd:T,onDividerMouseUp:$,onDividerAutoFit:Y,onPointerDown:q,...J}=e,ye=L(q,[q]),G=L(Y,[Y]),k=r===Wt.Column;let V=k?l.getVisibleColumns():l.getVisibleRows(),fe=null;V.length>0&&(k?fe=l.getRangeCoordsBounds({rowStart:0,rowEnd:0,colStart:V[0],colEnd:V[V.length-1]}):l.getRangeCoordsBounds({rowStart:V[0],rowEnd:V[V.length-1],colStart:0,colEnd:0}),fe=l.toClipBounds(fe,$t));const M=o.useRef(null),[ce,je]=o.useState(null),ke=(oe,Ee)=>k?oe.clientX-Ee.clientX:oe.clientY-Ee.clientY,Ve=l.getLayout(),ge=k?Ve.getColOffset(d+1):Ve.getRowOffset(d+1),ee=nn({processTouch:!0,onPointerDown:oe=>{if(ye?.(oe),!a&&!s){const Ee=k?Ve.getColOffset(d):Ve.getRowOffset(d),Z=ge-Ee;M.current={isResizing:!1,startSize:Z,index:d,view:l,orientation:r,onDividerMouseDown:P,onDividerResizeStart:A,onDividerResize:R,onDividerResizeEnd:T,onDividerMouseUp:$},je(M.current),P?.(d,Z)}oe.stopPropagation(),oe.preventDefault()},onPointerUp:(oe,Ee,Z)=>{if(!M.current)return;M.current.isResizing&&M.current.onDividerResizeEnd?.(M.current.index,Math.max(0,M.current.startSize+ke(oe,Z)),M.current.startSize);const z=M.current;M.current=null,je(M.current),z.onDividerMouseUp?.(z.index)},onPointerMoveOrWait:(oe,Ee,Z)=>{if(!M.current)return;const z=ke(oe,Z);M.current.isResizing?M.current.onDividerResize?.(M.current.index,Math.max(0,M.current.startSize+z),M.current.startSize):Math.abs(z)>Math.max(1,i)&&(M.current={...M.current,isResizing:!0},je(M.current),M.current.onDividerResizeStart?.(M.current.index,Math.max(0,M.current.startSize+z))),oe.stopPropagation(),oe.preventDefault()}}),X=L(()=>{G?.(d)},[d]);if(!fe)return;const m=f({bounds:fe,orientation:r,view:l,index:d,disabled:a,disabledResize:s,onAutoFit:X,onPointerDown:ee,...J},n);if(!m)return;const{getPortalContainer:qe}=lo();let Ne=null;return ce&&ce.isResizing&&ce.index===d&&(Ne=oo.createPortal(re.jsx("div",{style:{position:"absolute",cursor:k?po:mo,left:0,top:0,width:"100%",height:"100%"}}),qe(),"divider:"+d)),re.jsxs(re.Fragment,{children:[Ne,re.jsx("div",{className:_t("header-divider-anchor"),style:{position:"absolute",pointerEvents:"auto",top:`${k?fe.y:ge}px`,left:`${k?ge:fe.x}px`,width:(k?0:fe.width-1)+"px",height:(k?fe.height-1:0)+"px",display:"flex"},tabIndex:-1,children:m})]})}));class Qo{naturalDimensions(n,r={}){const l=document.createElement("div");let d=r?.lineHeight??"1";!r?.lineHeight&&r.paintableText?.fontSize&&(d=Math.ceil(1.2*r.paintableText.fontSize)+"px");const a=document.createElement("div");a.style.visibility="hidden",a.style.position="absolute",a.style.textRendering="geometricprecision",a.style.display="inline-grid",a.style.overflowWrap="break-word",a.style.maxWidth=r.maxWidth?r.maxWidth+"px":"100%",a.style.lineHeight=d,a.style.letterSpacing=(r.paintableText?.letterSpacing??0)+"px",a.style.fontSize=r.paintableText?.fontSize?r.paintableText.fontSize+"px":"unset",a.style.fontFamily=r.paintableText?.fontSize?r.paintableText.fontFamily:"unset",a.style.fontWeight=r.paintableText?.fontWeight?""+r.paintableText.fontWeight:"400",a.style.fontStyle=r.paintableText?.fontStyle?r.paintableText.fontStyle:"normal",a.style.whiteSpace=r.paintableText?.wrap==="wrap"?"break-spaces":"pre",l.appendChild(a);const s=n.split(`
`);for(let f=0;f<s.length;f++){let P=document.createElement("span");a.appendChild(P),P.textContent=s[f]}s.length!==0&&s[s.length-1].length!==0||a.appendChild(document.createElement("br")),document.body.appendChild(a);let i=a.getBoundingClientRect();return a.remove(),{width:i.width,height:i.height,maxLineHeight:1.2*(r.paintableText?.fontSize||1056/72)}}}const Jo=(e=void 0)=>Object.freeze({clean:e,dirty:void 0,editMode:!1}),er=Jo(),cr=o.memo(o.forwardRef((e,n)=>{const{editState:r=er,defaultTextStyle:l,onStartEdit:d,onChangeEdit:a,onSubmitEdit:s,onCancelEdit:i,onDoneEdit:f,containerBounds:P,setNaturalDimensions:A,onNavigate:R,textProperties:T,style:$,autoFocus:Y,...q}=e,J=o.useRef(null),{width:ye=0}=P??{},[G,k]=o.useState(()=>r);o.useEffect(()=>{k(r)},[r]);const V=T?.align||"left",fe=T?.vAlign||"middle",M=T?.fill||"#040404",ce=T?.wrap||"wrap",je=T?.fontFamily||"Calibri",ke=T?.fontSize||11,Ve=T?.fontWeight||400,ge=T?.fontStyle||"normal",ee=G.dirty??G.clean??"";let X=2;const m=96*ke/72,qe=1.2*m;fe==="right"&&(X+=1);const Ne=o.useMemo(()=>new Qo().naturalDimensions(ee,{maxWidth:ce==="wrap"?ye-X:void 0,lineHeight:`${qe}px`,paintableText:{fontStyle:ge,wrap:ce,letterSpacing:-.25}}),[ee,ce,X,m,je,Ve,ge,A,ye]),oe=o.useCallback(()=>Ne.maxLineHeight?Ne.maxLineHeight+"px":"1.2",[Ne]),[Ee,Z]=o.useState(oe);o.useLayoutEffect(()=>{Z(oe())},[P,Ne]),o.useLayoutEffect(()=>{A?.({width:ce==="wrap"?void 0:Ne.width+X,height:Ne.height})},[Ne,A]);const z=L(a,[a]),K=L(S=>{if(G.dirty===S)return;const Re={...G};Re.dirty=S,J.current,k(Re),z?.(Re)},[G]),yt=L(S=>{if(G.editMode===S)return;const Re={...G};Re.editMode=S,k(Re),z?.(Re)},[G]),vt=L(()=>{try{return s?.(G),f?.(),!0}catch{return!1}},[s,G]),ut=L(()=>{k(r),i?.(),f?.()},[i,r]),ct=L(S=>{if(!J.current)return;if(S.isDefaultPrevented(),!(S.isTrusted||S.nativeEvent.ctrlKey||S.nativeEvent.metaKey||S.nativeEvent.altKey||S.nativeEvent.isComposing)&&so.indexOf(S.nativeEvent.key)!==-1){const le={...G};return le.dirty=S.nativeEvent.key==="Backspace"?"":(le.dirty??"")+S.key,k(le),z?.(le),void S.preventDefault()}const Re=S.nativeEvent.shiftKey;if(S.which===Pt.Escape)return S.preventDefault(),void ut();if(S.which===Pt.F2)return yt(!0),void S.preventDefault();if(S.which===Pt.Enter&&(S.preventDefault(),vt()&&R?.(Re?x.Up:x.Down)),S.which===Pt.Tab)return S.preventDefault(),void(vt()&&R?.(Re?x.Left:x.Right));if(!G.editMode){let le=null;switch(S.which){case Pt.Left:le=x.Left;break;case Pt.Right:le=x.Right;break;case Pt.Up:le=x.Up;break;case Pt.Down:le=x.Down}if(le)return void vt()}},[G,R]),[we,At]=o.useState(!Y);o.useEffect(()=>{At(!1)},[]);const O=ro(n,()=>({startEdit(S){let Re=S?.initialSelection;if(!Re){const me=J.current.value.length??0;Re={start:me,end:me,direction:"forward"}}J.current?.setSelectionRange(Re.start,Re.end,Re.direction);const le={...r,editMode:S?.editMode??!1};S?.text!==void 0&&(le.dirty=S.text),le.editMode===r.editMode&&le.dirty===r.dirty||(k(le),z?.(le))},submitEdit:()=>vt(),cancelEdit(){ut()},autoFocus(){J.current?.focus()},getLineHeight:()=>Ne?.maxLineHeight??qe,dispatchEvent:S=>J.current.dispatchEvent(S)}),[r,d]);return re.jsx("div",{ref:O,...q,style:{background:"transparent",display:"flex",flexGrow:1,alignSelf:"center",height:Ne.height,maxWidth:"100%",maxHeight:"100%",...$},children:re.jsx("textarea",{spellCheck:"false",ref:J,value:ee,autoFocus:!1,disabled:we,name:"cell-editor",autoComplete:"off",autoCapitalize:"off",style:{flex:"1 1 100%",position:"relative",fontSize:`${m}px`,fontFamily:`${je}`,fontWeight:`${Ve}`,fontStyle:`${ge}`,padding:"0px",marginRight:V==="right"?"3px":"0px",marginLeft:V==="left"?"2px":"0px",lineHeight:Ee,height:Ne.height,textRendering:"geometricPrecision",letterSpacing:"-0.25px",boxSizing:"border-box",borderWidth:0,outline:"none",resize:"none",overflow:"hidden",verticalAlign:"baseline",textAlign:V,background:"transparent",color:M,marginBottom:"0px",userSelect:"text",maxHeight:"100%",whiteSpace:ce==="wrap"?"break-spaces":"pre",wordWrap:"break-word"},onChange:S=>{K(S.target.value)},onDoubleClick:S=>{S.isTrusted},onMouseDown:S=>{yt(!0)},onKeyDown:ct})})})),ar=o.memo(e=>{const{value:n,view:r,bounds:l,range:d,zoom:a,children:s,style:i,...f}=e;return re.jsx("div",{style:{padding:"2px 4px",fontFamily:"Calibri",letterSpacing:-.25,lineHeight:1.2,fontSize:i?.fontSize||1056/72,...i},...f,children:n})});export{sr as C,ar as E,cr as I,xo as M,wo as R,lr as S,$t as V,Vo as _,Jn as a,uo as b,Go as c,so as d,Jo as h,Xo as s,rr as v,ir as y};
