import{j as s}from"./index-J-Hv9Xln.js";import{r as a}from"./iframe-CBk8unIv.js";import{a as m}from"./index-DvhsF04y.js";import{S as A}from"./index-NVek8bTy.js";import{B as E,F as b,T as F,b as l,g as p}from"./TextField-DhMfhqoy.js";import"./index-CMiH3ff9.js";import"./preload-helper-D9Z9MdNV.js";import"./client-vjV3QKWK.js";import"./index-ZiyYtj3X.js";import"./index--CXhSu_I.js";import"./Tooltip-BpPbRQQ7.js";/**
 * @license @sheetxl/studio-mui - Studio - Spreadsheet UI built with SheetXL SDK using React & MUI. - v0.6.6
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const L=["Ok","Cancel"],X=a.memo(O=>{const{initialHyperlink:n=null,initialDisplay:P=null,onUpdateHyperlink:x,context:i,onOption:f,onValidateOption:u,onDone:d,options:h=L,defaultOption:c=h?.[0],cancelOption:r="Cancel",sx:j,...v}=O,D=a.useMemo(()=>(n??i?.()?.getHyperlink())!==null,[]),y=a.useMemo(()=>{let t=null,o=null;n&&(typeof n=="string"?o=n:t=n);const C=t??i?.()?.getHyperlink();return{address:o??C?.getAddress()??"",textToDisplay:C?.getDisplayText()??""}},[n,i]),[e,H]=a.useState(y.address),[g,I]=a.useState(()=>{const t=i?.().toTextUnformatted()??P;return t===y.address?"":t}),[w,T]=a.useState(!1),M=a.useCallback(t=>{I(t.target.value)},[]),k=a.useCallback(async(t,o)=>null,[]),B=m(async t=>{t!==r&&x?.(e===""?null:{address:e},g),f?.(t,t===r,t===c),d?.()},[e,g,x,d,f,c,r]),S=m(t=>{H(t.target.value),k(t.target.value,null)},[u]),$=m(async t=>{let o=await Promise.resolve(u?.(t));try{o!==!1&&(o=await k(e,t))}catch{}return o??!0},[u]);return s.jsx(A,{title:(D?"Edit":"Insert")+" Link",options:h,onDone:d,onOption:t=>B(t),onValidateOption:$,defaultOption:c,cancelOption:r,autoFocusSel:".autoFocus",sx:{width:"480px",...j},...v,children:s.jsxs(E,{sx:{paddingTop:t=>t.spacing(1),paddingBottom:t=>t.spacing(0),rowGap:t=>t.spacing(1),display:"flex",flexDirection:"column"},children:[s.jsx(b,{sx:{paddingTop:t=>t.spacing(1.5),minWidth:135,width:"100%"},size:"small",children:s.jsx(F,{label:"Address",placeholder:"Enter a url or cell reference.",onFocus:t=>{w||t.target?.select(),T(!0)},sx:{"& .MuiFormHelperText-root":{marginTop:t=>t.spacing(.5)}},InputLabelProps:{shrink:!0},InputProps:{inputProps:{className:"autoFocus",spellCheck:!1,autoComplete:"off",sx:{paddingTop:t=>t.spacing(1.25),paddingBottom:t=>t.spacing(.75),backgroundImage:`linear-gradient(${l("#fff",p(5))}, ${l("#fff",p(5))})`}}},value:e,onChange:S,onContextMenu:t=>{t.stopPropagation()}})}),s.jsx(b,{sx:{paddingTop:t=>t.spacing(1.5),minWidth:135,width:"100%"},size:"small",children:s.jsx(F,{label:"Display Text",placeholder:e?.startsWith("#")?e.substring(1):e,onFocus:()=>{T(!0)},sx:{"& .MuiFormHelperText-root":{marginTop:t=>t.spacing(.5)}},InputLabelProps:{shrink:!0},InputProps:{inputProps:{spellCheck:!1,autoComplete:"off",sx:{paddingTop:t=>t.spacing(1.25),paddingBottom:t=>t.spacing(.75),backgroundImage:`linear-gradient(${l("#fff",p(5))}, ${l("#fff",p(5))})`}}},value:g,onChange:M,onContextMenu:t=>{t.stopPropagation()}})})]})})});export{X as HyperlinkDialog,X as default};
