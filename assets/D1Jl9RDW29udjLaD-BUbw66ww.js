import{j as i}from"./index-J-Hv9Xln.js";import{r as o}from"./iframe-CBk8unIv.js";import{a as m}from"./index-DvhsF04y.js";import{S as F,l as b,s as k}from"./index-NVek8bTy.js";import{B as E}from"./TextField-DhMfhqoy.js";import"./index-CMiH3ff9.js";import"./preload-helper-D9Z9MdNV.js";import"./client-vjV3QKWK.js";import"./index-ZiyYtj3X.js";import"./index--CXhSu_I.js";import"./Tooltip-BpPbRQQ7.js";/**
 * @license @sheetxl/studio-mui - Studio - Spreadsheet UI built with SheetXL SDK using React & MUI. - v0.6.6
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const I=["Ok","Cancel"],Q=o.memo(V=>{const{value:t=null,context:a,onOption:d,onValidateOption:M,onDone:c,onUpdate:g,options:x=I,defaultOption:f=x?.[0],cancelOption:N="Cancel",sx:h,...C}=V,T=o.useMemo(()=>a?.getNames().findValidName("Range1"),[]),p=o.useMemo(()=>{if(!t)return!0},[]),[s,R]=o.useState({displayText:t?.getName()??T,errorText:null}),[l,v]=o.useState({displayValue:t?.getRanges()??a?.selection()??null,errorText:null}),[y,O]=o.useState(!1),j=o.useCallback(async e=>!s.errorText&&!l.errorText,[a]),S=m((e,n,u)=>{if(!n){let r=null;p?r=a?.getNames().addReference(s?.displayText,l?.displayValue,!1):(t.getType()==="reference"&&t.doBatch(()=>{t.setName(s?.displayText),t.setReference(l?.displayValue)},`Edit Named '${s?.displayText}'`),r=t),r&&(r.select(),g(r,p))}d?.(e,n,u),c?.()},[a,s,l,c,d,f,N,g]),w=m(e=>{let n=null;try{a?.getNames().validateName(e)}catch(u){n=u.message}R({displayText:e,errorText:n})},[]),B=m(e=>{t&&t.getName().toLowerCase()===e.toLowerCase()||a?.getNames().validateName(e)},[a,t]),D=o.useCallback(e=>{v({displayValue:e??null,errorText:null})},[]);return i.jsx(F,{title:(p?"Define":"Edit")+" Range",options:x,onOption:S,onValidateOption:j,defaultOption:f,cancelOption:N,autoFocusSel:".autoFocus",sx:{width:"460px",...h},...C,children:i.jsxs(E,{sx:{paddingTop:e=>e.spacing(1),paddingBottom:e=>e.spacing(0),rowGap:e=>e.spacing(1),range:"flex",flexDirection:"column"},children:[i.jsx(b,{formName:"name",defaultInput:T,value:s.displayText,onChangeInput:w,onValidate:B,onFocus:e=>{y||e.target?.select(),O(!0)}}),i.jsx(k,{formName:"range",value:l.displayValue,onChangeInput:D,resolvedAddress:a.getNames().getRanges.bind(a.getNames()),onFocus:e=>{y||e.target?.select(),O(!0)}})]})})});export{Q as NamedReferenceDialog,Q as default};
