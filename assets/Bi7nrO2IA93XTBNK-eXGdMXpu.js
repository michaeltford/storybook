import{_}from"./preload-helper-D9Z9MdNV.js";import{b as S,w as y}from"./index-ZiyYtj3X.js";import"./index-DvhsF04y.js";import"./index-J-Hv9Xln.js";import"./iframe-CBk8unIv.js";import"./index-CMiH3ff9.js";import"./client-vjV3QKWK.js";import"./index--CXhSu_I.js";/**
 * @license @sheetxl/io - IO - Import/Export Libraries for SheetXL. - v0.6.6
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const B=async(i,d)=>{const{trimLeadingBlankRow:a=!0,trimLeadingBlankColumn:m=!0,excludeHidden:g=!1,sheetKey:n=null,papaParseConfig:h={}}=d||{},c=await _(()=>import("./BJnHb2bI80a3WMyV-C_5jZM-B.js"),[],import.meta.url).then(s=>s.p);if(!i)throw new Error("workbook must be specified");let t=null;if(n===null?t=i.getSelectedSheet():typeof n=="number"?t=i.getSheets().getItems()[n]:typeof n=="string"&&(t=i.getSheets().getByName(n)),!t)throw new Error("invalid sheetKey specified");let p=null;const u=[];let e=null,r=t.getUsedRange({excludeHidden:g});if(!r)throw new Error("Nothing to export");if(!a||!m){const s=a?r.getRowStart():0,l=m?r.getColumnStart():0;r=r.getOffsetTo(s,l)}r.forEach((s,l)=>{const w=l.getCoords(),E=l.getCell();p!==w.rowIndex&&(e&&u.push(e),e=[],p=w.rowIndex);const x=E.toTextUnformatted()??"";e.push(x)},{includeEmpty:!0,address:null}),e&&u.push(e);const o={...h},f=c.unparse(u,o);return new TextEncoder().encode(f).buffer},V=async(i,d)=>{const{papaParseConfig:a,setValuesOptions:m,createWorkbookOptions:g}=d??{},n=await _(()=>import("./BJnHb2bI80a3WMyV-C_5jZM-B.js"),[],import.meta.url).then(o=>o.p),h=new TextDecoder().decode(i);let c=-1;const t=new S(g),p=t.getSelectedSheet().getEntireRange().startIncrementalUpdates({orientation:y.Orientation.Row}),u=d?.onProgress;let e=0;const r={...a,transform:(o,f)=>{a?.transform&&(o=a.transform(o,f));const s=f;s===0&&c++;let l=o??"";return p.pushAt(c,s,l),e++,e%1e5==0&&u?.(e),o}};return n.parse(h,r).data,p.apply({textParser:!0,...m}),t};export{V as fromBufferCSV,B as toBufferCSV};
