import{j as o}from"./index-J-Hv9Xln.js";import{r as s}from"./iframe-CBk8unIv.js";import{B as L,g as E,a as x,h}from"./index-DvhsF04y.js";import{f as O,z as M,D as A,l as G,s as W,v as f,g as X,X as V,G as y,p as j,h as b}from"./index-NVek8bTy.js";import{l as Y}from"./index-ZiyYtj3X.js";import{B as n}from"./TextField-DhMfhqoy.js";import"./index-CMiH3ff9.js";import"./preload-helper-D9Z9MdNV.js";import"./client-vjV3QKWK.js";import"./Tooltip-BpPbRQQ7.js";import"./index--CXhSu_I.js";/**
 * @license @sheetxl/studio-mui - Studio - Spreadsheet UI built with SheetXL SDK using React & MUI. - v0.6.6
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const se=s.memo(w=>{const{title:S,onHide:C,autoFocusSel:v=".range-input input",context:R,notifier:l=L,command:r,commands:c,...N}=w,[T,d]=s.useState(!1),[m,g]=s.useState(!1),p=s.useRef(null),[Z,D]=s.useReducer(e=>e+1,0),[B,{width:$}]=O();E(r);const a=R??r.context(),t=a.table(),[F,z]=s.useState(()=>t?a.getNames().getRanges(t.getRange()):null),H=s.useMemo(()=>t?.getName()??"",[t]);Y(a.table(),{onAnchorCoordsChange(e){z(a.getNames().getRanges(e.getRange()))},onProtectedChange(e){D()}});const I=x(e=>{a?.table().setName(e)},[a]),P=x(e=>{a?.table().resize(e.at(0))},[a]);let u=null;return a.table()||(u=o.jsx("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",opacity:1,display:"flex",alignItems:"center",justifyItems:"center",justifyContent:"center",boxSizing:"border-box"},children:o.jsx("div",{children:"No table selected"})})),o.jsx(M,{ref:p,title:S??"Table Details",initialPosition:{y:"35"},autoFocusSel:v,onHide:C,onFocus:()=>d(!0),onBlur:e=>{p?.current?.contains(e.relatedTarget)||d(!1)},PaperProps:{elevation:T?3:1},...N,children:o.jsxs(A,{dividers:!0,ref:B,sx:{display:"flex",flexDirection:"column",position:"relative",paddingLeft:e=>e.spacing(1.5),paddingRight:e=>e.spacing(1.5)},children:[o.jsxs(n,{sx:{display:"flex",flexDirection:"column",transition:"opacity 60ms",opacity:a.table()?1:0},children:[o.jsx(n,{sx:{display:"flex",flexDirection:"row",gap:e=>e.spacing(1)},children:o.jsx(n,{sx:{display:"flex",flexDirection:"column",maxWidth:"100%",boxSizing:"border-box",paddingLeft:e=>e.spacing(2),paddingRight:e=>e.spacing(2)},children:o.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[o.jsx(G,{formName:"name",defaultInput:H,value:t?.getName()??"No table",onChangeInput:I,onValidate:e=>{t&&t.getName().toLowerCase()===e.toLowerCase()||a?.getNames().validateName(e)},disabled:t?.isProtected()??!0,onFocus:e=>{m||e.target?.select(),g(!0)}}),o.jsx(W,{formName:"range",value:F,onChangeInput:P,resolvedAddress:a.getNames().getRanges.bind(a.getNames()),disabled:t?.isProtected()??!0,onFocus:e=>{m||e.target?.select(),g(!0)}})]})})}),o.jsxs(n,{sx:{minHeight:"10px",flex:"1 1 100%",display:"flex",flexDirection:"column",gap:e=>e.spacing(.5),marginTop:e=>e.spacing(1)},children:[o.jsx(f,{orientation:"horizontal",sx:{marginTop:e=>e.spacing(1.5),marginBottom:e=>e.spacing(.75)}}),o.jsx(X,{disabled:t?.isProtected(),styleOptions:t?.getStyleOptions()??null,onStyleOptionsChange:e=>{t.updateStyleOptions(e)},showHeaderRow:t?.getShowHeaders(),onShowHeaderRowChange:e=>{try{t.setShowHeaders(e)}catch(i){l.showError(i)}},showTotalRow:t?.getShowTotals(),onShowTotalRowChange:e=>{try{t.setShowTotals(e)}catch(i){l.showError(i)}},showFilterButton:t?.getFilter()?t.getShowFilterButton():null,onShowFilterButtonChange:e=>{try{t.setShowFilterButton(e)}catch(i){l.showError(i)}}}),o.jsx(n,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",marginTop:e=>e.spacing(2),marginBottom:e=>e.spacing(1)},children:o.jsx(V,{table:t,styles:a.styles(),bodyStyle:a.bodyStyle(),cellHeight:30,isLive:!0})}),o.jsx(f,{orientation:"horizontal"}),o.jsxs(n,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[o.jsx(y,{variant:h.Menuitem,command:c.getCommand("convertTableToRange"),commandState:t,icon:j(o.jsx(b,{}))}),o.jsx(y,{variant:h.Menuitem,commandState:t,command:c.getCommand("deleteTable"),icon:j(o.jsx(b,{}))})]})]})]}),u]})})});export{se as TableDetailsWindow,se as default};
