import{j as a}from"./index-J-Hv9Xln.js";import{r as s}from"./iframe-CBk8unIv.js";import{k as n}from"./index-ZiyYtj3X.js";import{a as p,e as R}from"./index-DvhsF04y.js";import{S as z,e as K}from"./index-NVek8bTy.js";import{B as k,F as S,a as W,S as A,b as u,g as c,T as G,d as O}from"./TextField-DhMfhqoy.js";import"./index-CMiH3ff9.js";import"./preload-helper-D9Z9MdNV.js";import"./index--CXhSu_I.js";import"./client-vjV3QKWK.js";import"./Tooltip-BpPbRQQ7.js";/**
 * @license @sheetxl/studio-mui - Studio - Spreadsheet UI built with SheetXL SDK using React & MUI. - v0.6.6
 *
 * (C) 2025-present SheetXL Inc. & Michael T. Ford
 * License: The license can be found at https://www.sheetxl.com/license.
 */const H=["Ok","Cancel"],oe=s.memo(F=>{const{initialValue:w,context:y,onOption:h,onValidateOption:m,onInputOption:b,onDone:d,options:C=H,defaultOption:l=C?.[0],cancelOption:g="Cancel",sx:P,...$}=F,[t,T]=s.useState(w),[D,I]=s.useState(!1),x=s.useCallback(async(e,o)=>!0,[]),f=p(async e=>{b?.(t,e),h?.(e,e===g,e===l),d?.()},[t,b,d,h,g,l]),M=p(async e=>{e.keyCode===R.Enter&&await x?.(t,null)!==!1&&f(l)},[t,f]),B=p(e=>{T(e.target.value),x?.(e.target.value,null)},[m]),E=p(async e=>{let o=await Promise.resolve(m?.(e));try{o!==!1&&(o=await Promise.resolve(x?.(t,e))??!0)}catch{}return o??!0},[m]),[v,j]=s.useState(n.Styles.lookupStyle(t).formatType??n.Type.Custom);s.useEffect(()=>{j(n.Styles.lookupStyle(t).formatType??n.Type.Custom)},[t]);const N=s.useMemo(()=>{const e=n.Styles.lookupPrimary(),o=i=>a.jsx(K,{value:i,children:i},i),r=Object.keys(e).map(i=>o(e[i].formatType));return r.push(o(n.Type.Custom)),r},[]),V=s.useCallback(e=>{const o=e.target.value;j(o);const r=n.Styles.lookupDefault(o);r&&T(r)},[]),L=s.useMemo(()=>{const e=y();return e.createTemporaryCell({value:e.getValue()??12345,style:{numberFormat:t}})},[v,t,y]);return a.jsx(z,{title:"Number Format",options:C,onDone:d,onOption:e=>f(e),onValidateOption:E,defaultOption:l,cancelOption:g,autoFocusSel:".autoFocus",sx:{width:"580px",...P},...$,children:a.jsxs(k,{sx:{paddingTop:e=>e.spacing(1),paddingBottom:e=>e.spacing(0),rowGap:e=>e.spacing(1),display:"flex",flexDirection:"column"},children:[a.jsxs(S,{sx:{minWidth:135},size:"small",children:[a.jsx(W,{children:"Category"}),a.jsx(A,{value:v,label:"Category",onChange:V,sx:{backgroundImage:`linear-gradient(${u("#fff",c(5))}, ${u("#fff",c(5))})`},children:N})]}),a.jsx(S,{sx:{paddingTop:e=>e.spacing(1.5),minWidth:135,width:"100%"},size:"small",children:a.jsx(G,{label:"Code",onFocus:e=>{D||e.target?.select(),I(!0)},sx:{"& .MuiFormHelperText-root":{marginTop:e=>e.spacing(.5)}},InputLabelProps:{shrink:!0},InputProps:{inputProps:{className:"autoFocus",spellCheck:!1,autoComplete:"off",sx:{paddingTop:e=>e.spacing(1.25),paddingBottom:e=>e.spacing(.75),backgroundImage:`linear-gradient(${u("#fff",c(5))}, ${u("#fff",c(5))})`}}},value:t,onChange:B,onKeyDown:M,onContextMenu:e=>{e.stopPropagation()}})}),a.jsxs(k,{children:[a.jsx(O,{variant:"caption",component:"div",sx:{paddingLeft:e=>e.spacing(2)},children:"Preview"}),a.jsx(O,{variant:"body2",component:"div",sx:{borderRadius:e=>`${e.shape.borderRadius}px`,padding:e=>e.spacing(1),border:e=>`1px solid ${e.palette.grey[400]}`},children:L.getNumberFormat().displayText||"(empty)"})]})]})})});export{oe as NumberFormatDialog,oe as default};
